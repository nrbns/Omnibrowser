import{r as s,i as R,j as e}from"./index-BquUM_dP.js";import{i as j}from"./ipc-events-CqodUROu.js";import{u as b,B as J}from"./agentStreamStore-BcjkWHdN.js";import{c as _,m as c}from"./proxy-BIEmBbur.js";import{L as B,S as K}from"./sparkles-B3IeNLsk.js";import{S as P}from"./send-l9AJcvKj.js";import{A}from"./index-TWPLI6s_.js";import{C as $}from"./circle-check-DDsejJ4f.js";import{C as M}from"./copy-BONWjHlW.js";const Q=_("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);function re(){const[N,T]=s.useState(null),[V,v]=s.useState([]),[d,S]=s.useState(""),[l,p]=s.useState(null),[i,z]=s.useState(""),[m,u]=s.useState(!1),[H,w]=s.useState("idle"),f=s.useRef(null),y=s.useRef(JSON.stringify({goal:"Open example.com",steps:[{skill:"navigate",args:{url:"https://example.com"}}],output:{type:"json",schema:{}}},null,2)),{status:D,transcript:x,events:k,setRun:C,setStatus:a,appendTranscript:h,reset:I}=b();s.useEffect(()=>{f.current&&(d||x)&&(f.current.scrollTop=f.current.scrollHeight)},[d,x]),s.useEffect(()=>{if(!window.agent)return;const t=r=>{v(g=>[...g,r]),r.type==="token"&&r.text&&h(r.text)},o=r=>{v(g=>[...g,r]),b.getState().appendEvent({id:`event_${Date.now()}_${Math.random()}`,type:"step",step:r.idx,status:r.skill,content:r.res?JSON.stringify(r.res):void 0,timestamp:Date.now()})};return window.agent.onToken(t),window.agent.onStep(o),()=>{}},[h]),s.useEffect(()=>{if(!l)return;const t=n=>{n.streamId===l&&(n.chunk.text&&(S(q=>q+(n.chunk.text||"")),h(n.chunk.text||"")),n.chunk.finished&&(u(!1),p(null),a("complete")))},o=n=>{n.streamId===l&&(u(!1),p(null),a("error"),b.getState().setError(n.error))},r=j.on("agent:stream:chunk",t),g=j.on("agent:stream:done",n=>{n.streamId===l&&(u(!1),p(null),a("complete"))}),O=j.on("agent:stream:error",o);return()=>{r(),g(),O()}},[l,h,a]);const E=s.useCallback(async()=>{if(!(!i.trim()||m))try{S(""),I(),u(!0),a("connecting");const t=await R.agent.stream.start(i.trim(),{model:"llama3.2",temperature:.7});t?.streamId&&(p(t.streamId),C(t.streamId,i.trim()),a("live"))}catch(t){console.error("Failed to start stream:",t),u(!1),a("error"),b.getState().setError(t instanceof Error?t.message:String(t))}},[i,m,I,a,C]),F=s.useCallback(async()=>{if(l)try{await R.agent.stream.stop(l),u(!1),p(null),a("complete")}catch(t){console.error("Failed to stop stream:",t)}},[l,a]),L=s.useCallback(async()=>{const t=d||x;if(t)try{await navigator.clipboard.writeText(t),w("copied"),setTimeout(()=>w("idle"),2e3)}catch(o){console.error("Failed to copy:",o)}},[d,x]);return e.jsxs("div",{className:"flex h-full flex-col gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-xl border border-blue-500/40 bg-blue-500/10 p-2",children:e.jsx(J,{size:20,className:"text-blue-300"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-100",children:"Agent Console"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Stream AI responses and manage agent runs"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:D==="live"&&e.jsxs(c.span,{className:"inline-flex items-center gap-2 rounded-full border border-emerald-500/40 bg-emerald-500/15 px-3 py-1 text-xs text-emerald-100",animate:{opacity:[1,.7,1]},transition:{duration:1.5,repeat:1/0},children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400"}),"Streaming"]})})]}),e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Ask Redix"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:i,onChange:t=>z(t.target.value),onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&!m&&(t.preventDefault(),E())},placeholder:"Ask anything... (e.g., 'summarize quantum computing trends')",disabled:m,className:"w-full rounded-xl border border-slate-700/60 bg-slate-800/70 px-4 py-3 text-sm text-gray-100 placeholder:text-gray-500 focus:border-blue-500/60 focus:outline-none focus:ring-1 focus:ring-blue-500/40 disabled:opacity-50"}),m&&e.jsx(c.div,{className:"absolute right-3 top-1/2 -translate-y-1/2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(B,{size:16,className:"text-blue-400"})})]}),m?e.jsxs(c.button,{onClick:F,whileHover:{scale:1.05},whileTap:{scale:.95},className:"inline-flex items-center gap-2 rounded-xl border border-red-500/60 bg-red-500/20 px-4 py-3 text-sm font-medium text-red-100 transition hover:bg-red-500/30",children:[e.jsx(Q,{size:16}),"Stop"]}):e.jsxs(c.button,{onClick:E,disabled:!i.trim(),whileHover:{scale:i.trim()?1.05:1},whileTap:{scale:i.trim()?.95:1},className:"inline-flex items-center gap-2 rounded-xl border border-blue-500/60 bg-blue-500/20 px-4 py-3 text-sm font-medium text-blue-100 transition hover:bg-blue-500/30 disabled:opacity-40 disabled:cursor-not-allowed",children:[e.jsx(P,{size:16}),"Send"]})]})]}),e.jsxs("details",{className:"rounded-xl border border-slate-700/60 bg-slate-900/40",children:[e.jsx("summary",{className:"cursor-pointer px-4 py-2 text-sm font-medium text-gray-300 hover:text-gray-100",children:"Advanced: Agent DSL"}),e.jsxs("div",{className:"border-t border-slate-700/60 p-4",children:[e.jsx("textarea",{className:"h-48 w-full rounded-lg border border-slate-700/60 bg-slate-800/70 p-3 text-xs font-mono text-gray-200 focus:border-blue-500/60 focus:outline-none",defaultValue:y.current,onChange:t=>y.current=t.target.value}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("button",{className:"rounded-lg border border-indigo-500/60 bg-indigo-500/20 px-3 py-1.5 text-xs font-medium text-indigo-100 transition hover:bg-indigo-500/30",onClick:async()=>{const t=JSON.parse(y.current),o=await window.agent?.start?.(t);o?.runId&&T(o.runId)},children:"Start Run"}),e.jsx("button",{className:"rounded-lg border border-slate-700/60 bg-slate-800/60 px-3 py-1.5 text-xs font-medium text-gray-300 transition hover:bg-slate-800/80",onClick:async()=>{N&&await window.agent?.stop?.(N)},children:"Stop Run"})]})]})]}),k.length>0&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Recent Events"}),e.jsx("div",{className:"max-h-48 space-y-2 overflow-y-auto rounded-lg border border-slate-700/60 bg-slate-900/40 p-3",children:e.jsx(A,{children:k.slice(-5).reverse().map(t=>e.jsxs(c.div,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},exit:{opacity:0},className:"rounded-lg border border-slate-700/40 bg-slate-800/50 p-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:t.type}),t.step!==void 0&&e.jsxs("span",{className:"text-gray-400",children:["Step ",t.step]})]}),t.content&&e.jsx("p",{className:"mt-1 truncate text-gray-400",children:t.content})]},t.id))})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"Response"}),(d||x)&&e.jsx("button",{onClick:L,className:"inline-flex items-center gap-1.5 rounded-lg border border-slate-700/60 bg-slate-800/60 px-2 py-1 text-xs text-gray-300 transition hover:bg-slate-800/80",children:H==="copied"?e.jsxs(e.Fragment,{children:[e.jsx($,{size:14,className:"text-emerald-400"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:14}),"Copy"]})})]}),e.jsx("div",{ref:f,className:"flex-1 overflow-y-auto rounded-xl border border-slate-700/60 bg-slate-900/60 p-4",children:e.jsx(A,{mode:"wait",children:d||x?e.jsx(c.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"prose prose-invert prose-sm max-w-none",children:e.jsxs("div",{className:"whitespace-pre-wrap text-sm leading-relaxed text-gray-200",children:[d||x,m&&e.jsx(c.span,{className:"ml-1 inline-block h-4 w-0.5 bg-blue-400",animate:{opacity:[1,0,1]},transition:{duration:.8,repeat:1/0}})]})},"response"):e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},className:"flex h-full flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"rounded-full border border-slate-700/60 bg-slate-800/60 p-4",children:e.jsx(K,{size:24,className:"text-slate-500"})}),e.jsx("p",{className:"mt-4 text-sm text-gray-400",children:"Ask a question to see streaming AI responses"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Responses stream in real-time as they're generated"})]},"empty")})})]})]})]})}export{re as default};
//# sourceMappingURL=AgentConsole-Dglvt_7I.js.map
