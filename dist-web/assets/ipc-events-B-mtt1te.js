class h{listeners=new Map;ipcListeners=new Map;customEventHandlers=new Map;registeredChannels=new Set;ipcHandlers=new Map;on(e,t){if(this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),window.ipc&&window.ipc.on){this.ipcListeners.has(e)||this.ipcListeners.set(e,new WeakSet);const s=this.ipcListeners.get(e);if(!this.registeredChannels.has(e)){this.registeredChannels.add(e);const d=(o,w)=>{const r=this.listeners.get(e);if(r){const c=w||o;r.forEach(p=>{try{p(c)}catch(l){console.error(`Error in IPC event handler for ${e}:`,l)}})}};window.ipc.on(e,d),this.ipcHandlers.set(e,d)}s.add(t)}this.customEventHandlers.has(e)||this.customEventHandlers.set(e,new WeakMap);const a=this.customEventHandlers.get(e);if(!a.has(t)){const s=d=>{try{t(d.detail)}catch(o){console.error(`Error in custom event handler for ${e}:`,o)}};a.set(t,s),window.addEventListener(e,s)}return()=>{this.listeners.get(e)?.delete(t);const s=this.customEventHandlers.get(e);if(s?.has(t)){const d=s.get(t);d&&window.removeEventListener(e,d)}}}emit(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}off(e,t){this.listeners.get(e)?.delete(t)}removeAllListeners(e){if(this.listeners.delete(e),this.ipcListeners.delete(e),this.customEventHandlers.delete(e),this.registeredChannels.delete(e),window.ipc&&window.ipc.removeListener){const t=this.ipcHandlers.get(e);t&&(window.ipc.removeListener(e,t),this.ipcHandlers.delete(e))}}}const n=new h;if(typeof window<"u"){if(window.ipc&&window.ipc.on){const i=(s,d)=>{const o=Array.isArray(d)?d:Array.isArray(s)?s:[];n.emit("tabs:updated",o)},e=(s,d)=>{const o=d||s;n.emit("tabs:progress",o)},t=(s,d)=>{const o=d||s;n.emit("tabs:navigation-state",o)};window.ipc.on("tabs:updated",i),window.ipc.on("ob://ipc/v1/tabs:updated",i),window.ipc.on("tabs:progress",e),window.ipc.on("ob://ipc/v1/tabs:progress",e),window.ipc.on("tabs:navigation-state",t),window.ipc.on("ob://ipc/v1/tabs:navigation-state",t);const a=()=>{window.ipc&&window.ipc.removeListener&&(window.ipc.removeListener("tabs:updated",i),window.ipc.removeListener("ob://ipc/v1/tabs:updated",i),window.ipc.removeListener("tabs:progress",e),window.ipc.removeListener("ob://ipc/v1/tabs:progress",e),window.ipc.removeListener("tabs:navigation-state",t),window.ipc.removeListener("ob://ipc/v1/tabs:navigation-state",t))};if("onpagehide"in window&&window.addEventListener("pagehide",a),typeof document<"u"&&"visibilityState"in document){const s=()=>{};document.addEventListener("visibilitychange",s)}}if(window.addEventListener("shields:counters",(i=>{n.emit("shields:counters",i.detail)})),window.addEventListener("net:status",(i=>{n.emit("net:status",i.detail)})),window.addEventListener("downloads:started",(i=>{n.emit("downloads:started",i.detail)})),window.addEventListener("downloads:progress",(i=>{n.emit("downloads:progress",i.detail)})),window.addEventListener("downloads:done",(i=>{n.emit("downloads:done",i.detail)})),window.addEventListener("agent:plan",(i=>{n.emit("agent:plan",i.detail)})),window.addEventListener("agent:step",(i=>{n.emit("agent:step",i.detail)})),window.addEventListener("agent:log",(i=>{n.emit("agent:log",i.detail)})),window.addEventListener("agent:consent:request",(i=>{n.emit("agent:consent:request",i.detail)})),window.ipc&&window.ipc.on&&(window.ipc.on("agent:stream:chunk",(i,e)=>{n.emit("agent:stream:chunk",e)}),window.ipc.on("agent:stream:done",(i,e)=>{n.emit("agent:stream:done",e)}),window.ipc.on("agent:stream:error",(i,e)=>{n.emit("agent:stream:error",e)})),window.addEventListener("permissions:request",(i=>{n.emit("permissions:request",i.detail)})),window.addEventListener("app:fullscreen-changed",(i=>{n.emit("app:fullscreen-changed",i.detail)})),window.ipc&&window.ipc.on){const i=t=>{n.emit("app:fullscreen-changed",t)};window.ipc.on("app:fullscreen-changed",i);const e=()=>{window.ipc&&window.ipc.removeListener&&window.ipc.removeListener("app:fullscreen-changed",i)};"onpagehide"in window&&window.addEventListener("pagehide",e,{once:!0})}}export{n as i};
//# sourceMappingURL=ipc-events-B-mtt1te.js.map
