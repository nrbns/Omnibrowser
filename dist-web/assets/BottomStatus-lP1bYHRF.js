import{c as ie,i as T,r as i,j as t,u as Je,a as Xe,h as se}from"./index-BquUM_dP.js";import{u as G}from"./use-ipc-event-CcVO0A42.js";import{u as Ye}from"./profileStore-B9Mbf7JP.js";import{L as Ze}from"./lock-BeOLUjZE.js";import{E as Qe}from"./eye-BmrkTLPE.js";import{N as je}from"./network-RlKt8r1q.js";import{c as H,m as C}from"./proxy-BIEmBbur.js";import{M as Se}from"./moon-star-CUMLt3Wn.js";import{b as K,F as et}from"./OmniDesk-BdBOPLft.js";import{u as I,E as tt,W as rt}from"./privacyStore-B5f_8hYF.js";import{P as st}from"./Portal-BzN9CTBx.js";import{S as ot,L as ke}from"./sparkles-B3IeNLsk.js";import{A as J}from"./index-TWPLI6s_.js";import{M as at,c as nt}from"./AppShell-BXhI_JTh.js";import{useTrustDashboardStore as oe}from"./trustDashboardStore-CKKody0H.js";import{C as be}from"./cpu-BvpYKXOE.js";import{A as ge}from"./activity-BycRfeKU.js";import{S as ae}from"./shield-Ce_H0Kiu.js";import{B as it}from"./brain-B9NCOvP-.js";import{S as lt}from"./send-l9AJcvKj.js";import{R as ct}from"./refresh-cw-BV6giV6D.js";import{T as dt}from"./triangle-alert-CrRrQux7.js";import{X as ve}from"./x-C_5K_ivr.js";import"./ipc-events-CqodUROu.js";import"./agentStreamStore-BcjkWHdN.js";import"./cloud-BWs6gXbb.js";import"./search-RYizLTqL.js";import"./formatDistanceToNow-Ctx6mZEP.js";import"./clock-gSt0ZU7N.js";import"./circle-check-DDsejJ4f.js";const pt=H("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);const ut=H("Meh",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"8",x2:"16",y1:"15",y2:"15",key:"1xb1d9"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);const we=H("MemoryStick",[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]]);const mt=H("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);const xt=H("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),U=ie((n,r)=>({activeSessionId:null,windowId:null,loading:!1,error:null,summary:null,async startShadowSession(s){if(!r().loading){n({loading:!0,error:null,summary:null});try{const o=await T.private.createShadowSession(s??{});if(!o||typeof o!="object")throw new Error("Shadow session failed to start");const c=o;n({activeSessionId:c.sessionId??null,windowId:typeof c.windowId=="number"?c.windowId:null,loading:!1,summary:null})}catch(o){throw n({loading:!1,error:o instanceof Error?o.message:String(o)}),o}}},async endShadowSession(s){const o=r().activeSessionId;if(o){n({loading:!0,error:null});try{const m=await T.private.endShadowSession(o,s);n({activeSessionId:null,windowId:null,loading:!1,summary:m?.summary??null})}catch(c){throw n({loading:!1,error:c instanceof Error?c.message:String(c)}),c}}},handleSessionEnded(s){n(o=>{const c=o.activeSessionId===s.sessionId;return{activeSessionId:c?null:o.activeSessionId,windowId:c?null:o.windowId,loading:!1,summary:s.summary??null}})},clearSummary(){n({summary:null})},setError(s){n({error:s})}}));function ft(){const[n,r]=i.useState("Normal"),s=Ye(a=>a.policies[a.activeProfileId]),{activeSessionId:o,startShadowSession:c,endShadowSession:m,loading:h}=U(),j=s?!s.allowPrivateWindows:!1,f=s?!s.allowGhostTabs:!1,p=s?!s.allowPrivateWindows:!1,S=[{value:"Normal",icon:Ze,label:"Normal",color:"text-gray-400"},{value:"Private",icon:Qe,label:"Private",color:"text-blue-400",disabled:j},{value:"Ghost",icon:je,label:"Ghost",color:"text-purple-400",disabled:f}],R=async a=>{if(!(a===n||S.find(u=>u.value===a)?.disabled)){if(a==="Private")try{window.ipc?.invoke&&await window.ipc.invoke("ob://ipc/v1/private:createWindow",{url:"about:blank"})}catch(u){console.error("Failed to create private window:",u);return}else if(a==="Ghost")try{window.ipc?.invoke&&await window.ipc.invoke("ob://ipc/v1/private:createGhostTab",{url:"about:blank"})}catch(u){console.error("Failed to create ghost tab:",u);return}r(a)}};return t.jsxs("div",{className:"flex items-center gap-1 bg-gray-800/50 rounded-lg p-1 border border-gray-700/50",role:"group","aria-label":"Privacy mode selector",children:[S.map(a=>{const k=a.icon,u=n===a.value;return t.jsxs(C.button,{type:"button",onClick:()=>R(a.value),onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),R(a.value))},whileHover:{scale:1.05},whileTap:{scale:.95},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-1.5 focus:outline-none focus:ring-2 focus:ring-blue-400/50 ${u?`${a.color.replace("text-","bg-")} bg-opacity-20 text-white`:a.disabled?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-gray-300"}`,disabled:a.disabled,"aria-label":`Switch to ${a.label} privacy mode`,"aria-pressed":u,"aria-disabled":a.disabled,title:a.disabled?`${a.label} disabled by profile policy`:`Switch to ${a.label}`,children:[t.jsx(k,{size:14,"aria-hidden":"true"}),t.jsx("span",{children:a.label})]},a.value)}),t.jsxs(C.button,{type:"button",whileHover:{scale:h||p?1:1.05},whileTap:{scale:h||p?1:.95},disabled:p||h,onClick:async()=>{if(!(p||h))try{o?await m():await c({summary:!0})}catch(a){console.error("Shadow session error:",a)}},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&!p&&!h&&(a.preventDefault(),o?m():c({summary:!0}))},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all flex items-center gap-1.5 focus:outline-none focus:ring-2 focus:ring-purple-400/50 ${o?"bg-purple-500/20 text-purple-200 border border-purple-400/30":p?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-gray-300"}`,"aria-label":o?"End Shadow Mode session":"Start Shadow Mode","aria-pressed":!!o,"aria-disabled":p||h,title:p?"Shadow Mode disabled by profile policy":o?"End Shadow Mode session":"Start Shadow Mode (simulated private browsing)",children:[t.jsx(Se,{size:14,"aria-hidden":"true"}),t.jsx("span",{children:o?"Shadow On":"Shadow"})]},"Shadow")]})}const yt=ie(n=>({open:!1,listening:!1,transcript:"",mood:"calm",messages:[],loadingReply:!1,error:null,setOpen(r){n({open:r})},setListening(r){n({listening:r})},setTranscript(r){n({transcript:r})},setMood(r){n({mood:r})},pushMessage(r){n(s=>({messages:[...s.messages,r]}))},async sendToCompanion(r,s){if(!r.trim())return;const o=Date.now(),c={role:"user",text:r,timestamp:o,mood:s};n(m=>({messages:[...m.messages,c],loadingReply:!0,error:null}));try{const m=`You are Symbiotic, OmniBrowser's empathic voice companion. The user mood is ${s}. Respond concisely (<=3 sentences) in a friendly tone, with optional short actionable tip.`,j={role:"companion",text:(await T.agent.ask(m,{text:r}))?.answer??"I hear you. Let me know how else I can help.",timestamp:Date.now(),mood:s};n(f=>({messages:[...f.messages,j],loadingReply:!1}))}catch(m){n({error:m instanceof Error?m.message:String(m),loadingReply:!1})}},clearConversation(){n({messages:[],transcript:"",mood:"calm",error:null})},setError(r){n({error:r})}})),ht=["great","awesome","excited","happy","love","fantastic","wonderful"],bt=["frustrated","angry","annoyed","stuck","hate","upset"],gt=["plan","launch","deadline","urgent","quick","fast"];function vt(n){const r=n.toLowerCase();return bt.some(s=>r.includes(s))?"concerned":gt.some(s=>r.includes(s))?"motivated":ht.some(s=>r.includes(s))?"positive":"calm"}function wt(n){switch(n){case"positive":return t.jsx(xt,{size:16,className:"text-emerald-300"});case"concerned":return t.jsx(pt,{size:16,className:"text-amber-300"});case"motivated":return t.jsx(mt,{size:16,className:"text-cyan-300"});default:return t.jsx(ut,{size:16,className:"text-slate-300"})}}function jt(){const{open:n,listening:r,transcript:s,mood:o,messages:c,loadingReply:m,error:h,setOpen:j,setListening:f,setTranscript:p,setMood:S,sendToCompanion:R,clearConversation:a,setError:k}=yt(),u=i.useRef(null),[b,z]=i.useState(!1);i.useEffect(()=>{const y=window.SpeechRecognition||window.webkitSpeechRecognition;if(y){const v=new y;v.continuous=!1,v.interimResults=!0,v.lang="en-US",v.onresult=D=>{const V=Array.from(D.results).map(A=>A[0].transcript).join(" ");if(p(V),D.results[0].isFinal){const A=V.trim(),g=vt(A);S(g),p(""),f(!1),R(A,g)}},v.onerror=D=>{f(!1),k(D?.error??"Voice recognition error")},v.onend=()=>{f(!1)},u.current=v,z(!0)}else z(!1)},[f,p,S,R,k]);const M=()=>{if(!b||!u.current){k("Speech recognition not available in this environment.");return}try{k(null),p(""),f(!0),u.current.start()}catch(y){k(y instanceof Error?y.message:String(y)),f(!1)}},$=()=>{if(u.current&&r)try{u.current.stop()}catch{}f(!1)},P=i.useMemo(()=>{switch(o){case"positive":return"Upbeat";case"concerned":return"Checking in";case"motivated":return"In the zone";default:return"Calm"}},[o]);return t.jsxs(t.Fragment,{children:[t.jsxs("button",{type:"button",onClick:()=>j(!n),className:"flex items-center gap-1 rounded-full border border-purple-400/30 bg-purple-500/10 px-3 py-1.5 text-xs font-medium text-purple-100 transition-colors hover:bg-purple-500/20",title:"Open Symbiotic Voice Companion",children:[t.jsx(ot,{size:14})," Voice Companion"]}),t.jsx(J,{children:n&&t.jsx(st,{children:t.jsx("div",{className:"fixed inset-0 z-[120] flex items-end justify-end bg-transparent pointer-events-none",children:t.jsxs(C.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},exit:{opacity:0,y:40},transition:{duration:.2},className:"pointer-events-auto m-6 w-[360px] max-w-[92vw] rounded-3xl border border-purple-400/30 bg-slate-950/96 p-4 shadow-[0_20px_80px_rgba(124,58,237,0.35)]",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-xs uppercase tracking-wide text-purple-200/80",children:"Symbiotic Companion"}),t.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-purple-100",children:[wt(o)," ",P]}),t.jsx("div",{className:"text-[11px] text-purple-200/60",children:"Speak your mind and Symbiotic will respond empathetically."})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:a,className:"rounded-lg border border-purple-400/30 bg-purple-500/10 px-2 py-1 text-[10px] text-purple-100 hover:bg-purple-500/20",children:"Clear"}),t.jsx("button",{type:"button",onClick:()=>{$(),j(!1)},className:"rounded-lg border border-purple-400/30 bg-purple-500/10 px-2 py-1 text-[10px] text-purple-100 hover:bg-purple-500/20",children:"Close"})]})]}),t.jsx("div",{className:"mt-4 h-48 overflow-y-auto rounded-2xl border border-purple-500/10 bg-slate-900/60 p-3",children:c.length===0&&!s?t.jsx("div",{className:"text-[11px] text-purple-200/70",children:"Tap the mic to start talking. I can help summarize, brainstorm, or keep you focused."}):t.jsxs("div",{className:"flex flex-col gap-3 text-[11px]",children:[c.map(y=>t.jsx("div",{className:`flex flex-col gap-1 ${y.role==="user"?"items-end text-right":"items-start text-left"}`,children:t.jsx("div",{className:`max-w-[85%] rounded-2xl px-3 py-2 shadow-sm ${y.role==="user"?"bg-purple-500/20 text-purple-100":"bg-slate-800/70 text-purple-50"}`,children:y.text})},`${y.role}-${y.timestamp}`)),s&&t.jsx("div",{className:"flex justify-end text-[11px] text-purple-200/70",children:s}),m&&t.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-purple-200/70",children:[t.jsx(ke,{size:14,className:"animate-spin"}),"Formulating a response…"]})]})}),h&&t.jsx("div",{className:"mt-2 rounded-lg border border-rose-500/40 bg-rose-500/10 px-3 py-1 text-[11px] text-rose-100",children:h}),t.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[t.jsx("div",{className:"flex items-center gap-2 text-[11px] text-purple-200/70",children:b?"Ready for voice input.":"Voice capture not available."}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{type:"button",onClick:r?$:M,disabled:!b,className:`flex items-center gap-2 rounded-full px-3 py-1.5 text-xs transition-colors ${r?"bg-red-500/30 text-red-100 border border-red-500/40":"bg-purple-500/20 text-purple-100 border border-purple-400/30 hover:bg-purple-500/30"} ${b?"":"opacity-60 cursor-not-allowed"}`,children:[r?t.jsx(at,{size:14}):t.jsx(nt,{size:14}),r?"Stop listening":"Start listening"]})})]})]})})})})]})}const ne=ie(n=>({latest:null,history:[],pushSample:r=>n(s=>{const o=[...s.history,r].slice(-60);return{latest:r,history:o}}),clear:()=>n({latest:null,history:[]})}));function Qt(){const{activeId:n}=Je(),[r,s]=i.useState(""),[o,c]=i.useState(!1),[m,h]=i.useState(!1),j=i.useRef(null),[f,p]=i.useState({enabled:!1,provider:"cloudflare"}),[S,R]=i.useState(0),[a,k]=i.useState(0),[u]=i.useState(!0),[b,z]=i.useState("Normal"),[M,$]=i.useState(null),P=K(e=>e.label),y=K(e=>e.badge),v=K(e=>e.snapshot),D=K(e=>e.setEvent),V=U(e=>e.activeSessionId),A=U(e=>e.loading),g=U(e=>e.summary),le=U(e=>e.handleSessionEnded),Ne=U(e=>e.clearSummary),ce=v.carbonIntensity??null,x=I(e=>e.tor),N=I(e=>e.vpn),X=I(e=>e.refreshTor),Y=I(e=>e.refreshVpn),Me=I(e=>e.startTor),Te=I(e=>e.stopTor),Ee=I(e=>e.newTorIdentity),Ie=I(e=>e.checkVpn),de=ne(e=>e.pushSample),W=ne(e=>e.latest),pe=ne(e=>e.history),ue=i.useMemo(()=>Xe(),[]),Z=i.useMemo(()=>se("API_BASE_URL")??se("OMNIBROWSER_API_URL")??se("OB_API_BASE_URL")??null,[]),me=i.useRef(null),Ce=oe(e=>e.open),Q=oe(e=>e.refresh),L=oe(e=>({pending:e.consentStats.pending,blocked:e.blockedSummary.trackers,loading:e.loading}));G("net:status",e=>{e.doh&&p(e.doh),e.tor?.enabled&&e.tor.circuitEstablished?z("Tor"):e.proxy?.enabled?z("Ghost"):z("Normal")},[]),G("efficiency:mode",e=>{D(e)},[D]),G("efficiency:alert",e=>{$(e)},[]),G("private:shadow:ended",e=>{le(e)},[le]),i.useEffect(()=>{X(),Y();const e=window.setInterval(()=>{X(),Y()},2e4);return()=>window.clearInterval(e)},[X,Y]),i.useEffect(()=>{const e=window.setTimeout(()=>{Q()},450),d=window.setInterval(()=>{Q()},6e4);return()=>{window.clearTimeout(e),window.clearInterval(d)}},[Q]),i.useEffect(()=>{W&&(R(e=>fe(e,W.cpu)),k(e=>fe(e,W.memory)))},[W]),i.useEffect(()=>{if(!ue){if(!Z){console.warn("[metrics] API_BASE_URL not configured; skipping metrics websocket.");return}const e=new WebSocket(`${Z.replace(/^http/,"ws")}/ws/metrics`);return me.current=e,e.onmessage=d=>{try{const l=JSON.parse(d.data);if(l.type!=="metrics")return;const F={timestamp:typeof l.timestamp=="number"?l.timestamp:Date.now(),cpu:typeof l.cpu=="number"?l.cpu:0,memory:typeof l.memory=="number"?l.memory:0,carbonIntensity:typeof l.carbon_intensity=="number"?l.carbon_intensity:void 0};de(F)}catch(l){console.warn("[metrics] Failed to parse message",l)}},e.onopen=()=>{console.info("[metrics] Connected to metrics websocket")},e.onerror=d=>{console.warn("[metrics] Metrics websocket error",d)},e.onclose=()=>{console.info("[metrics] Metrics websocket closed")},()=>{e.close(),me.current=null}}},[ue,Z,de]),i.useEffect(()=>{let e=!0;const d=async()=>{if(e){if(!window.ipc||typeof window.ipc.invoke!="function"){setTimeout(d,500);return}try{const l=await T.dns.status();e&&l&&typeof l=="object"&&p(l)}catch{e&&p({enabled:!1,provider:"cloudflare"})}}};return setTimeout(d,400),()=>{e=!1}},[]);const Re={Normal:"text-gray-400",Ghost:"text-blue-400",Tor:"text-purple-400"},$e=L.pending>0?"warning":L.blocked>0?"info":"default",Pe=L.pending>0?`${L.pending} pending`:L.blocked>0?`${L.blocked} trackers blocked`:"Ledger clean",De=x.stub?"Tor: Stub":x.running?x.circuitEstablished?"Tor: On":`Tor: ${Math.round(x.progress)}%`:"Tor: Off",Le=x.error?`Tor warning: ${x.error}`:x.stub?"Tor binary not found; using stub mode for UI only.":x.running?x.circuitEstablished?"Tor circuit established. Click to stop.":"Tor starting up. Click to stop.":"Route traffic through Tor. Click to enable.",ze=N.connected?`VPN connected${N.name?` (${N.name})`:""}. Click to re-check.`:"Check whether a system VPN is active.",Ve={info:"bg-blue-500/10 border-blue-400/40 text-blue-100",warning:"bg-amber-500/10 border-amber-400/40 text-amber-100",critical:"bg-red-500/10 border-red-400/40 text-red-100"},xe=e=>typeof e!="number"||!Number.isFinite(e)?0:Math.max(0,Math.min(100,Math.round(e))),fe=(e,d,l=.35)=>Number.isFinite(e)?e+(d-e)*l:d,Ae=i.useMemo(()=>pe.map(e=>xe(e.cpu)),[pe]),ye=({icon:e,label:d,value:l,percent:F,gradient:q="from-blue-500 via-cyan-500 to-blue-500",title:E,onClick:O,sparklinePoints:B})=>{const ee=O?"button":"div",te=xe(F);return t.jsxs(ee,{type:O?"button":void 0,onClick:O,title:E,className:`flex items-center gap-1.5 rounded-full border border-gray-700/60 bg-gray-800/60 px-2 py-1 text-xs text-gray-200 ${O?"cursor-pointer transition-colors hover:border-gray-500/70 focus:outline-none focus:ring-1 focus:ring-blue-400/40":""}`,children:[t.jsx(e,{size:12,className:"text-gray-400"}),t.jsx("span",{className:"font-semibold text-gray-100",children:d}),t.jsx("span",{className:"text-[11px] opacity-75",children:l}),t.jsx("div",{className:"h-1.5 w-14 overflow-hidden rounded-full bg-gray-700",children:t.jsx(C.div,{className:`h-full bg-gradient-to-r ${q}`,initial:{width:0},animate:{width:`${te}%`},transition:{duration:.5,ease:"easeOut"}})}),B&&B.length>4&&t.jsx("svg",{viewBox:"0 0 40 12",className:"ml-2 h-3 w-10 text-blue-400/70",children:t.jsx("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",points:B.slice(-12).map((re,_,qe)=>{const Ge=_/Math.max(qe.length-1,1)*40,Ke=12-re/100*12;return`${Ge},${Ke}`}).join(" ")})})]})},w=({icon:e,label:d,description:l,variant:F="default",title:q,onClick:E,pulse:O=!1,loading:B=!1,className:ee})=>{const te={default:"border-gray-700/60 bg-gray-800/60 text-gray-200",positive:"border-emerald-500/30 bg-emerald-500/10 text-emerald-100",warning:"border-amber-500/30 bg-amber-500/10 text-amber-100",danger:"border-red-500/30 bg-red-500/10 text-red-100",info:"border-blue-500/30 bg-blue-500/10 text-blue-100"},re=E?"button":"div";return t.jsxs(re,{type:E?"button":void 0,onClick:E,onKeyDown:E?_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),E())}:void 0,title:q,"aria-label":q||d,"aria-busy":B,className:`${te[F]} ${ee??""} flex items-center gap-1.5 rounded-full px-2 py-1 text-xs ${E?"cursor-pointer transition-colors hover:border-gray-500/70 focus:outline-none focus:ring-1 focus:ring-blue-400/30":""}`,children:[t.jsx(e,{size:12,className:"opacity-80","aria-hidden":"true"}),t.jsx("span",{className:"font-medium",children:d}),l&&t.jsx("span",{className:"text-[11px] opacity-75",children:l}),B&&t.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border border-current border-t-transparent","aria-label":"Loading",role:"status"}),O&&t.jsx(C.span,{className:"inline-flex h-1.5 w-1.5 rounded-full bg-current",animate:{opacity:[.4,1,.4],scale:[1,1.2,1]},transition:{duration:1.6,repeat:1/0,ease:"easeInOut"},"aria-hidden":"true"})]})};i.useEffect(()=>{if(!M)return;const e=setTimeout(()=>{$(null)},2e4);return()=>clearTimeout(e)},[M]);const Oe=async e=>{try{e.type==="mode"&&e.mode?await T.efficiency.applyMode(e.mode):e.type==="hibernate"&&await T.efficiency.hibernateInactiveTabs()}catch(d){console.error("Efficiency action failed:",d)}finally{$(null)}},he=async()=>{if(!(!r.trim()||!n||o))try{c(!0),await T.agent.createTask({title:"User Prompt",role:"researcher",goal:r.trim(),budget:{tokens:4096,seconds:120,requests:20}}),s("")}catch(e){console.error("Failed to create agent task:",e)}finally{c(!1)}};i.useEffect(()=>{if(!m)return;const e={capture:!0},d=l=>{j.current&&(j.current.contains(l.target)||h(!1))};return document.addEventListener("mousedown",d,e),()=>document.removeEventListener("mousedown",d,e)},[m]);const Be=async()=>{try{f.enabled?(await T.dns.disableDoH(),p({enabled:!1,provider:"cloudflare"})):(await T.dns.enableDoH("cloudflare"),p({enabled:!0,provider:"cloudflare"}))}catch(e){console.error("Failed to toggle DoH:",e)}},Ue=[y||null,typeof v.batteryPct=="number"?`${Math.round(v.batteryPct)}%`:null,typeof ce=="number"?`${Math.round(ce)} gCO₂/kWh`:null].filter(Boolean).join(" · "),Fe=P.includes("Regen")?"positive":P.includes("Battery")?"info":"default",_e=De.replace(/^Tor:?\s*/i,""),He=x.stub?"warning":x.running?"info":"default",We=N.connected?N.type?N.type.toUpperCase():"Active":"Disconnected";return t.jsxs("div",{className:"px-4 py-2 bg-gray-900/90 backdrop-blur-sm border-t border-gray-700/50 flex flex-col gap-2","data-onboarding":"status-bar",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 md:gap-3 text-xs text-gray-300",children:[t.jsx(ft,{}),t.jsx(ye,{icon:be,label:"CPU",value:`${S}%`,percent:S,gradient:"from-blue-500 via-cyan-500 to-blue-500",title:"CPU usage",sparklinePoints:Ae}),t.jsx(ye,{icon:we,label:"RAM",value:`${a}%`,percent:a,title:"System memory usage",gradient:"from-green-500 via-emerald-500 to-green-500"}),t.jsx(w,{icon:ge,label:P,description:Ue||void 0,variant:Fe,title:y??P}),t.jsx(w,{icon:Se,label:"Shadow",description:V?"Active":"Idle",variant:V?"info":"default",pulse:A,title:V?"Shadow Mode active":"Shadow Mode inactive"}),t.jsx(w,{icon:je,label:"Mode",description:b,className:Re[b],title:`Privacy mode: ${b}`}),t.jsx(w,{icon:ae,label:"Trust",description:Pe,variant:$e,onClick:()=>void Ce(),title:"Open trust & ethics dashboard",loading:L.loading}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[t.jsx(w,{icon:it,label:"Model",description:u?"Ready":"Loading",variant:u?"positive":"default",pulse:u,loading:!u,title:"Local model status"}),t.jsxs("div",{className:"relative w-48 sm:w-60 hidden sm:block",children:[t.jsx("input",{type:"text",value:r,onChange:e=>s(e.target.value),onKeyDown:e=>{e.key==="Enter"&&he()},placeholder:"Prompt agent (e.g., 'summarize this page')...",disabled:o,className:`h-8 w-full rounded-full border border-gray-700/60 bg-gray-800/70 pl-3 pr-9 text-xs text-gray-200 placeholder-gray-400 focus:border-blue-500/60 focus:outline-none focus:ring-1 focus:ring-blue-500/40 ${o?"opacity-70 cursor-wait":""}`}),o?t.jsx(ke,{className:"absolute right-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 animate-spin text-blue-300","aria-label":"Sending prompt"}):t.jsx("button",{type:"button",onClick:()=>void he(),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 transition-colors hover:text-gray-200",title:"Send prompt",children:t.jsx(lt,{size:14})})]}),t.jsx(jt,{}),t.jsxs("div",{className:"relative",ref:j,children:[t.jsxs("button",{type:"button",className:"flex items-center gap-1 rounded-full border border-gray-700/50 bg-gray-800/60 px-3 py-1.5 text-xs text-gray-300 transition-colors hover:border-gray-600 hover:text-white",onClick:()=>h(e=>!e),title:"Security & network controls",children:[t.jsx(tt,{size:14}),"More"]}),t.jsx(J,{children:m&&t.jsx(C.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},transition:{duration:.16},className:"absolute right-0 mt-2 w-64 rounded-lg border border-gray-800 bg-slate-950/95 p-3 shadow-xl",children:t.jsxs("div",{className:"grid gap-2",children:[t.jsx(w,{icon:ae,label:"Tor",description:_e,variant:He,onClick:x.loading?void 0:()=>{x.running?Te():Me()},loading:x.loading,title:Le,className:`justify-start ${x.loading?"opacity-60 cursor-not-allowed":""}`}),x.running&&!x.stub&&t.jsxs("button",{type:"button",onClick:()=>{x.loading||Ee()},className:"flex items-center gap-2 rounded-md border border-purple-500/40 bg-purple-500/10 px-3 py-1.5 text-[11px] text-purple-100 transition-colors hover:border-purple-400/60",children:[t.jsx(ct,{size:12}),"Request new Tor identity"]}),t.jsx(w,{icon:rt,label:"VPN",description:We,variant:N.connected?"positive":"default",onClick:N.loading?void 0:()=>void Ie(),loading:N.loading,title:ze,className:`justify-start ${N.loading?"opacity-60 cursor-not-allowed":""}`}),t.jsx(w,{icon:ae,label:"DoH",description:f.enabled?f.provider:"Disabled",variant:f.enabled?"info":"default",onClick:Be,title:"Toggle DNS-over-HTTPS",className:"justify-start"}),t.jsx(w,{icon:ge,label:"Efficiency",description:P||"Normal",variant:"default",className:"justify-start"}),t.jsx(w,{icon:be,label:"CPU",description:`${S}%`,variant:S>70?"warning":"default",title:"CPU usage",className:"justify-start"}),t.jsx(w,{icon:we,label:"RAM",description:`${a}%`,variant:a>75?"warning":"default",title:"Memory usage",className:"justify-start"})]})})})]})]})]}),t.jsxs("div",{className:"flex flex-wrap items-start gap-3",children:[t.jsx(J,{children:M&&t.jsxs(C.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},className:`flex w-full max-w-xl items-center gap-3 rounded-lg border px-3 py-2 shadow-inner ${Ve[M.severity]}`,children:[t.jsx(dt,{size:14}),t.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.jsx("span",{className:"text-xs font-semibold",children:M.title}),t.jsx("span",{className:"text-[11px] opacity-80",children:M.message})]}),t.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[M.actions.map(e=>t.jsx("button",{onClick:()=>Oe(e),className:"rounded bg-gray-900/60 px-2 py-1 text-[11px] font-medium transition-colors hover:bg-gray-900/80",children:e.label},e.id)),t.jsx("button",{onClick:()=>$(null),className:"p-1 text-xs opacity-70 transition-opacity hover:opacity-100","aria-label":"Dismiss efficiency alert",children:t.jsx(ve,{size:12})})]})]},"efficiency-alert")}),t.jsx(J,{children:g&&t.jsxs(C.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},className:"flex w-full max-w-xl items-start gap-3 rounded-lg border border-purple-500/40 bg-purple-500/10 px-3 py-2 text-xs text-purple-100 shadow-inner",children:[t.jsx(et,{size:14,className:"mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1 space-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide",children:"Shadow Summary"}),t.jsx("button",{onClick:Ne,className:"p-1 text-[10px] text-purple-200/80 transition-colors hover:text-purple-50","aria-label":"Dismiss shadow summary",children:t.jsx(ve,{size:12})})]}),t.jsx("div",{className:"text-[11px] opacity-90",children:g.recommendations?.[0]??"Review your shadow session."}),t.jsxs("div",{className:"flex flex-wrap gap-2 text-[10px] opacity-80",children:[t.jsxs("span",{children:[Math.round(g.durationMs/1e3),"s"]}),t.jsxs("span",{children:["Visits: ",g.totalVisits]}),t.jsxs("span",{children:["Domains: ",g.uniqueHosts]})]}),g.visited?.length>0&&t.jsxs("div",{className:"space-y-0.5",children:[t.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Recent"}),t.jsx("ul",{className:"space-y-0.5",children:g.visited.slice(0,3).map(e=>t.jsx("li",{className:"truncate",children:t.jsx("a",{href:e.url,className:"text-[11px] text-purple-200 transition-colors hover:text-purple-50",title:e.url,children:e.title||e.url})},`${e.url}-${e.firstSeen}`))})]}),g.recommendations?.length>1&&t.jsxs("div",{className:"space-y-0.5",children:[t.jsx("span",{className:"text-[10px] uppercase opacity-70",children:"Recommendations"}),t.jsx("ul",{className:"space-y-0.5",children:g.recommendations.slice(1).map((e,d)=>t.jsx("li",{className:"text-[11px] opacity-80",children:e},d))})]})]})]},"shadow-summary")})]})]})}export{Qt as BottomStatus};
//# sourceMappingURL=BottomStatus-lP1bYHRF.js.map
