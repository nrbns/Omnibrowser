var g=Object.defineProperty,m=(i,e,t)=>e in i?g(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,r=(i,e,t)=>m(i,typeof e!="symbol"?e+"":e,t);class u{constructor(){r(this,"listeners",new Map),r(this,"ipcListeners",new Map),r(this,"customEventHandlers",new Map),r(this,"registeredChannels",new Set),r(this,"ipcHandlers",new Map)}on(e,t){if(this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),window.ipc&&window.ipc.on){this.ipcListeners.has(e)||this.ipcListeners.set(e,new WeakSet);const s=this.ipcListeners.get(e);if(!this.registeredChannels.has(e)){this.registeredChannels.add(e);const o=(d,c)=>{const w=this.listeners.get(e);if(w){const p=c||d;w.forEach(l=>{try{l(p)}catch(h){console.error(`Error in IPC event handler for ${e}:`,h)}})}};window.ipc.on(e,o),this.ipcHandlers.set(e,o)}s.add(t)}this.customEventHandlers.has(e)||this.customEventHandlers.set(e,new WeakMap);const a=this.customEventHandlers.get(e);if(!a.has(t)){const s=o=>{try{t(o.detail)}catch(d){console.error(`Error in custom event handler for ${e}:`,d)}};a.set(t,s),window.addEventListener(e,s)}return()=>{this.listeners.get(e)?.delete(t);const s=this.customEventHandlers.get(e);if(s?.has(t)){const o=s.get(t);o&&window.removeEventListener(e,o)}}}emit(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}off(e,t){this.listeners.get(e)?.delete(t)}removeAllListeners(e){if(this.listeners.delete(e),this.ipcListeners.delete(e),this.customEventHandlers.delete(e),this.registeredChannels.delete(e),window.ipc&&window.ipc.removeListener){const t=this.ipcHandlers.get(e);t&&(window.ipc.removeListener(e,t),this.ipcHandlers.delete(e))}}}const n=new u;if(typeof window<"u"){if(window.ipc&&window.ipc.on){const i=(s,o)=>{const d=Array.isArray(o)?o:Array.isArray(s)?s:[];n.emit("tabs:updated",d)},e=(s,o)=>{const d=o||s;n.emit("tabs:progress",d)},t=(s,o)=>{const d=o||s;n.emit("tabs:navigation-state",d)};window.ipc.on("tabs:updated",i),window.ipc.on("ob://ipc/v1/tabs:updated",i),window.ipc.on("tabs:progress",e),window.ipc.on("ob://ipc/v1/tabs:progress",e),window.ipc.on("tabs:navigation-state",t),window.ipc.on("ob://ipc/v1/tabs:navigation-state",t);const a=()=>{window.ipc&&window.ipc.removeListener&&(window.ipc.removeListener("tabs:updated",i),window.ipc.removeListener("ob://ipc/v1/tabs:updated",i),window.ipc.removeListener("tabs:progress",e),window.ipc.removeListener("ob://ipc/v1/tabs:progress",e),window.ipc.removeListener("tabs:navigation-state",t),window.ipc.removeListener("ob://ipc/v1/tabs:navigation-state",t))};if("onpagehide"in window&&window.addEventListener("pagehide",a),typeof document<"u"&&"visibilityState"in document){const s=()=>{};document.addEventListener("visibilitychange",s)}}if(window.addEventListener("shields:counters",(i=>{n.emit("shields:counters",i.detail)})),window.addEventListener("net:status",(i=>{n.emit("net:status",i.detail)})),window.addEventListener("downloads:started",(i=>{n.emit("downloads:started",i.detail)})),window.addEventListener("downloads:progress",(i=>{n.emit("downloads:progress",i.detail)})),window.addEventListener("downloads:done",(i=>{n.emit("downloads:done",i.detail)})),window.addEventListener("agent:plan",(i=>{n.emit("agent:plan",i.detail)})),window.addEventListener("agent:step",(i=>{n.emit("agent:step",i.detail)})),window.addEventListener("agent:log",(i=>{n.emit("agent:log",i.detail)})),window.addEventListener("agent:consent:request",(i=>{n.emit("agent:consent:request",i.detail)})),window.ipc&&window.ipc.on&&(window.ipc.on("agent:stream:chunk",(i,e)=>{n.emit("agent:stream:chunk",e)}),window.ipc.on("agent:stream:done",(i,e)=>{n.emit("agent:stream:done",e)}),window.ipc.on("agent:stream:error",(i,e)=>{n.emit("agent:stream:error",e)})),window.addEventListener("permissions:request",(i=>{n.emit("permissions:request",i.detail)})),window.addEventListener("app:fullscreen-changed",(i=>{n.emit("app:fullscreen-changed",i.detail)})),window.ipc&&window.ipc.on){const i=t=>{n.emit("app:fullscreen-changed",t)};window.ipc.on("app:fullscreen-changed",i);const e=()=>{window.ipc&&window.ipc.removeListener&&window.ipc.removeListener("app:fullscreen-changed",i)};"onpagehide"in window&&window.addEventListener("pagehide",e,{once:!0})}}export{n as i};
//# sourceMappingURL=ipc-events-CqodUROu.js.map
