import{r as l,j as e,i as S,u as B,b as H}from"./index-BquUM_dP.js";import{F as L,u as V,O as G}from"./OmniDesk-BdBOPLft.js";import{i as D}from"./ipc-events-CqodUROu.js";import{c as z,m as A}from"./proxy-BIEmBbur.js";import{C as _}from"./chevron-right-B3pQwHFx.js";import{P as q}from"./plus-Al6gge0g.js";import{X as $}from"./x-C_5K_ivr.js";import{G as W}from"./globe-CrjHlxyj.js";import{S as Z}from"./shield-Ce_H0Kiu.js";import{L as X}from"./sparkles-B3IeNLsk.js";import{A as J}from"./index-TWPLI6s_.js";import{H as K,d as Q}from"./debounce-CnqAXreA.js";import{T as Y}from"./triangle-alert-CrRrQux7.js";import{f as F}from"./formatDistanceToNow-Ctx6mZEP.js";import{B as ee}from"./book-open-Cip1kOdb.js";import{S as te}from"./send-l9AJcvKj.js";import"./agentStreamStore-BcjkWHdN.js";import"./cloud-BWs6gXbb.js";import"./search-RYizLTqL.js";import"./clock-gSt0ZU7N.js";import"./refresh-cw-BV6giV6D.js";import"./circle-check-DDsejJ4f.js";const se=z("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const re=z("BookOpenCheck",[["path",{d:"M12 21V7",key:"gj6g52"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3",key:"8arnkb"}]]);const ae=z("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const ne=z("Clock3",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]]);const le=z("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const ie=z("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const oe=z("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);const ce=z("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const de=z("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);const xe=z("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const me=z("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);const ue=z("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const pe=z("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const he=z("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var ge=Object.defineProperty,fe=(t,a,s)=>a in t?ge(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,be=(t,a,s)=>fe(t,a+"",s);class ye{constructor(){be(this,"balance",1e4)}getBalance(){return this.balance}buy(a,s){this.balance-=s*100}sell(a,s){this.balance+=s*100}}function je(){const t=new ye,[a,s]=l.useState(t.getBalance()),[i,r]=l.useState([{id:U(),symbol:"AAPL",timeframe:"60"}]),[n,x]=l.useState("AAPL"),[o,b]=l.useState("60"),g=()=>r(j=>[...j,{id:U(),symbol:n,timeframe:o}]),h=j=>r(C=>C.filter(k=>k.id!==j)),y=i.length>=4||i.length>=2?2:1;return e.jsxs("div",{className:"h-full w-full p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("div",{children:["Paper Balance: $",a.toFixed(2)]}),e.jsx("button",{className:"bg-green-600 text-white px-2 py-1 rounded",onClick:()=>{t.buy(n,1),s(t.getBalance())},children:"Buy 1"}),e.jsx("button",{className:"bg-red-600 text-white px-2 py-1 rounded",onClick:()=>{t.sell(n,1),s(t.getBalance())},children:"Sell 1"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("input",{className:"bg-neutral-800 rounded px-2 py-1",value:n,onChange:j=>x(j.target.value.toUpperCase()),placeholder:"Symbol"}),e.jsxs("select",{className:"bg-neutral-800 rounded px-2 py-1",value:o,onChange:j=>b(j.target.value),children:[e.jsx("option",{value:"1",children:"1m"}),e.jsx("option",{value:"5",children:"5m"}),e.jsx("option",{value:"15",children:"15m"}),e.jsx("option",{value:"60",children:"1h"}),e.jsx("option",{value:"240",children:"4h"}),e.jsx("option",{value:"1D",children:"1D"})]}),e.jsx("button",{className:"bg-indigo-600 text-white px-2 py-1 rounded",onClick:g,children:"Add Chart"})]})]}),e.jsx("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${y}, minmax(0, 1fr))`},children:i.map(j=>e.jsxs("div",{className:"relative bg-neutral-800 rounded overflow-hidden",children:[e.jsx("button",{className:"absolute right-2 top-2 text-xs bg-neutral-900/70 px-2 py-1 rounded",onClick:()=>h(j.id),children:"Close"}),e.jsx(ve,{symbol:j.symbol,timeframe:j.timeframe})]},j.id))}),e.jsx(we,{symbol:n})]})}function ve({symbol:t,timeframe:a}){const s=Ne(t,a);return e.jsx("iframe",{className:"w-full h-[380px]",src:s,title:`TV-${t}`,referrerPolicy:"no-referrer"})}function Ne(t,a){const s=encodeURIComponent(t),i=encodeURIComponent(a);return`https://s.tradingview.com/widgetembed/?frameElementId=tv_embed&symbol=${s}&interval=${i}&hidesidetoolbar=1&symboledit=1&saveimage=0&toolbarbg=rgba(0,0,0,1)&studies=[]&hideideas=1&theme=dark`}function U(){return Math.random().toString(36).slice(2)}function we({symbol:t}){return e.jsxs("div",{className:"border border-neutral-800 rounded p-3 text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"AI Helper"}),e.jsxs("div",{className:"text-neutral-300",children:["Suggestions for ",t,": Mock signals and notes. Connect your provider later."]})]})}const ke=[{name:"Chromedino",url:"https://chromedino.com/"},{name:"A Dark Room",url:"https://adarkroom.doublespeakgames.com/"}];function Ce(){return e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium",children:"Games"}),e.jsx("ul",{className:"space-y-1 text-sm",children:ke.map(t=>e.jsx("li",{children:e.jsx("a",{className:"text-indigo-400",href:t.url,onClick:a=>{a.preventDefault(),window.api?.tabs?.create?.(t.url)},children:t.name})},t.url))})]})}function Se({filePath:t,onPageChange:a}){const[s,i]=l.useState(1),[r,n]=l.useState(0),[x,o]=l.useState(1),[b,g]=l.useState(!0),h=l.useRef(null);l.useEffect(()=>{y()},[t]);const y=async()=>{g(!0);try{const v=require("pdfjs-dist");typeof window<"u"&&(v.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${v.version}/pdf.worker.min.js`);const p=await v.getDocument(t).promise;if(n(p.numPages),h.current){const u=await p.getPage(1),c=u.getViewport({scale:x}),d=h.current,f=d.getContext("2d");d.height=c.height,d.width=c.width,await u.render({canvasContext:f,viewport:c}).promise}}catch(v){console.error("Failed to load PDF:",v)}finally{g(!1)}},j=v=>{v>=1&&v<=r&&(i(v),a?.(v))},C=()=>o(Math.min(x+.25,3)),k=()=>o(Math.max(x-.25,.5));return b?e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-900",children:e.jsx("div",{className:"text-gray-400",children:"Loading PDF..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-900",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j(s-1),disabled:s===1,className:"p-2 rounded hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ae,{size:20,className:"text-gray-300"})}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Page ",s," of ",r]}),e.jsx("button",{onClick:()=>j(s+1),disabled:s===r,className:"p-2 rounded hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(_,{size:20,className:"text-gray-300"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:k,className:"p-2 rounded hover:bg-gray-700",children:e.jsx(he,{size:18,className:"text-gray-300"})}),e.jsxs("span",{className:"text-sm text-gray-400 w-16 text-center",children:[Math.round(x*100),"%"]}),e.jsx("button",{onClick:C,className:"p-2 rounded hover:bg-gray-700",children:e.jsx(pe,{size:18,className:"text-gray-300"})}),e.jsx("button",{className:"p-2 rounded hover:bg-gray-700",children:e.jsx(de,{size:18,className:"text-gray-300"})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto flex items-center justify-center p-4",children:e.jsx(A.canvas,{ref:h,style:{transform:`scale(${x})`,transformOrigin:"center"},className:"border border-gray-700 shadow-lg bg-white",initial:{opacity:0},animate:{opacity:1}})})]})}function ze({comments:t,onAddComment:a,onDeleteComment:s,currentPage:i}){const[r,n]=l.useState(""),[x,o]=l.useState(!1),b=t.filter(h=>h.page===i),g=()=>{r.trim()&&(a({page:i,x:0,y:0,text:r}),n(""),o(!1))};return e.jsxs("div",{className:"w-80 h-full bg-gray-800 border-l border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:18,className:"text-gray-400"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"Comments"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",b.length,")"]})]}),e.jsx("button",{onClick:()=>o(!x),className:"p-1.5 rounded hover:bg-gray-700",children:e.jsx(q,{size:16,className:"text-gray-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[x&&e.jsxs(A.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsx("textarea",{value:r,onChange:h=>n(h.target.value),placeholder:"Add a comment...",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:g,className:"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded transition-colors",children:"Add"}),e.jsx("button",{onClick:()=>{o(!1),n("")},className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 text-sm rounded transition-colors",children:"Cancel"})]})]}),b.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-8",children:"No comments on this page"}):e.jsx("div",{className:"flex flex-col gap-3",children:b.map(h=>e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},className:"p-3 bg-gray-700/30 rounded-lg border border-gray-600/50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["Page ",h.page]}),e.jsx("button",{onClick:()=>s(h.id),className:"p-0.5 rounded hover:bg-gray-600",children:e.jsx($,{size:12,className:"text-gray-500"})})]}),e.jsx("p",{className:"text-sm text-gray-200",children:h.text})]},h.id))})]})]})}function Ie(){const[t,a]=l.useState("list"),[s,i]=l.useState([]),[r,n]=l.useState(null),[x,o]=l.useState(!1),[b,g]=l.useState(null),[h,y]=l.useState("pdf"),[j,C]=l.useState(""),[k,v]=l.useState(null),[m,p]=l.useState(null);l.useEffect(()=>{(async()=>{try{const w=await S.document.list();i(w)}catch(w){console.error("Failed to load document reviews",w)}})()},[]);const u=N=>{n(N),a("review")},c=N=>{g(null),p(null),v(null),C(""),y(N),a("ingest")},d=N=>{const w=N.target.files?.[0]||null;w&&v(w)},f=()=>{a(r?"review":"list"),v(null),g(null)},I=async()=>{try{o(!0),g(null),p(5);let N="",w=h;if(h==="web"){if(!j.trim()){g("Please enter a URL to ingest."),o(!1);return}N=j.trim()}else{if(!k){g("Please choose a file to ingest."),o(!1);return}const R=await k.arrayBuffer();N=Buffer.from(R).toString("base64"),w=k.name.toLowerCase().endsWith(".docx")?"docx":"pdf"}p(30);const T=await S.document.ingest(N,w,k?.name||j||void 0);p(90);const M=T;i(R=>[M,...R]),n(M),a("review")}catch(N){console.error("Document ingest failed",N),g(N?.message||"Failed to ingest document.")}finally{p(100),setTimeout(()=>p(null),800),o(!1)}},P=async N=>{if(confirm(`Delete "${N.title}"?`))try{await S.document.delete({id:N.id}),i(w=>w.filter(T=>T.id!==N.id)),r?.id===N.id&&(n(null),a("list"))}catch(w){console.error("Failed to delete review",w)}};return e.jsxs("div",{className:"flex h-full bg-[#1A1D28] text-gray-100 overflow-hidden",children:[e.jsx(Pe,{reviews:s,activeReview:r,onSelectReview:u,onCreate:c}),e.jsxs("main",{className:"flex-1 overflow-y-auto",children:[t==="list"&&e.jsx(Te,{onCreate:c}),t==="ingest"&&e.jsx(Ae,{ingestType:h,ingestUrl:j,loading:x,uploadProgress:m,error:b,fileToIngest:k,onTypeChange:y,onUrlChange:C,onFileSelect:d,onSubmit:I,onCancel:f}),t==="review"&&r&&e.jsx(Me,{review:r,onReverify:async()=>{try{o(!0);const w=await S.document.reverify({id:r.id});n(w),i(T=>T.map(M=>M.id===w.id?w:M))}catch(N){console.error("Reverify failed",N)}finally{o(!1)}},onExport:async(N,w)=>{try{o(!0);const T=window.prompt("Save to path",`~/Documents/${r.title}.${N==="markdown"?"md":"html"}`);if(!T)return;await S.document.export(r.id,N,T,w),alert("Export completed successfully")}catch(T){console.error("Export failed",T),alert("Export failed. Check console for details.")}finally{o(!1)}},onDelete:()=>r&&P(r)})]})]})}function Pe({reviews:t,activeReview:a,onSelectReview:s,onCreate:i}){return e.jsxs("aside",{className:"w-80 border-r border-gray-800/40 bg-[#161924] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800/40",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Document Review"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ingest, analyze, and verify documents"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("button",{onClick:()=>i("pdf"),className:"flex items-center justify-center gap-1 rounded border border-indigo-500/40 bg-indigo-500/10 px-2 py-1 text-indigo-200 hover:bg-indigo-500/20",children:[e.jsx(oe,{size:12}),"PDF"]}),e.jsxs("button",{onClick:()=>i("docx"),className:"flex items-center justify-center gap-1 rounded border border-purple-500/40 bg-purple-500/10 px-2 py-1 text-purple-200 hover:bg-purple-500/20",children:[e.jsx(le,{size:12}),"DOCX"]}),e.jsxs("button",{onClick:()=>i("web"),className:"flex items-center justify-center gap-1 rounded border border-emerald-500/40 bg-emerald-500/10 px-2 py-1 text-emerald-200 hover:bg-emerald-500/20",children:[e.jsx(W,{size:12}),"Web"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:t.length===0?e.jsx("div",{className:"p-4 text-xs text-gray-500",children:"No documents yet. Ingest a PDF, DOCX, or web article to begin."}):e.jsx("ul",{children:t.map(r=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>s(r),className:`w-full text-left px-4 py-3 border-b border-gray-800/40 hover:bg-gray-800/30 transition-colors ${a?.id===r.id?"bg-gray-800/50":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{className:"uppercase tracking-wide text-[10px] text-gray-500",children:r.type}),e.jsx("span",{children:F(r.updatedAt,{addSuffix:!0})})]}),e.jsx("div",{className:"mt-1 font-medium text-sm text-gray-100 line-clamp-2",children:r.title}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:[r.sections.length," sections â€¢ ",r.claims.length," claims"]})]})},r.id))})})]})}function Te({onCreate:t}){return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-4 text-center text-sm text-gray-400",children:[e.jsx("div",{className:"rounded-full border border-dashed border-gray-700/60 bg-gray-800/30 p-6",children:e.jsx(Z,{size:48,className:"text-purple-400"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-100",children:"Start your first review"}),e.jsx("p",{children:"Upload a PDF/DOCX or ingest a web article to analyze claims, entities, and timelines."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>t("pdf"),className:"rounded bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-indigo-500 transition-colors",children:"Upload document"}),e.jsx("button",{onClick:()=>t("web"),className:"rounded border border-gray-700 px-4 py-2 text-sm font-medium text-gray-200 hover:border-gray-600",children:"Ingest web page"})]})]})}function Ae({ingestType:t,ingestUrl:a,loading:s,uploadProgress:i,error:r,fileToIngest:n,onTypeChange:x,onUrlChange:o,onFileSelect:b,onSubmit:g,onCancel:h}){return e.jsxs("div",{className:"flex max-w-3xl flex-col gap-6 px-10 py-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-100",children:"Ingest document"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Ingest a file or web article to analyze claims and generate verification reports."})]}),e.jsx("button",{onClick:h,className:"rounded-full border border-gray-700 bg-gray-800/40 p-2 text-gray-400 hover:bg-gray-800/60",children:e.jsx($,{size:16})})]}),e.jsxs("div",{className:"rounded border border-gray-800/60 bg-gray-900/40 p-6",children:[e.jsx("label",{className:"mb-3 block text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Source type"}),e.jsx("div",{className:"flex gap-3",children:["pdf","docx","web"].map(y=>e.jsx("button",{onClick:()=>x(y),className:`rounded-lg border px-3 py-2 text-sm capitalize transition-colors ${t===y?"border-purple-500/50 bg-purple-500/10 text-purple-200":"border-gray-700/50 bg-gray-800/40 text-gray-300 hover:border-gray-600"}`,children:y},y))})]}),t==="web"?e.jsxs("div",{className:"rounded border border-gray-800/60 bg-gray-900/40 p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Web URL"}),e.jsx("input",{type:"url",value:a,onChange:y=>o(y.target.value),placeholder:"https://example.com/article",className:"mt-2 w-full rounded border border-gray-700 bg-gray-800 px-3 py-2 text-sm text-gray-200 focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"OmniBrowser will fetch the article, strip boilerplate, and analyze claims."})]}):e.jsxs("div",{className:"rounded border border-dashed border-gray-700 bg-gray-900/30 p-6 text-center",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:["Upload ",t.toUpperCase()," file"]}),e.jsx("input",{type:"file",accept:".pdf,.docx",onChange:b,className:"mx-auto block text-sm text-gray-300"}),n&&e.jsxs("p",{className:"mt-3 text-xs text-gray-400",children:["Selected: ",n.name," (",Math.round(n.size/1024)," KB)"]})]}),r&&e.jsx("div",{className:"rounded border border-red-500/40 bg-red-500/10 px-4 py-2 text-xs text-red-200",children:r}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:g,disabled:s,className:"rounded bg-purple-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-purple-500 disabled:opacity-50",children:s?"Processingâ€¦":"Ingest"}),e.jsx("button",{onClick:h,className:"rounded border border-gray-700 px-4 py-2 text-sm text-gray-300 hover:border-gray-600",children:"Cancel"}),i!==null&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx(X,{size:14,className:"animate-spin text-purple-400"}),e.jsxs("span",{children:["Progress ",i,"%"]})]})]})]})}function Me({review:t,onReverify:a,onExport:s,onDelete:i}){const[r,n]=l.useState(null),[x,o]=l.useState(!0),[b,g]=l.useState([]),[h,y]=l.useState(null);l.useEffect(()=>{t.type==="pdf"?y(`omnibrowser://document/${t.id}`):y(null)},[t]);const j=t.timeline??[],C=t.factHighlights??[],k=t.assumptions??[],v=t.auditTrail??[],m=l.useMemo(()=>t.entityGraph?t.entityGraph:t.entities.map(c=>({name:c.name,count:c.occurrences.length,type:c.type,connections:t.claims.filter(d=>d.text.toLowerCase().includes(c.name.toLowerCase())).slice(0,3).map(d=>d.id)})),[t.entityGraph,t.entities,t.claims]),p=l.useMemo(()=>Ee(C,t.sections),[C,t.sections]),u=l.useMemo(()=>{const c=t.claims.length,d=t.claims.filter(P=>P.verification.status==="verified").length,f=t.claims.filter(P=>P.verification.status==="disputed").length,I=c-d-f;return{total:c,verified:d,disputed:f,unverified:I}},[t.claims]);return l.useEffect(()=>{if(!r)return;const c=document.getElementById(`highlight-${r}`);if(c){c.scrollIntoView({behavior:"smooth",block:"center"}),c.classList.add("ring-2","ring-purple-400","ring-offset-1","ring-offset-[#1A1D28]");const d=window.setTimeout(()=>{c.classList.remove("ring-2","ring-purple-400","ring-offset-1","ring-offset-[#1A1D28]")},1800);return()=>window.clearTimeout(d)}},[r]),e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("header",{className:"flex items-start justify-between border-b border-gray-800/40 bg-gray-900/40 px-8 py-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-100",children:t.title}),e.jsxs("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:[t.type.toUpperCase()," â€¢ ",t.sections.length," sections â€¢ ",t.entities.length," entities â€¢ ",t.claims.length," claims"]}),e.jsxs("div",{className:"flex gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["Created ",F(t.createdAt,{addSuffix:!0})]}),e.jsxs("span",{children:["Updated ",F(t.updatedAt,{addSuffix:!0})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,className:"rounded border border-purple-500/50 bg-purple-500/10 px-3 py-2 text-xs font-medium text-purple-200 hover:bg-purple-500/20",children:"Re-run verification"}),e.jsx("button",{onClick:()=>s("markdown","apa"),className:"rounded border border-gray-700 px-3 py-2 text-xs text-gray-300 hover:border-gray-500",children:"Export Markdown"}),e.jsx("button",{onClick:()=>s("html","apa"),className:"rounded border border-gray-700 px-3 py-2 text-xs text-gray-300 hover:border-gray-500",children:"Export HTML"}),e.jsx("button",{onClick:i,className:"rounded border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs font-medium text-red-300 hover:bg-red-500/20",children:"Delete"})]})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("aside",{className:"w-72 border-r border-gray-800/40 bg-[#181C27] overflow-y-auto",children:[e.jsxs("section",{className:"border-b border-gray-800/40 p-4",children:[e.jsx("span",{className:"block text-xs uppercase tracking-wide text-gray-500",children:"Verification summary"}),e.jsxs("div",{className:"mt-3 space-y-2 text-xs",children:[e.jsx(E,{label:"Total claims",value:u.total}),e.jsx(E,{label:"Verified",value:u.verified,tone:"success"}),e.jsx(E,{label:"Disputed",value:u.disputed,tone:"warning"}),e.jsx(E,{label:"Unverified",value:u.unverified,tone:"neutral"})]})]}),C.length>0&&e.jsx(Re,{highlights:C,selectedId:r,onSelect:n}),k.length>0&&e.jsx(Le,{assumptions:k,onSelect:n}),e.jsx(Ue,{graph:m,onSelect:n}),e.jsx(Be,{timeline:j})]}),e.jsxs("section",{className:"flex-1 overflow-y-auto",children:[e.jsx("article",{className:"space-y-6 p-8",children:t.sections.map((c,d)=>{const f=p.get(c.title)??[],I=Math.max(2,4-Math.min(c.level,3));return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`font-semibold text-gray-100 text-${I}xl`,children:c.title}),e.jsx("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-wrap",children:$e(c,f,r)})]},c.title+d)})}),v.length>0&&e.jsx(Oe,{auditTrail:v,onSelect:n})]}),e.jsxs("aside",{className:"w-96 border-l border-gray-800/40 bg-[#181C27] flex flex-col",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-gray-800/40 px-5 py-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-100",children:"Claim verification"}),e.jsx("button",{onClick:()=>o(!x),className:"text-xs text-gray-400 hover:text-gray-200",children:x?"Hide comments":"Show comments"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("ul",{className:"divide-y divide-gray-800/40",children:t.claims.map(c=>e.jsxs(A.li,{layout:!0,className:`cursor-pointer px-5 py-4 hover:bg-gray-800/30 transition-colors ${r===c.id?"bg-gray-800/50":""}`,onClick:()=>n(c.id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Claim"}),e.jsx(O,{status:c.verification.status})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-200 leading-relaxed line-clamp-3",children:c.text}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:["Confidence ",(c.verification.confidence*100).toFixed(0),"% â€¢ ",c.section||"Unknown section"]}),e.jsx("div",{className:"mt-3 space-y-1",children:c.verification.sources.slice(0,3).map((d,f)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-400",children:[e.jsx("span",{className:d.supports?"text-emerald-400":"text-amber-400",children:d.supports?"Supports":"Disputes"}),e.jsx("span",{className:"line-clamp-1",children:d.title})]},`${c.id}-src-${f}`))})]},c.id))})}),x&&e.jsx(ze,{comments:b,onAddComment:c=>{g(d=>[...d,{id:`comment_${Date.now()}`,createdAt:Date.now(),...c}])},onDeleteComment:c=>g(d=>d.filter(f=>f.id!==c)),currentPage:1})]})]}),h&&e.jsx(J,{children:e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-6 z-50 overflow-hidden rounded-xl border border-gray-700/70 bg-[#0F131F]/95 shadow-2xl backdrop-blur",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-gray-800/60 px-4 py-2 text-sm text-gray-300",children:[e.jsx("span",{children:"Document viewer"}),e.jsx("button",{onClick:()=>y(null),className:"rounded-full border border-gray-700 bg-gray-800/50 p-1 text-gray-400 hover:bg-gray-800/70",children:e.jsx($,{size:14})})]}),e.jsx(Se,{filePath:h,onPageChange:()=>{}})]},"pdf")})]})}function Ee(t,a){const s=new Map;return t.length===0||t.forEach(i=>{const n=(a.find(o=>i.position>=o.startPosition&&i.position<o.endPosition)||a.find(o=>o.title===i.section))?.title||i.section||"Document",x=s.get(n)??[];x.push(i),s.set(n,x)}),s}const De={verified:"bg-emerald-500/20 text-emerald-100 border border-emerald-500/30",disputed:"bg-amber-500/20 text-amber-100 border border-amber-500/30",unverified:"bg-slate-500/20 text-slate-100 border border-slate-500/30"};function $e(t,a,s){if(a.length===0)return t.content.trim();const i=t.content,r=i.toLowerCase(),n=[...a].sort((b,g)=>b.position-g.position),x=[];let o=0;return n.forEach(b=>{const g=b.text.trim();if(!g)return;const h=g.toLowerCase();let y=r.indexOf(h,o);if(y===-1&&(y=r.indexOf(h,0),y===-1))return;y>o&&x.push(i.slice(o,y));const j=i.slice(y,y+g.length);x.push(e.jsx("mark",{id:`highlight-${b.claimId}`,className:`rounded px-1 ${De[b.importance]} ${s===b.claimId?"ring-2 ring-purple-400 ring-offset-1 ring-offset-[#1A1D28]":""}`,children:j},`${b.claimId}-${y}`)),o=y+g.length}),o<i.length&&x.push(i.slice(o)),x}function Re({highlights:t,selectedId:a,onSelect:s}){const i=[...t].sort((r,n)=>{const x={verified:0,disputed:1,unverified:2};return x[r.importance]-x[n.importance]});return e.jsxs("section",{className:"border-b border-gray-800/40 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-200",children:[e.jsx(K,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Fact highlights"})]}),e.jsx("ul",{className:"space-y-2 text-xs",children:i.map(r=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>s(r.claimId),className:`w-full rounded border px-2 py-2 text-left transition-colors ${a===r.claimId?"border-purple-500/40 bg-purple-500/10 text-purple-100":"border-emerald-500/30 bg-emerald-500/5 text-emerald-100 hover:bg-emerald-500/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-semibold",children:r.section||"Document"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:r.importance})]}),e.jsx("p",{className:"mt-1 text-[11px] text-emerald-100/90 line-clamp-3",children:r.text})]})},r.claimId))})]})}const Fe={low:"border-sky-500/30 bg-sky-500/5 text-sky-100",medium:"border-amber-500/30 bg-amber-500/10 text-amber-100",high:"border-red-500/40 bg-red-500/10 text-red-100"};function Le({assumptions:t,onSelect:a}){return e.jsxs("section",{className:"border-b border-gray-800/40 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-200",children:[e.jsx(Y,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Assumptions & gaps"})]}),e.jsx("ul",{className:"space-y-2 text-xs",children:t.map(s=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>a(s.claimId),className:`w-full rounded border px-2 py-2 text-left ${Fe[s.severity]} hover:opacity-90 transition-opacity`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.section||"Document"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:s.severity})]}),e.jsx("p",{className:"mt-1 text-[11px] opacity-90",children:s.text}),e.jsx("p",{className:"mt-1 text-[10px] opacity-70",children:s.rationale})]})},s.claimId))})]})}function Ue({graph:t,onSelect:a}){return e.jsxs("section",{className:"border-b border-gray-800/40 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-200",children:[e.jsx(ce,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Entity graph"})]}),e.jsx("ul",{className:"space-y-2 text-xs text-gray-300",children:t.slice(0,12).map(s=>e.jsxs("li",{className:"rounded border border-blue-500/30 bg-blue-500/5 px-2 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-semibold text-blue-100",children:s.name}),e.jsxs("span",{className:"text-[10px] uppercase tracking-wide text-blue-200",children:[s.type," â€¢ ",s.count]})]}),s.connections.length>0&&e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:s.connections.map(i=>e.jsx("button",{onClick:()=>a(i),className:"rounded-full border border-blue-500/30 px-2 py-0.5 text-[10px] text-blue-100 hover:bg-blue-500/20",children:"Jump to claim"},i))})]},s.name))})]})}function Be({timeline:t}){return e.jsxs("section",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(ne,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Timeline events"})]}),t.length===0?e.jsx("div",{className:"text-xs text-gray-500",children:"No events detected."}):e.jsx("ul",{className:"space-y-3 text-xs text-gray-300",children:t.map((a,s)=>e.jsxs("li",{className:"relative pl-4",children:[e.jsx("span",{className:"absolute left-0 top-1 h-2 w-2 rounded-full bg-purple-400"}),e.jsx("div",{className:"font-semibold text-gray-200",children:a.date}),e.jsx("div",{className:"text-[11px] text-gray-400",children:a.description})]},`${a.date}-${s}`))})]})}function Oe({auditTrail:t,onSelect:a}){return e.jsx("section",{className:"px-8 pb-8",children:e.jsxs("div",{className:"rounded border border-gray-800 bg-neutral-900/40",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-gray-800 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-200",children:[e.jsx(re,{size:16}),e.jsx("h3",{className:"text-sm font-semibold",children:"Audit trail"})]}),e.jsx("span",{className:"text-[11px] text-gray-500",children:"Linked to source evidence"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-800 text-xs text-gray-300",children:[e.jsx("thead",{className:"bg-neutral-900/80 text-[11px] uppercase tracking-wide text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Claim"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Location"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Source"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-neutral-800/40",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsxs("button",{className:"text-indigo-200 hover:text-indigo-100",onClick:()=>a(s.claimId),children:["Claim ",s.claimId.split("_").pop()]})}),e.jsxs("td",{className:"px-3 py-2 text-[11px] text-gray-400",children:[s.section||"â€”",s.page!==void 0&&e.jsxs("span",{className:"ml-1",children:["â€¢ p.",s.page]}),s.line!==void 0&&e.jsxs("span",{className:"ml-1",children:["â€¢ line ",s.line]})]}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(O,{status:s.status})}),e.jsx("td",{className:"px-3 py-2 text-[11px] text-gray-400",children:s.link?e.jsx("a",{href:s.link,target:"_blank",rel:"noreferrer",className:"text-indigo-300 hover:text-indigo-100",children:"Open source"}):"â€”"})]},s.claimId))})]})})]})})}function E({label:t,value:a,tone:s="neutral"}){const i=s==="success"?"text-emerald-300":s==="warning"?"text-amber-300":"text-gray-300";return e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{children:t}),e.jsx("span",{className:`font-semibold ${i}`,children:a})]})}function O({status:t}){const a=t==="verified"?"bg-emerald-500/10 text-emerald-200 border-emerald-500/30":t==="disputed"?"bg-amber-500/10 text-amber-200 border-amber-500/30":"bg-gray-500/10 text-gray-300 border-gray-500/30";return e.jsx("span",{className:`rounded-full border px-2 py-0.5 text-[10px] uppercase tracking-wide ${a}`,children:t})}class He{generate(a){const s=encodeURIComponent(a||"omni");return[`https://picsum.photos/seed/${s}-1/512/384`,`https://picsum.photos/seed/${s}-2/512/384`,`https://picsum.photos/seed/${s}-3/512/384`]}}function Ve(){const t=new He,[a,s]=l.useState("a scenic mountain"),[i,r]=l.useState([]);return e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("form",{onSubmit:n=>{n.preventDefault(),r(t.generate(a))},children:e.jsx("input",{className:"w-full bg-neutral-800 rounded px-3 py-2 text-sm",value:a,onChange:n=>s(n.target.value)})}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:i.map((n,x)=>e.jsx("div",{className:"bg-neutral-800 h-32 flex items-center justify-center text-xs",children:n},x))})]})}function Ge(){const[t,a]=l.useState(""),[s,i]=l.useState(null);return e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("form",{onSubmit:async r=>{r.preventDefault();const n=await window.api?.threats?.scanUrl?.(t);i(n)},children:e.jsx("input",{className:"w-full bg-neutral-800 rounded px-3 py-2 text-sm",value:t,onChange:r=>a(r.target.value),placeholder:"Enter URL"})}),s&&e.jsx("pre",{className:"text-xs bg-neutral-900 p-2 rounded overflow-auto",children:JSON.stringify(s,null,2)})]})}function _e(){const[t,a]=l.useState([]),[s,i]=l.useState([]);return l.useEffect(()=>{(async()=>{const r=await window.api?.graph?.all?.();r&&(a(r.nodes),i(r.edges))})()},[]),l.useEffect(()=>{const r=async n=>{const x=window.graph;if(x&&n?.nodes){for(const b of n.nodes)await x.add(b,[]);n.edges?.length&&await x.add({key:n.nodes[0]?.key||"tmp"},n.edges)}const o=await window.api?.graph?.all?.();o&&(a(o.nodes),i(o.edges))};window.graph?.onAuto?.(r)},[]),e.jsxs("div",{className:"h-full w-full p-3",children:[e.jsx("h3",{className:"font-medium mb-2",children:"GraphMind"}),e.jsxs("div",{className:"text-xs text-neutral-300 mb-2",children:["Nodes: ",t.length," Â· Edges: ",s.length]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 text-sm",children:t.map(r=>e.jsxs("div",{className:"border border-neutral-800 rounded p-2",children:[e.jsx("div",{className:"font-medium",children:r.title||r.key}),e.jsx("div",{className:"text-neutral-400",children:r.type})]},r.key))})]})}function qe(){const{activeId:t,tabs:a}=B(),s=l.useRef(null),[i,r]=l.useState(()=>a.length>0),[n,x]=l.useState(""),[o,b]=l.useState(""),[g,h]=l.useState(!1),[y,j]=l.useState(0),C=l.useMemo(()=>typeof window<"u"&&!!window.electron,[]),k=l.useMemo(()=>H(),[]),v=l.useMemo(()=>{if(!n)return!1;try{const m=new URL(n,n.startsWith("http")?void 0:"https://localhost");return m.protocol==="http:"||m.protocol==="https:"}catch{return!1}},[n]);return l.useEffect(()=>{if(!s.current||!t)return;const m=()=>{s.current};m();const p=()=>{m()};window.addEventListener("resize",p);const u=new ResizeObserver(m);return s.current&&u.observe(s.current),()=>{window.removeEventListener("resize",p),u.disconnect()}},[t,a]),l.useEffect(()=>{const m=d=>{if(!Array.isArray(d))return;const f=d.find(I=>I.id===t);if(f)x(f.url||""),b(f.title||"New Tab"),r(!0),h(!1);else if(d.length>0){r(!0),h(!1);const I=d[0];I&&(x(I.url||""),b(I.title||"New Tab"))}else d.length===0&&(r(!1),h(!1),x(""),b(""))},p=D.on("tabs:updated",m),u=D.on("tabs:progress",d=>{(d.tabId===t||!d.tabId)&&(j(d.progress),h(d.progress>0&&d.progress<100),(d.progress>0||d.progress===100)&&r(!0))}),c=async()=>{try{(!window.ipc||typeof window.ipc.invoke!="function")&&await new Promise(f=>setTimeout(f,500));const d=await S.tabs.list();Array.isArray(d)&&d.length>0?(m(d),r(!0),h(!1)):a.length>0&&(r(!0),h(!1))}catch{a.length>0&&t&&(r(!0),h(!1))}};return setTimeout(()=>{c()},300),()=>{p(),u()}},[t]),l.useEffect(()=>{if(!t)return;const m=setInterval(async()=>{try{const u=(await S.tabs.list()).find(c=>c.id===t);u&&(u.title!==o&&b(u.title||"New Tab"),u.url!==n&&x(u.url||""))}catch{}},500);return()=>clearInterval(m)},[t,o,n]),l.useEffect(()=>{a.length>0?(r(!0),h(!1)):(r(!1),h(!1))},[a.length]),e.jsxs("div",{ref:s,className:"flex-1 relative bg-white overflow-hidden w-full",children:[e.jsx("div",{id:"browser-view-container",style:{position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0}}),!C&&v&&e.jsx("iframe",{src:n,title:o||n,className:"absolute inset-0 h-full w-full border-0",style:{zIndex:1,pointerEvents:"auto"},sandbox:"allow-scripts allow-same-origin allow-forms allow-popups"},n),!C&&!v&&n&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-white/95 px-6 text-center text-sm text-gray-600",style:{zIndex:1},children:[e.jsx("span",{className:"text-base font-medium text-gray-800",children:"Preview unavailable for this URL"}),e.jsx("p",{children:"The current site cannot be embedded in a web preview. Open OmniBrowser desktop or copy the link below to view it."}),e.jsx("code",{className:"max-w-full break-all rounded bg-gray-100 px-3 py-1 text-xs text-gray-700",children:n})]}),g&&t&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gray-200 z-50 pointer-events-none",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${y}%`}})}),(!t||a.length===0)&&e.jsx("div",{className:"absolute inset-0 h-full w-full flex items-center justify-center bg-white",style:{zIndex:2,pointerEvents:"auto"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:"ðŸŒ"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"OmniBrowser"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Enter a URL or search to get started"})]})}),a.length===0&&!i&&e.jsx("div",{className:"absolute inset-0 h-full w-full flex items-center justify-center bg-white transition-opacity duration-300",style:{zIndex:2,pointerEvents:"none"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:"ðŸŒ"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"OmniBrowser"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Initializing..."})]})}),k&&n&&t&&e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded opacity-50 hover:opacity-100 transition-opacity z-50 pointer-events-none",children:[o," - ",n]})]})}function We(){const{activeId:t}=B(),[a,s]=l.useState(""),[i,r]=l.useState(""),[n,x]=l.useState([]),[o,b]=l.useState(""),[g,h]=l.useState(null),y=l.useRef(null);l.useEffect(()=>{const m=async()=>{if(!t){s(""),b(""),r(""),x([]);return}try{const c=(await S.tabs.list()).find(f=>f.id===t);if(!c?.url){s(""),b("");return}const d=c.url;if(b(d),d.startsWith("about:")||d.startsWith("chrome:")){s(""),r(""),x([]);return}try{const f=await S.research.getNotes(d);if(f)if(r(f.notes||""),Array.isArray(f.highlights)){const I=f.highlights.map(P=>({id:P.id||(crypto.randomUUID?.()??`hl-${Date.now()}`),text:P.text||"",color:P.color||"#facc15",createdAt:P.createdAt||Date.now(),note:P.note}));x(I)}else x([])}catch(f){console.error("Failed to load notes:",f)}s("Extracting readable content...");try{const f=await S.research.extractContent(t);f?.html?s(f.html):f?.content?s(`<div class="prose prose-invert"><h1>${f.title||d}</h1><p>${f.content}</p></div>`):s("")}catch(f){console.error("Failed to extract content:",f),s("")}}catch(u){console.error("Failed to load research content:",u),s("")}};m();const p=()=>{m()};if(window.ipc?.on)return window.ipc.on("tabs:updated",p),()=>{window.ipc?.removeListener&&window.ipc.removeListener("tabs:updated",p)}},[t]);const j=l.useRef(Q(async(m,p,u)=>{if(!(!m||m.startsWith("about:")||m.startsWith("chrome:")))try{await S.research.saveNotes(m,p,u),console.log("Auto-saved notes for",m)}catch(c){console.error("Failed to save notes:",c)}},1e3)).current;l.useEffect(()=>{o&&(i||n.length>0)&&j(o,i,n)},[i,n,o,j]),l.useEffect(()=>D.on("research:highlight-added",p=>{!p?.url||p.url!==o||x(u=>[...u,{id:p.highlight.id,text:p.highlight.text,color:p.highlight.color||"#facc15",createdAt:p.highlight.createdAt||Date.now(),note:p.highlight.note}])}),[o]);const C=(m,p)=>{x(u=>u.map(c=>c.id===m?{...c,note:p}:c))},k=l.useMemo(()=>[...n].sort((m,p)=>(p.createdAt??0)-(m.createdAt??0)),[n]),v=async m=>{if(!o||o.startsWith("about:")||o.startsWith("chrome:"))return;const p=j?.flush;typeof p=="function"&&p();try{await S.research.saveNotes(o,i,n)}catch(u){console.error("Failed to sync notes before export:",u)}h(m);try{const u=await S.research.export(m,[o],!0);if(u?.format==="markdown"&&u?.path)alert(`Markdown exported to ${u.path}`);else if(u?.format==="obsidian"&&u?.folder)alert(`Obsidian vault files saved to ${u.folder}`);else if(u?.format==="notion"&&Array.isArray(u?.notionPages)){const c=u.notionPages.map(d=>d?.url?`â€¢ ${d.title||"Untitled"}
  ${d.url}`:`â€¢ ${d.title||"Untitled"}`).join(`
`);alert(`Synced to Notion:
${c}`)}else alert("Export completed.")}catch(u){console.error("Failed to export:",u);const c=u instanceof Error?u.message:"Failed to export";alert(c)}finally{h(null)}};return e.jsxs("div",{className:"h-full flex",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-700/30 bg-gray-950 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-800/50 bg-gray-900/50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{size:16,className:"text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Reader"})]})}),e.jsx("div",{ref:y,className:"flex-1 overflow-y-auto p-6 prose prose-invert max-w-none",style:{color:"#e5e7eb"},children:a?e.jsx("div",{className:"text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:a}}):e.jsxs("div",{className:"text-center text-gray-500 py-12",children:[e.jsx(L,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No readable content available"}),e.jsx("p",{className:"text-xs mt-2",children:"Navigate to a page to extract content"})]})})]}),e.jsxs("div",{className:"w-80 flex flex-col border-l border-gray-700/30 bg-gray-900/50 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Notes"})]}),o&&e.jsx(A.span,{className:"text-xs text-gray-500 px-2 py-0.5 bg-gray-800/40 rounded",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},children:"Auto-saving..."})]}),k.length>0&&e.jsxs("div",{className:"border-b border-gray-800/50 p-3 space-y-3 max-h-52 overflow-y-auto",children:[e.jsxs("div",{className:"text-xs font-semibold text-gray-400 mb-1 flex items-center gap-2",children:[e.jsx(me,{size:12}),"Highlights & notes"]}),k.map(m=>e.jsxs("div",{className:"bg-gray-800/30 rounded-lg border border-gray-800/60 p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"px-2 py-1 rounded-md text-xs font-medium max-w-xs truncate",style:{backgroundColor:`${m.color}20`,color:m.color},title:m.text,children:[m.text.slice(0,120),m.text.length>120?"â€¦":""]}),e.jsx("button",{onClick:()=>x(p=>p.filter(u=>u.id!==m.id)),className:"p-1 rounded-lg text-gray-500 hover:text-gray-300 hover:bg-gray-800/50 transition-colors","aria-label":"Remove highlight",children:e.jsx($,{size:12})})]}),e.jsx("textarea",{value:m.note??"",onChange:p=>C(m.id,p.target.value),placeholder:"Add a note for this highlight...",className:"w-full text-xs bg-gray-900/40 border border-gray-800/60 rounded-md px-2 py-1.5 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-emerald-500/60",rows:2}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Saved ",new Date(m.createdAt).toLocaleString()]})]},m.id))]}),e.jsx("textarea",{value:i,onChange:m=>r(m.target.value),placeholder:"Take notes, add insights, save findings...",className:"flex-1 p-4 bg-transparent text-sm text-gray-300 placeholder-gray-600 resize-none focus:outline-none"}),e.jsxs("div",{className:"border-t border-gray-800/50 p-3 flex items-center gap-2",children:[e.jsxs(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:async()=>{if(o&&!o.startsWith("about:")&&!o.startsWith("chrome:")){j.flush();try{await S.research.saveNotes(o,i,n)}catch(m){console.error("Failed to save notes:",m)}}},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-600/20 hover:bg-blue-600/30 border border-blue-500/30 rounded text-xs text-blue-400 transition-colors",children:[e.jsx(ue,{size:14}),"Save"]}),e.jsxs(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:!!g,onClick:()=>v("markdown"),className:`px-3 py-2 bg-green-600/20 hover:bg-green-600/30 border border-green-500/30 rounded text-xs text-green-400 transition-colors flex items-center gap-2 ${g?"opacity-60 cursor-wait":""}`,title:"Export to Markdown",children:[e.jsx(ie,{size:14}),g==="markdown"?"Exportingâ€¦":"Export Markdown"]}),e.jsxs(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:!!g,onClick:()=>v("obsidian"),className:`px-3 py-2 bg-purple-600/20 hover:bg-purple-600/30 border border-purple-500/30 rounded text-xs text-purple-300 transition-colors flex items-center gap-2 ${g?"opacity-60 cursor-wait":""}`,title:"Export notes and highlights to Obsidian-compatible markdown files",children:[e.jsx(se,{size:14}),g==="obsidian"?"Exportingâ€¦":"Obsidian Export"]}),e.jsxs(A.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:!!g,onClick:()=>v("notion"),className:`px-3 py-2 bg-emerald-600/20 hover:bg-emerald-600/30 border border-emerald-500/30 rounded text-xs text-emerald-300 transition-colors flex items-center gap-2 ${g?"opacity-60 cursor-wait":""}`,title:"Sync notes and highlights to Notion",children:[e.jsx(te,{size:14}),g==="notion"?"Exportingâ€¦":"Sync to Notion"]})]})]})]})}function gt(){const t=V(i=>i.mode),[a,s]=l.useState(!1);return l.useEffect(()=>{const i=n=>{s(n.fullscreen)};return D.on("app:fullscreen-changed",i)},[]),e.jsxs("div",{className:`h-full w-full bg-[#1A1D28] flex flex-col ${a?"absolute inset-0":""}`,children:[(t==="Browse"||!t||t==="Research")&&e.jsxs("div",{className:"flex-1 w-full relative",children:[e.jsx(qe,{}),e.jsx(G,{}),t==="Research"&&!a&&e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto h-full w-full",children:e.jsx(We,{})})})]}),t==="Trade"&&e.jsx(je,{}),t==="Games"&&e.jsx(Ce,{}),t==="Docs"&&e.jsx(Ie,{}),t==="Images"&&e.jsx(Ve,{}),t==="Threats"&&e.jsx(Ge,{}),t==="GraphMind"&&e.jsx(_e,{})]})}export{gt as default};
//# sourceMappingURL=Home-CmcpMETG.js.map
