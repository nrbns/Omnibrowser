import{u as D,r as h,j as e,i as d}from"./index-DMKJqC5Z.js";import{u as H}from"./use-ipc-event-BWqwbbDc.js";import{C as L}from"./clock-CAio9RVc.js";import{m as f}from"./proxy-B-PlLRqe.js";import{T as E}from"./trash-2-SwMuWoHl.js";import{S as O}from"./search-FaAd99m9.js";import{X as j}from"./x-GAlOzW-g.js";import{G as v}from"./globe-B55P551M.js";import"./ipc-events-B-mtt1te.js";import"./createLucideIcon-BHoZ2X8H.js";function Q(){const g=D(),[u,n]=h.useState([]),[i,y]=h.useState(""),[w,N]=h.useState(!0);h.useEffect(()=>{(async()=>{try{const t=await d.history.list();Array.isArray(t)?n(t):n([])}catch(t){console.error("Failed to load history:",t),n([])}finally{N(!1)}})()},[]),H("history:updated",()=>{d.history.list().then(s=>n(s||[])).catch(console.error)},[]);const p=h.useMemo(()=>{let s=u;if(i.trim()){const o=i.toLowerCase();s=u.filter(a=>a.title.toLowerCase().includes(o)||a.url.toLowerCase().includes(o))}const t={},c=Date.now(),l=1440*60*1e3,m=7*l,x=30*l;return s.forEach(o=>{const a=c-o.timestamp;let r;a<l?r="Today":a<l*2?r="Yesterday":a<m?r="This Week":a<x?r="This Month":r="Older",t[r]||(t[r]=[]),t[r].push(o)}),Object.entries(t).map(([o,a])=>({date:o,entries:a.sort((r,z)=>z.timestamp-r.timestamp)})).sort((o,a)=>{const r=["Today","Yesterday","This Week","This Month","Older"];return r.indexOf(o.date)-r.indexOf(a.date)})},[u,i]),C=async()=>{confirm("Are you sure you want to clear all browsing history?")&&(await d.history.clear(),n([]))},T=async s=>{await d.history.deleteUrl?.(s),n(u.filter(t=>t.url!==s))},k=async s=>{try{await d.tabs.create(s)&&g("/")}catch(t){console.error("Failed to open history URL:",t),g("/"),setTimeout(()=>{d.tabs.create("about:blank").catch(console.error)},100)}},S=s=>{const t=new Date(s),l=new Date().getTime()-s,m=Math.floor(l/6e4),x=Math.floor(l/36e5);return m<1?"Just now":m<60?`${m}m ago`:x<24?`${x}h ago`:t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},b=s=>{try{return`https://www.google.com/s2/favicons?domain=${new URL(s).hostname}&sz=32`}catch{return}};return w?e.jsx("div",{className:"h-full w-full flex items-center justify-center bg-[#1A1D28]",children:e.jsx(L,{size:24,className:"text-blue-400 animate-spin"})}):e.jsxs("div",{className:"h-full w-full bg-[#1A1D28] text-gray-100 flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"History"}),e.jsxs(f.button,{onClick:C,whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-900/60 hover:bg-red-600/20 border border-gray-700/50 text-gray-300 hover:text-red-400 transition-colors",children:[e.jsx(E,{size:18}),e.jsx("span",{children:"Clear browsing data"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),e.jsx("input",{type:"text",value:i,onChange:s=>y(s.target.value),placeholder:"Search history",className:"w-full h-10 pl-10 pr-4 bg-gray-900/60 border border-gray-700/50 rounded-lg text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50"}),i&&e.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300",children:e.jsx(j,{size:18})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:p.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx(v,{size:48,className:"text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-2",children:i?"No results found":"No history yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:i?"Try a different search term":"Pages you visit will appear here"})]}):e.jsx("div",{className:"space-y-6",children:p.map(s=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase tracking-wide",children:s.date}),e.jsx("div",{className:"space-y-1",children:s.entries.map(t=>e.jsxs(f.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"group flex items-center gap-3 p-3 rounded-lg bg-gray-900/60 hover:bg-gray-900/80 border border-gray-800/50 hover:border-gray-700/50 transition-all cursor-pointer",onClick:()=>k(t.url),children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center bg-gray-800/50 rounded border border-gray-700/50",children:t.favicon||b(t.url)?e.jsx("img",{src:t.favicon||b(t.url),alt:"",className:"w-6 h-6",onError:c=>{c.target.style.display="none"}}):e.jsx(v,{size:16,className:"text-gray-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-200 truncate",children:t.title||t.url}),e.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:S(t.timestamp)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"text-xs text-gray-400 truncate",children:t.url}),t.visitCount&&t.visitCount>1&&e.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0",children:[t.visitCount," visits"]})]})]}),e.jsx(f.button,{onClick:c=>{c.stopPropagation(),T(t.url)},whileHover:{scale:1.1},whileTap:{scale:.9},className:"opacity-0 group-hover:opacity-100 flex-shrink-0 p-1.5 rounded-lg hover:bg-red-600/20 text-gray-500 hover:text-red-400 transition-all",title:"Remove from history",children:e.jsx(j,{size:16})})]},t.id))})]},s.date))})})]})}export{Q as default};
//# sourceMappingURL=History-EVYxixGL.js.map
