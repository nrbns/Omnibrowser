import{r as E,j as C,i as Jr,o as oi,p as si,R as S}from"./index-dj7m1cGj.js";import{b as ii}from"./AppShell-DzVtN4M2.js";import{S as sn}from"./shield-check-Drnm7Ghu.js";import{R as eo}from"./refresh-cw-81QnrOuz.js";import{D as to}from"./download-B1WlPeuz.js";import{m as no}from"./proxy-C7NQ8sMs.js";import{T as ro}from"./triangle-alert-CX1V0b5r.js";import{S as Bn}from"./shield-alert-BDTTFe3x.js";import{X as ai}from"./x-kCWGjBIF.js";import{F as ci}from"./filter-DdeWeMTy.js";import{f as li}from"./formatDistanceToNow-Ctx6mZEP.js";import"./use-ipc-event-Mlq2GWsh.js";import"./Portal-Cws6ez_F.js";import"./OmniDesk-XqA-NCuc.js";import"./index-D3V9pHtR.js";import"./sparkles-BXvEuSDZ.js";import"./copy-r_Uv8dWa.js";import"./loader-circle-B2cekLv2.js";import"./agentStreamStore-DATaLJlE.js";import"./cloud-RM87ovcD.js";import"./search-DY2JFyPs.js";import"./clock-C2CbMN6U.js";import"./circle-check-J1xVWsPI.js";import"./external-link-uxSLXU_6.js";import"./trustDashboardStore-CE7KmIta.js";function ui(){const[e,t]=E.useState(null),[n,r]=E.useState(!1),[o,i]=E.useState(null),s=async()=>{try{r(!0);const c=await Jr.consent.vault.export();t(c),r(!1)}catch(c){i(c instanceof Error?c.message:String(c)),r(!1)}};E.useEffect(()=>{s()},[]);const a=()=>{if(!e)return;const c=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),u=URL.createObjectURL(c),l=document.createElement("a");l.href=u,l.download=`consent-vault-${e.updatedAt}.json`,l.click(),URL.revokeObjectURL(u)};return C.jsxs("div",{className:"rounded-3xl border border-emerald-500/30 bg-emerald-950/20 p-4 text-emerald-100 shadow-[0_20px_60px_rgba(16,185,129,0.25)]",children:[C.jsxs("div",{className:"flex items-start justify-between gap-3",children:[C.jsxs("div",{children:[C.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-emerald-200",children:[C.jsx(sn,{size:16})," Quantum Consent Vault"]}),C.jsx("div",{className:"text-xs text-emerald-100/70",children:"Each consent is sealed with a hash-chain signature. Export receipts for audits."})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{type:"button",onClick:()=>void s(),className:"rounded-lg border border-emerald-400/40 bg-emerald-500/10 px-2 py-1 text-[11px] text-emerald-100 hover:bg-emerald-500/20",disabled:n,children:C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx(eo,{size:12,className:n?"animate-spin":""}),"Refresh"]})}),C.jsx("button",{type:"button",onClick:a,disabled:!e,className:"rounded-lg border border-emerald-400/40 bg-emerald-500/10 px-2 py-1 text-[11px] text-emerald-100 hover:bg-emerald-500/20 disabled:cursor-not-allowed disabled:opacity-60",children:C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx(to,{size:12})," Export"]})})]})]}),o&&C.jsx("div",{className:"mt-3 rounded-lg border border-rose-500/40 bg-rose-500/10 px-3 py-2 text-[11px] text-rose-100",children:o}),!o&&C.jsxs("div",{className:"mt-4 max-h-64 overflow-y-auto rounded-2xl border border-emerald-500/15 bg-emerald-900/30",children:[!e&&n&&C.jsx("div",{className:"p-6 text-center text-xs text-emerald-100/70",children:"Loading quantum receiptsâ€¦"}),e&&!n&&C.jsxs("div",{className:"divide-y divide-emerald-500/10 text-[11px]",children:[e.entries.map(c=>{const u=typeof c.metadata=="object"&&c.metadata!==null?c.metadata:void 0,l=typeof u?.risk=="string"?u.risk:void 0,d=typeof u?.target=="string"?u.target:void 0;return C.jsxs(no.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.18},className:"space-y-1 px-4 py-3",children:[C.jsxs("div",{className:"flex items-center justify-between text-emerald-100",children:[C.jsx("span",{className:"font-medium uppercase tracking-wide text-[10px]",children:c.actionType}),C.jsx("span",{className:"text-emerald-200/70",children:new Date(c.timestamp).toLocaleString()})]}),C.jsxs("div",{className:"text-emerald-100/90 break-all",children:["Chain hash: ",c.chainHash]}),C.jsxs("div",{className:"text-emerald-100/70 break-all",children:["Signature: ",c.signature]}),l&&C.jsxs("div",{className:"text-emerald-100/70",children:["Risk: ",l]}),d&&C.jsxs("div",{className:"text-emerald-100/70 break-all",children:["Target: ",d]})]},c.chainHash)}),e.entries.length===0&&C.jsx("div",{className:"p-6 text-center text-xs text-emerald-200/70",children:"Ledger empty. Approve a consent request to generate the first block."})]})]}),e&&C.jsxs("div",{className:"mt-3 text-[10px] text-emerald-200/60",children:["Anchor hash: ",e.anchor]})]})}const fe={download:"Download file",form_submit:"Submit form",login:"Login",scrape:"Scrape content",export_data:"Export data",access_clipboard:"Access clipboard",access_camera:"Access camera",access_microphone:"Access microphone",access_filesystem:"Filesystem access",ai_cloud:"Use cloud AI provider"},di=[{value:"all",label:"All actions"},{value:"download",label:fe.download},{value:"form_submit",label:fe.form_submit},{value:"login",label:fe.login},{value:"scrape",label:fe.scrape},{value:"export_data",label:fe.export_data},{value:"access_clipboard",label:fe.access_clipboard},{value:"access_camera",label:fe.access_camera},{value:"access_microphone",label:fe.access_microphone},{value:"access_filesystem",label:fe.access_filesystem},{value:"ai_cloud",label:fe.ai_cloud}],fi=[{value:"all",label:"All statuses"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"revoked",label:"Revoked"}];function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ie(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const{useDebugValue:hi}=S,{useSyncExternalStoreWithSelector:pi}=si,gi=e=>e;function oo(e,t=gi,n){const r=pi(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return hi(r),r}const dr=(e,t)=>{const n=oi(e),r=(o,i=t)=>oo(n,o,i);return Object.assign(r,n),r},mi=(e,t)=>e?dr(e,t):dr;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var yi={value:()=>{}};function an(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Yt(n)}function Yt(e){this._=e}function xi(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Yt.prototype=an.prototype={constructor:Yt,on:function(e,t){var n=this._,r=xi(e+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(e=r[i]).type)&&(o=wi(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(o=(e=r[i]).type)n[o]=fr(n[o],e.name,t);else if(t==null)for(o in n)n[o]=fr(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Yt(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};function wi(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function fr(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=yi,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cn="http://www.w3.org/1999/xhtml";const hr={svg:"http://www.w3.org/2000/svg",xhtml:Cn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),hr.hasOwnProperty(t)?{space:hr[t],local:e}:e}function vi(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cn&&t.documentElement.namespaceURI===Cn?t.createElement(e):t.createElementNS(n,e)}}function bi(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function so(e){var t=cn(e);return(t.local?bi:vi)(t)}function _i(){}function Fn(e){return e==null?_i:function(){return this.querySelector(e)}}function Ei(e){typeof e!="function"&&(e=Fn(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=new Array(s),c,u,l=0;l<s;++l)(c=i[l])&&(u=e.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new le(r,this._parents)}function Ni(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Si(){return[]}function io(e){return e==null?Si:function(){return this.querySelectorAll(e)}}function Ci(e){return function(){return Ni(e.apply(this,arguments))}}function Ai(e){typeof e=="function"?e=Ci(e):e=io(e);for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(r.push(e.call(c,c.__data__,u,s)),o.push(c));return new le(r,o)}function ao(e){return function(){return this.matches(e)}}function co(e){return function(t){return t.matches(e)}}var ki=Array.prototype.find;function Mi(e){return function(){return ki.call(this.children,e)}}function $i(){return this.firstElementChild}function Ti(e){return this.select(e==null?$i:Mi(typeof e=="function"?e:co(e)))}var Ri=Array.prototype.filter;function zi(){return Array.from(this.children)}function Ii(e){return function(){return Ri.call(this.children,e)}}function Di(e){return this.selectAll(e==null?zi:Ii(typeof e=="function"?e:co(e)))}function Hi(e){typeof e!="function"&&(e=ao(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new le(r,this._parents)}function lo(e){return new Array(e.length)}function Pi(){return new le(this._enter||this._groups.map(lo),this._parents)}function Gt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Gt.prototype={constructor:Gt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Oi(e){return function(){return e}}function Vi(e,t,n,r,o,i){for(var s=0,a,c=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new Gt(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function Li(e,t,n,r,o,i,s){var a,c,u=new Map,l=t.length,d=i.length,h=new Array(l),g;for(a=0;a<l;++a)(c=t[a])&&(h[a]=g=s.call(c,c.__data__,a,t)+"",u.has(g)?o[a]=c:u.set(g,c));for(a=0;a<d;++a)g=s.call(e,i[a],a,i)+"",(c=u.get(g))?(r[a]=c,c.__data__=i[a],u.delete(g)):n[a]=new Gt(e,i[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(h[a])===c&&(o[a]=c)}function ji(e){return e.__data__}function Bi(e,t){if(!arguments.length)return Array.from(this,ji);var n=t?Li:Vi,r=this._parents,o=this._groups;typeof e!="function"&&(e=Oi(e));for(var i=o.length,s=new Array(i),a=new Array(i),c=new Array(i),u=0;u<i;++u){var l=r[u],d=o[u],h=d.length,g=Fi(e.call(l,l&&l.__data__,u,r)),x=g.length,m=a[u]=new Array(x),w=s[u]=new Array(x),p=c[u]=new Array(h);n(l,d,m,w,p,g,t);for(var _=0,A=0,y,M;_<x;++_)if(y=m[_]){for(_>=A&&(A=_+1);!(M=w[A])&&++A<x;);y._next=M||null}}return s=new le(s,r),s._enter=a,s._exit=c,s}function Fi(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Xi(){return new le(this._exit||this._groups.map(lo),this._parents)}function Yi(e,t,n){var r=this.enter(),o=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Ui(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,i=r.length,s=Math.min(o,i),a=new Array(o),c=0;c<s;++c)for(var u=n[c],l=r[c],d=u.length,h=a[c]=new Array(d),g,x=0;x<d;++x)(g=u[x]||l[x])&&(h[x]=g);for(;c<o;++c)a[c]=n[c];return new le(a,this._parents)}function Zi(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function qi(e){e||(e=Gi);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],a=s.length,c=o[i]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(t)}return new le(o,this._parents).order()}function Gi(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Wi(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ki(){return Array.from(this)}function Qi(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Ji(){let e=0;for(const t of this)++e;return e}function ea(){return!this.node()}function ta(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o=t[n],i=0,s=o.length,a;i<s;++i)(a=o[i])&&e.call(a,a.__data__,i,o);return this}function na(e){return function(){this.removeAttribute(e)}}function ra(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oa(e,t){return function(){this.setAttribute(e,t)}}function sa(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ia(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function aa(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ca(e,t){var n=cn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?ra:na:typeof t=="function"?n.local?aa:ia:n.local?sa:oa)(n,t))}function uo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function la(e){return function(){this.style.removeProperty(e)}}function ua(e,t,n){return function(){this.style.setProperty(e,t,n)}}function da(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function fa(e,t,n){return arguments.length>1?this.each((t==null?la:typeof t=="function"?da:ua)(e,t,n??"")):dt(this.node(),e)}function dt(e,t){return e.style.getPropertyValue(t)||uo(e).getComputedStyle(e,null).getPropertyValue(t)}function ha(e){return function(){delete this[e]}}function pa(e,t){return function(){this[e]=t}}function ga(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ma(e,t){return arguments.length>1?this.each((t==null?ha:typeof t=="function"?ga:pa)(e,t)):this.node()[e]}function fo(e){return e.trim().split(/^|\s+/)}function Xn(e){return e.classList||new ho(e)}function ho(e){this._node=e,this._names=fo(e.getAttribute("class")||"")}ho.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function po(e,t){for(var n=Xn(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function go(e,t){for(var n=Xn(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function ya(e){return function(){po(this,e)}}function xa(e){return function(){go(this,e)}}function wa(e,t){return function(){(t.apply(this,arguments)?po:go)(this,e)}}function va(e,t){var n=fo(e+"");if(arguments.length<2){for(var r=Xn(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?wa:t?ya:xa)(n,t))}function ba(){this.textContent=""}function _a(e){return function(){this.textContent=e}}function Ea(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Na(e){return arguments.length?this.each(e==null?ba:(typeof e=="function"?Ea:_a)(e)):this.node().textContent}function Sa(){this.innerHTML=""}function Ca(e){return function(){this.innerHTML=e}}function Aa(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ka(e){return arguments.length?this.each(e==null?Sa:(typeof e=="function"?Aa:Ca)(e)):this.node().innerHTML}function Ma(){this.nextSibling&&this.parentNode.appendChild(this)}function $a(){return this.each(Ma)}function Ta(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ra(){return this.each(Ta)}function za(e){var t=typeof e=="function"?e:so(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ia(){return null}function Da(e,t){var n=typeof e=="function"?e:so(e),r=t==null?Ia:typeof t=="function"?t:Fn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ha(){var e=this.parentNode;e&&e.removeChild(this)}function Pa(){return this.each(Ha)}function Oa(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Va(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function La(e){return this.select(e?Va:Oa)}function ja(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ba(e){return function(t){e.call(this,t,this.__data__)}}function Fa(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Xa(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Ya(e,t,n){return function(){var r=this.__on,o,i=Ba(t);if(r){for(var s=0,a=r.length;s<a;++s)if((o=r[s]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Ua(e,t,n){var r=Fa(e+""),o,i=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(o=0,l=a[c];o<i;++o)if((s=r[o]).type===l.type&&s.name===l.name)return l.value}return}for(a=t?Ya:Xa,o=0;o<i;++o)this.each(a(r[o],t,n));return this}function mo(e,t,n){var r=uo(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Za(e,t){return function(){return mo(this,e,t)}}function qa(e,t){return function(){return mo(this,e,t.apply(this,arguments))}}function Ga(e,t){return this.each((typeof t=="function"?qa:Za)(e,t))}function*Wa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var yo=[null];function le(e,t){this._groups=e,this._parents=t}function zt(){return new le([[document.documentElement]],yo)}function Ka(){return this}le.prototype=zt.prototype={constructor:le,select:Ei,selectAll:Ai,selectChild:Ti,selectChildren:Di,filter:Hi,data:Bi,enter:Pi,exit:Xi,join:Yi,merge:Ui,selection:Ka,order:Zi,sort:qi,call:Wi,nodes:Ki,node:Qi,size:Ji,empty:ea,each:ta,attr:ca,style:fa,property:ma,classed:va,text:Na,html:ka,raise:$a,lower:Ra,append:za,insert:Da,remove:Pa,clone:La,datum:ja,on:Ua,dispatch:Ga,[Symbol.iterator]:Wa};function me(e){return typeof e=="string"?new le([[document.querySelector(e)]],[document.documentElement]):new le([[e]],yo)}function Qa(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ee(e,t){if(e=Qa(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ja={passive:!1},Ct={capture:!0,passive:!1};function yn(e){e.stopImmediatePropagation()}function at(e){e.preventDefault(),e.stopImmediatePropagation()}function xo(e){var t=e.document.documentElement,n=me(e).on("dragstart.drag",at,Ct);"onselectstart"in t?n.on("selectstart.drag",at,Ct):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function wo(e,t){var n=e.document.documentElement,r=me(e).on("dragstart.drag",null);t&&(r.on("click.drag",at,Ct),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ht=e=>()=>e;function An(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}An.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ec(e){return!e.ctrlKey&&!e.button}function tc(){return this.parentNode}function nc(e,t){return t??{x:e.x,y:e.y}}function rc(){return navigator.maxTouchPoints||"ontouchstart"in this}function oc(){var e=ec,t=tc,n=nc,r=rc,o={},i=an("start","drag","end"),s=0,a,c,u,l,d=0;function h(y){y.on("mousedown.drag",g).filter(r).on("touchstart.drag",w).on("touchmove.drag",p,Ja).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(y,M){if(!(l||!e.call(this,y,M))){var $=A(this,t.call(this,y,M),y,M,"mouse");$&&(me(y.view).on("mousemove.drag",x,Ct).on("mouseup.drag",m,Ct),xo(y.view),yn(y),u=!1,a=y.clientX,c=y.clientY,$("start",y))}}function x(y){if(at(y),!u){var M=y.clientX-a,$=y.clientY-c;u=M*M+$*$>d}o.mouse("drag",y)}function m(y){me(y.view).on("mousemove.drag mouseup.drag",null),wo(y.view,u),at(y),o.mouse("end",y)}function w(y,M){if(e.call(this,y,M)){var $=y.changedTouches,O=t.call(this,y,M),H=$.length,R,V;for(R=0;R<H;++R)(V=A(this,O,y,M,$[R].identifier,$[R]))&&(yn(y),V("start",y,$[R]))}}function p(y){var M=y.changedTouches,$=M.length,O,H;for(O=0;O<$;++O)(H=o[M[O].identifier])&&(at(y),H("drag",y,M[O]))}function _(y){var M=y.changedTouches,$=M.length,O,H;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),O=0;O<$;++O)(H=o[M[O].identifier])&&(yn(y),H("end",y,M[O]))}function A(y,M,$,O,H,R){var V=i.copy(),L=Ee(R||$,M),j,P,f;if((f=n.call(y,new An("beforestart",{sourceEvent:$,target:h,identifier:H,active:s,x:L[0],y:L[1],dx:0,dy:0,dispatch:V}),O))!=null)return j=f.x-L[0]||0,P=f.y-L[1]||0,function N(v,k,I){var b=L,T;switch(v){case"start":o[H]=N,T=s++;break;case"end":delete o[H],--s;case"drag":L=Ee(I||k,M),T=s;break}V.call(v,y,new An(v,{sourceEvent:k,subject:f,target:h,identifier:H,active:T,x:L[0]+j,y:L[1]+P,dx:L[0]-b[0],dy:L[1]-b[1],dispatch:V}),O)}}return h.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Ht(!!y),h):e},h.container=function(y){return arguments.length?(t=typeof y=="function"?y:Ht(y),h):t},h.subject=function(y){return arguments.length?(n=typeof y=="function"?y:Ht(y),h):n},h.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:Ht(!!y),h):r},h.on=function(){var y=i.on.apply(i,arguments);return y===i?h:y},h.clickDistance=function(y){return arguments.length?(d=(y=+y)*y,h):Math.sqrt(d)},h}function Yn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vo(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function It(){}var At=.7,Wt=1/At,ct="\\s*([+-]?\\d+)\\s*",kt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ne="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",sc=/^#([0-9a-f]{3,8})$/,ic=new RegExp(`^rgb\\(${ct},${ct},${ct}\\)$`),ac=new RegExp(`^rgb\\(${Ne},${Ne},${Ne}\\)$`),cc=new RegExp(`^rgba\\(${ct},${ct},${ct},${kt}\\)$`),lc=new RegExp(`^rgba\\(${Ne},${Ne},${Ne},${kt}\\)$`),uc=new RegExp(`^hsl\\(${kt},${Ne},${Ne}\\)$`),dc=new RegExp(`^hsla\\(${kt},${Ne},${Ne},${kt}\\)$`),pr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yn(It,Mt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:gr,formatHex:gr,formatHex8:fc,formatHsl:hc,formatRgb:mr,toString:mr});function gr(){return this.rgb().formatHex()}function fc(){return this.rgb().formatHex8()}function hc(){return bo(this).formatHsl()}function mr(){return this.rgb().formatRgb()}function Mt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=sc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?yr(t):n===3?new ae(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Pt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Pt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ic.exec(e))?new ae(t[1],t[2],t[3],1):(t=ac.exec(e))?new ae(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=cc.exec(e))?Pt(t[1],t[2],t[3],t[4]):(t=lc.exec(e))?Pt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=uc.exec(e))?vr(t[1],t[2]/100,t[3]/100,1):(t=dc.exec(e))?vr(t[1],t[2]/100,t[3]/100,t[4]):pr.hasOwnProperty(e)?yr(pr[e]):e==="transparent"?new ae(NaN,NaN,NaN,0):null}function yr(e){return new ae(e>>16&255,e>>8&255,e&255,1)}function Pt(e,t,n,r){return r<=0&&(e=t=n=NaN),new ae(e,t,n,r)}function pc(e){return e instanceof It||(e=Mt(e)),e?(e=e.rgb(),new ae(e.r,e.g,e.b,e.opacity)):new ae}function kn(e,t,n,r){return arguments.length===1?pc(e):new ae(e,t,n,r??1)}function ae(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Yn(ae,kn,vo(It,{brighter(e){return e=e==null?Wt:Math.pow(Wt,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?At:Math.pow(At,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ae(Ze(this.r),Ze(this.g),Ze(this.b),Kt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xr,formatHex:xr,formatHex8:gc,formatRgb:wr,toString:wr}));function xr(){return`#${Ye(this.r)}${Ye(this.g)}${Ye(this.b)}`}function gc(){return`#${Ye(this.r)}${Ye(this.g)}${Ye(this.b)}${Ye((isNaN(this.opacity)?1:this.opacity)*255)}`}function wr(){const e=Kt(this.opacity);return`${e===1?"rgb(":"rgba("}${Ze(this.r)}, ${Ze(this.g)}, ${Ze(this.b)}${e===1?")":`, ${e})`}`}function Kt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ze(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ye(e){return e=Ze(e),(e<16?"0":"")+e.toString(16)}function vr(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ye(e,t,n,r)}function bo(e){if(e instanceof ye)return new ye(e.h,e.s,e.l,e.opacity);if(e instanceof It||(e=Mt(e)),!e)return new ye;if(e instanceof ye)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),i=Math.max(t,n,r),s=NaN,a=i-o,c=(i+o)/2;return a?(t===i?s=(n-r)/a+(n<r)*6:n===i?s=(r-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+o:2-i-o,s*=60):a=c>0&&c<1?0:s,new ye(s,a,c,e.opacity)}function mc(e,t,n,r){return arguments.length===1?bo(e):new ye(e,t,n,r??1)}function ye(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Yn(ye,mc,vo(It,{brighter(e){return e=e==null?Wt:Math.pow(Wt,e),new ye(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?At:Math.pow(At,e),new ye(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new ae(xn(e>=240?e-240:e+120,o,r),xn(e,o,r),xn(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new ye(br(this.h),Ot(this.s),Ot(this.l),Kt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Kt(this.opacity);return`${e===1?"hsl(":"hsla("}${br(this.h)}, ${Ot(this.s)*100}%, ${Ot(this.l)*100}%${e===1?")":`, ${e})`}`}}));function br(e){return e=(e||0)%360,e<0?e+360:e}function Ot(e){return Math.max(0,Math.min(1,e||0))}function xn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const _o=e=>()=>e;function yc(e,t){return function(n){return e+n*t}}function xc(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function wc(e){return(e=+e)==1?Eo:function(t,n){return n-t?xc(t,n,e):_o(isNaN(t)?n:t)}}function Eo(e,t){var n=t-e;return n?yc(e,n):_o(isNaN(e)?t:e)}const _r=(function e(t){var n=wc(t);function r(o,i){var s=n((o=kn(o)).r,(i=kn(i)).r),a=n(o.g,i.g),c=n(o.b,i.b),u=Eo(o.opacity,i.opacity);return function(l){return o.r=s(l),o.g=a(l),o.b=c(l),o.opacity=u(l),o+""}}return r.gamma=e,r})(1);function Re(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Mn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wn=new RegExp(Mn.source,"g");function vc(e){return function(){return e}}function bc(e){return function(t){return e(t)+""}}function _c(e,t){var n=Mn.lastIndex=wn.lastIndex=0,r,o,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(r=Mn.exec(e))&&(o=wn.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(r=r[0])===(o=o[0])?a[s]?a[s]+=o:a[++s]=o:(a[++s]=null,c.push({i:s,x:Re(r,o)})),n=wn.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?bc(c[0].x):vc(t):(t=c.length,function(u){for(var l=0,d;l<t;++l)a[(d=c[l]).i]=d.x(u);return a.join("")})}var Er=180/Math.PI,$n={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function No(e,t,n,r,o,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Er,skewX:Math.atan(c)*Er,scaleX:s,scaleY:a}}var Vt;function Ec(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$n:No(t.a,t.b,t.c,t.d,t.e,t.f)}function Nc(e){return e==null||(Vt||(Vt=document.createElementNS("http://www.w3.org/2000/svg","g")),Vt.setAttribute("transform",e),!(e=Vt.transform.baseVal.consolidate()))?$n:(e=e.matrix,No(e.a,e.b,e.c,e.d,e.e,e.f))}function So(e,t,n,r){function o(u){return u.length?u.pop()+" ":""}function i(u,l,d,h,g,x){if(u!==d||l!==h){var m=g.push("translate(",null,t,null,n);x.push({i:m-4,x:Re(u,d)},{i:m-2,x:Re(l,h)})}else(d||h)&&g.push("translate("+d+t+h+n)}function s(u,l,d,h){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),h.push({i:d.push(o(d)+"rotate(",null,r)-2,x:Re(u,l)})):l&&d.push(o(d)+"rotate("+l+r)}function a(u,l,d,h){u!==l?h.push({i:d.push(o(d)+"skewX(",null,r)-2,x:Re(u,l)}):l&&d.push(o(d)+"skewX("+l+r)}function c(u,l,d,h,g,x){if(u!==d||l!==h){var m=g.push(o(g)+"scale(",null,",",null,")");x.push({i:m-4,x:Re(u,d)},{i:m-2,x:Re(l,h)})}else(d!==1||h!==1)&&g.push(o(g)+"scale("+d+","+h+")")}return function(u,l){var d=[],h=[];return u=e(u),l=e(l),i(u.translateX,u.translateY,l.translateX,l.translateY,d,h),s(u.rotate,l.rotate,d,h),a(u.skewX,l.skewX,d,h),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,d,h),u=l=null,function(g){for(var x=-1,m=h.length,w;++x<m;)d[(w=h[x]).i]=w.x(g);return d.join("")}}}var Sc=So(Ec,"px, ","px)","deg)"),Cc=So(Nc,", ",")",")"),Ac=1e-12;function Nr(e){return((e=Math.exp(e))+1/e)/2}function kc(e){return((e=Math.exp(e))-1/e)/2}function Mc(e){return((e=Math.exp(2*e))-1)/(e+1)}const $c=(function e(t,n,r){function o(i,s){var a=i[0],c=i[1],u=i[2],l=s[0],d=s[1],h=s[2],g=l-a,x=d-c,m=g*g+x*x,w,p;if(m<Ac)p=Math.log(h/u)/t,w=function(O){return[a+O*g,c+O*x,u*Math.exp(t*O*p)]};else{var _=Math.sqrt(m),A=(h*h-u*u+r*m)/(2*u*n*_),y=(h*h-u*u-r*m)/(2*h*n*_),M=Math.log(Math.sqrt(A*A+1)-A),$=Math.log(Math.sqrt(y*y+1)-y);p=($-M)/t,w=function(O){var H=O*p,R=Nr(M),V=u/(n*_)*(R*Mc(t*H+M)-kc(M));return[a+V*g,c+V*x,u*R/Nr(t*H+M)]}}return w.duration=p*1e3*t/Math.SQRT2,w}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o})(Math.SQRT2,2,4);var ft=0,Et=0,xt=0,Co=1e3,Qt,Nt,Jt=0,qe=0,ln=0,$t=typeof performance=="object"&&performance.now?performance:Date,Ao=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Un(){return qe||(Ao(Tc),qe=$t.now()+ln)}function Tc(){qe=0}function en(){this._call=this._time=this._next=null}en.prototype=ko.prototype={constructor:en,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Un():+n)+(t==null?0:+t),!this._next&&Nt!==this&&(Nt?Nt._next=this:Qt=this,Nt=this),this._call=e,this._time=n,Tn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tn())}};function ko(e,t,n){var r=new en;return r.restart(e,t,n),r}function Rc(){Un(),++ft;for(var e=Qt,t;e;)(t=qe-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ft}function Sr(){qe=(Jt=$t.now())+ln,ft=Et=0;try{Rc()}finally{ft=0,Ic(),qe=0}}function zc(){var e=$t.now(),t=e-Jt;t>Co&&(ln-=t,Jt=e)}function Ic(){for(var e,t=Qt,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qt=n);Nt=e,Tn(r)}function Tn(e){if(!ft){Et&&(Et=clearTimeout(Et));var t=e-qe;t>24?(e<1/0&&(Et=setTimeout(Sr,e-$t.now()-ln)),xt&&(xt=clearInterval(xt))):(xt||(Jt=$t.now(),xt=setInterval(zc,Co)),ft=1,Ao(Sr))}}function Cr(e,t,n){var r=new en;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,n),r}var Dc=an("start","end","cancel","interrupt"),Hc=[],Mo=0,Ar=1,Rn=2,Ut=3,kr=4,zn=5,Zt=6;function un(e,t,n,r,o,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Pc(e,n,{name:t,index:r,group:o,on:Dc,tween:Hc,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Mo})}function Zn(e,t){var n=we(e,t);if(n.state>Mo)throw new Error("too late; already scheduled");return n}function Se(e,t){var n=we(e,t);if(n.state>Ut)throw new Error("too late; already running");return n}function we(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Pc(e,t,n){var r=e.__transition,o;r[t]=n,n.timer=ko(i,0,n.time);function i(u){n.state=Ar,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,d,h,g;if(n.state!==Ar)return c();for(l in r)if(g=r[l],g.name===n.name){if(g.state===Ut)return Cr(s);g.state===kr?(g.state=Zt,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[l]):+l<t&&(g.state=Zt,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[l])}if(Cr(function(){n.state===Ut&&(n.state=kr,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Rn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Rn){for(n.state=Ut,o=new Array(h=n.tween.length),l=0,d=-1;l<h;++l)(g=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(o[++d]=g);o.length=d+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=zn,1),d=-1,h=o.length;++d<h;)o[d].call(e,l);n.state===zn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Zt,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function qt(e,t){var n=e.__transition,r,o,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){i=!1;continue}o=r.state>Rn&&r.state<zn,r.state=Zt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}i&&delete e.__transition}}function Oc(e){return this.each(function(){qt(this,e)})}function Vc(e,t){var n,r;return function(){var o=Se(this,e),i=o.tween;if(i!==n){r=n=i;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function Lc(e,t,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Se(this,e),s=i.tween;if(s!==r){o=(r=s).slice();for(var a={name:t,value:n},c=0,u=o.length;c<u;++c)if(o[c].name===t){o[c]=a;break}c===u&&o.push(a)}i.tween=o}}function jc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=we(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===e)return s.value;return null}return this.each((t==null?Vc:Lc)(n,e,t))}function qn(e,t,n){var r=e._id;return e.each(function(){var o=Se(this,r);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return we(o,r).value[t]}}function $o(e,t){var n;return(typeof t=="number"?Re:t instanceof Mt?_r:(n=Mt(t))?(t=n,_r):_c)(e,t)}function Bc(e){return function(){this.removeAttribute(e)}}function Fc(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Xc(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function Yc(e,t,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function Uc(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function Zc(e,t,n){var r,o,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a)))}}function qc(e,t){var n=cn(e),r=n==="transform"?Cc:$o;return this.attrTween(e,typeof t=="function"?(n.local?Zc:Uc)(n,r,qn(this,"attr."+e,t)):t==null?(n.local?Fc:Bc)(n):(n.local?Yc:Xc)(n,r,t))}function Gc(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Wc(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Kc(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Wc(e,i)),n}return o._value=t,o}function Qc(e,t){var n,r;function o(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Gc(e,i)),n}return o._value=t,o}function Jc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=cn(e);return this.tween(n,(r.local?Kc:Qc)(r,t))}function el(e,t){return function(){Zn(this,e).delay=+t.apply(this,arguments)}}function tl(e,t){return t=+t,function(){Zn(this,e).delay=t}}function nl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?el:tl)(t,e)):we(this.node(),t).delay}function rl(e,t){return function(){Se(this,e).duration=+t.apply(this,arguments)}}function ol(e,t){return t=+t,function(){Se(this,e).duration=t}}function sl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?rl:ol)(t,e)):we(this.node(),t).duration}function il(e,t){if(typeof t!="function")throw new Error;return function(){Se(this,e).ease=t}}function al(e){var t=this._id;return arguments.length?this.each(il(t,e)):we(this.node(),t).ease}function cl(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Se(this,e).ease=n}}function ll(e){if(typeof e!="function")throw new Error;return this.each(cl(this._id,e))}function ul(e){typeof e!="function"&&(e=ao(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i=t[o],s=i.length,a=r[o]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new Me(r,this._parents,this._name,this._id)}function dl(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),s=new Array(r),a=0;a<i;++a)for(var c=t[a],u=n[a],l=c.length,d=s[a]=new Array(l),h,g=0;g<l;++g)(h=c[g]||u[g])&&(d[g]=h);for(;a<r;++a)s[a]=t[a];return new Me(s,this._parents,this._name,this._id)}function fl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function hl(e,t,n){var r,o,i=fl(t)?Zn:Se;return function(){var s=i(this,e),a=s.on;a!==r&&(o=(r=a).copy()).on(t,n),s.on=o}}function pl(e,t){var n=this._id;return arguments.length<2?we(this.node(),n).on.on(e):this.each(hl(n,e,t))}function gl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ml(){return this.on("end.remove",gl(this._id))}function yl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Fn(e));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var a=r[s],c=a.length,u=i[s]=new Array(c),l,d,h=0;h<c;++h)(l=a[h])&&(d=e.call(l,l.__data__,h,a))&&("__data__"in l&&(d.__data__=l.__data__),u[h]=d,un(u[h],t,n,h,u,we(l,n)));return new Me(i,this._parents,t,n)}function xl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=io(e));for(var r=this._groups,o=r.length,i=[],s=[],a=0;a<o;++a)for(var c=r[a],u=c.length,l,d=0;d<u;++d)if(l=c[d]){for(var h=e.call(l,l.__data__,d,c),g,x=we(l,n),m=0,w=h.length;m<w;++m)(g=h[m])&&un(g,t,n,m,h,x);i.push(h),s.push(l)}return new Me(i,s,t,n)}var wl=zt.prototype.constructor;function vl(){return new wl(this._groups,this._parents)}function bl(e,t){var n,r,o;return function(){var i=dt(this,e),s=(this.style.removeProperty(e),dt(this,e));return i===s?null:i===n&&s===r?o:o=t(n=i,r=s)}}function To(e){return function(){this.style.removeProperty(e)}}function _l(e,t,n){var r,o=n+"",i;return function(){var s=dt(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}function El(e,t,n){var r,o,i;return function(){var s=dt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),dt(this,e))),s===c?null:s===r&&c===o?i:(o=c,i=t(r=s,a))}}function Nl(e,t){var n,r,o,i="style."+t,s="end."+i,a;return function(){var c=Se(this,e),u=c.on,l=c.value[i]==null?a||(a=To(t)):void 0;(u!==n||o!==l)&&(r=(n=u).copy()).on(s,o=l),c.on=r}}function Sl(e,t,n){var r=(e+="")=="transform"?Sc:$o;return t==null?this.styleTween(e,bl(e,r)).on("end.style."+e,To(e)):typeof t=="function"?this.styleTween(e,El(e,r,qn(this,"style."+e,t))).each(Nl(this._id,e)):this.styleTween(e,_l(e,r,t),n).on("end.style."+e,null)}function Cl(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Al(e,t,n){var r,o;function i(){var s=t.apply(this,arguments);return s!==o&&(r=(o=s)&&Cl(e,s,n)),r}return i._value=t,i}function kl(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Al(e,t,n??""))}function Ml(e){return function(){this.textContent=e}}function $l(e){return function(){var t=e(this);this.textContent=t??""}}function Tl(e){return this.tween("text",typeof e=="function"?$l(qn(this,"text",e)):Ml(e==null?"":e+""))}function Rl(e){return function(t){this.textContent=e.call(this,t)}}function zl(e){var t,n;function r(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&Rl(o)),t}return r._value=e,r}function Il(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,zl(e))}function Dl(){for(var e=this._name,t=this._id,n=Ro(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=we(c,t);un(c,e,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Me(r,this._parents,e,n)}function Hl(){var e,t,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--o===0&&i()}};n.each(function(){var u=Se(this,r),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),o===0&&i()})}var Pl=0;function Me(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ro(){return++Pl}var Ae=zt.prototype;Me.prototype={constructor:Me,select:yl,selectAll:xl,selectChild:Ae.selectChild,selectChildren:Ae.selectChildren,filter:ul,merge:dl,selection:vl,transition:Dl,call:Ae.call,nodes:Ae.nodes,node:Ae.node,size:Ae.size,empty:Ae.empty,each:Ae.each,on:pl,attr:qc,attrTween:Jc,style:Sl,styleTween:kl,text:Tl,textTween:Il,remove:ml,tween:jc,delay:nl,duration:sl,ease:al,easeVarying:ll,end:Hl,[Symbol.iterator]:Ae[Symbol.iterator]};function Ol(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Vl={time:null,delay:0,duration:250,ease:Ol};function Ll(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function jl(e){var t,n;e instanceof Me?(t=e._id,e=e._name):(t=Ro(),(n=Vl).time=Un(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&un(c,e,t,u,s,n||Ll(c,t));return new Me(r,this._parents,e,t)}zt.prototype.interrupt=Oc;zt.prototype.transition=jl;const Lt=e=>()=>e;function Bl(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function ke(e,t,n){this.k=e,this.x=t,this.y=n}ke.prototype={constructor:ke,scale:function(e){return e===1?this:new ke(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ke(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var De=new ke(1,0,0);ke.prototype;function vn(e){e.stopImmediatePropagation()}function wt(e){e.preventDefault(),e.stopImmediatePropagation()}function Fl(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Xl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Mr(){return this.__zoom||De}function Yl(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ul(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zl(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function ql(){var e=Fl,t=Xl,n=Zl,r=Yl,o=Ul,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=$c,u=an("start","zoom","end"),l,d,h,g=500,x=150,m=0,w=10;function p(f){f.property("__zoom",Mr).on("wheel.zoom",H,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",V).filter(o).on("touchstart.zoom",L).on("touchmove.zoom",j).on("touchend.zoom touchcancel.zoom",P).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(f,N,v,k){var I=f.selection?f.selection():f;I.property("__zoom",Mr),f!==I?M(f,N,v,k):I.interrupt().each(function(){$(this,arguments).event(k).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},p.scaleBy=function(f,N,v,k){p.scaleTo(f,function(){var I=this.__zoom.k,b=typeof N=="function"?N.apply(this,arguments):N;return I*b},v,k)},p.scaleTo=function(f,N,v,k){p.transform(f,function(){var I=t.apply(this,arguments),b=this.__zoom,T=v==null?y(I):typeof v=="function"?v.apply(this,arguments):v,z=b.invert(T),D=typeof N=="function"?N.apply(this,arguments):N;return n(A(_(b,D),T,z),I,s)},v,k)},p.translateBy=function(f,N,v,k){p.transform(f,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof v=="function"?v.apply(this,arguments):v),t.apply(this,arguments),s)},null,k)},p.translateTo=function(f,N,v,k,I){p.transform(f,function(){var b=t.apply(this,arguments),T=this.__zoom,z=k==null?y(b):typeof k=="function"?k.apply(this,arguments):k;return n(De.translate(z[0],z[1]).scale(T.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof v=="function"?-v.apply(this,arguments):-v),b,s)},k,I)};function _(f,N){return N=Math.max(i[0],Math.min(i[1],N)),N===f.k?f:new ke(N,f.x,f.y)}function A(f,N,v){var k=N[0]-v[0]*f.k,I=N[1]-v[1]*f.k;return k===f.x&&I===f.y?f:new ke(f.k,k,I)}function y(f){return[(+f[0][0]+ +f[1][0])/2,(+f[0][1]+ +f[1][1])/2]}function M(f,N,v,k){f.on("start.zoom",function(){$(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){$(this,arguments).event(k).end()}).tween("zoom",function(){var I=this,b=arguments,T=$(I,b).event(k),z=t.apply(I,b),D=v==null?y(z):typeof v=="function"?v.apply(I,b):v,F=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),B=I.__zoom,U=typeof N=="function"?N.apply(I,b):N,q=c(B.invert(D).concat(F/B.k),U.invert(D).concat(F/U.k));return function(G){if(G===1)G=U;else{var W=q(G),ee=F/W[2];G=new ke(ee,D[0]-W[0]*ee,D[1]-W[1]*ee)}T.zoom(null,G)}})}function $(f,N,v){return!v&&f.__zooming||new O(f,N)}function O(f,N){this.that=f,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(f,N),this.taps=0}O.prototype={event:function(f){return f&&(this.sourceEvent=f),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(f,N){return this.mouse&&f!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&f!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&f!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(f){var N=me(this.that).datum();u.call(f,this.that,new Bl(f,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:u}),N)}};function H(f,...N){if(!e.apply(this,arguments))return;var v=$(this,N).event(f),k=this.__zoom,I=Math.max(i[0],Math.min(i[1],k.k*Math.pow(2,r.apply(this,arguments)))),b=Ee(f);if(v.wheel)(v.mouse[0][0]!==b[0]||v.mouse[0][1]!==b[1])&&(v.mouse[1]=k.invert(v.mouse[0]=b)),clearTimeout(v.wheel);else{if(k.k===I)return;v.mouse=[b,k.invert(b)],qt(this),v.start()}wt(f),v.wheel=setTimeout(T,x),v.zoom("mouse",n(A(_(k,I),v.mouse[0],v.mouse[1]),v.extent,s));function T(){v.wheel=null,v.end()}}function R(f,...N){if(h||!e.apply(this,arguments))return;var v=f.currentTarget,k=$(this,N,!0).event(f),I=me(f.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",F,!0),b=Ee(f,v),T=f.clientX,z=f.clientY;xo(f.view),vn(f),k.mouse=[b,this.__zoom.invert(b)],qt(this),k.start();function D(B){if(wt(B),!k.moved){var U=B.clientX-T,q=B.clientY-z;k.moved=U*U+q*q>m}k.event(B).zoom("mouse",n(A(k.that.__zoom,k.mouse[0]=Ee(B,v),k.mouse[1]),k.extent,s))}function F(B){I.on("mousemove.zoom mouseup.zoom",null),wo(B.view,k.moved),wt(B),k.event(B).end()}}function V(f,...N){if(e.apply(this,arguments)){var v=this.__zoom,k=Ee(f.changedTouches?f.changedTouches[0]:f,this),I=v.invert(k),b=v.k*(f.shiftKey?.5:2),T=n(A(_(v,b),k,I),t.apply(this,N),s);wt(f),a>0?me(this).transition().duration(a).call(M,T,k,f):me(this).call(p.transform,T,k,f)}}function L(f,...N){if(e.apply(this,arguments)){var v=f.touches,k=v.length,I=$(this,N,f.changedTouches.length===k).event(f),b,T,z,D;for(vn(f),T=0;T<k;++T)z=v[T],D=Ee(z,this),D=[D,this.__zoom.invert(D),z.identifier],I.touch0?!I.touch1&&I.touch0[2]!==D[2]&&(I.touch1=D,I.taps=0):(I.touch0=D,b=!0,I.taps=1+!!l);l&&(l=clearTimeout(l)),b&&(I.taps<2&&(d=D[0],l=setTimeout(function(){l=null},g)),qt(this),I.start())}}function j(f,...N){if(this.__zooming){var v=$(this,N).event(f),k=f.changedTouches,I=k.length,b,T,z,D;for(wt(f),b=0;b<I;++b)T=k[b],z=Ee(T,this),v.touch0&&v.touch0[2]===T.identifier?v.touch0[0]=z:v.touch1&&v.touch1[2]===T.identifier&&(v.touch1[0]=z);if(T=v.that.__zoom,v.touch1){var F=v.touch0[0],B=v.touch0[1],U=v.touch1[0],q=v.touch1[1],G=(G=U[0]-F[0])*G+(G=U[1]-F[1])*G,W=(W=q[0]-B[0])*W+(W=q[1]-B[1])*W;T=_(T,Math.sqrt(G/W)),z=[(F[0]+U[0])/2,(F[1]+U[1])/2],D=[(B[0]+q[0])/2,(B[1]+q[1])/2]}else if(v.touch0)z=v.touch0[0],D=v.touch0[1];else return;v.zoom("touch",n(A(T,z,D),v.extent,s))}}function P(f,...N){if(this.__zooming){var v=$(this,N).event(f),k=f.changedTouches,I=k.length,b,T;for(vn(f),h&&clearTimeout(h),h=setTimeout(function(){h=null},g),b=0;b<I;++b)T=k[b],v.touch0&&v.touch0[2]===T.identifier?delete v.touch0:v.touch1&&v.touch1[2]===T.identifier&&delete v.touch1;if(v.touch1&&!v.touch0&&(v.touch0=v.touch1,delete v.touch1),v.touch0)v.touch0[1]=this.__zoom.invert(v.touch0[0]);else if(v.end(),v.taps===2&&(T=Ee(T,this),Math.hypot(d[0]-T[0],d[1]-T[1])<w)){var z=me(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return p.wheelDelta=function(f){return arguments.length?(r=typeof f=="function"?f:Lt(+f),p):r},p.filter=function(f){return arguments.length?(e=typeof f=="function"?f:Lt(!!f),p):e},p.touchable=function(f){return arguments.length?(o=typeof f=="function"?f:Lt(!!f),p):o},p.extent=function(f){return arguments.length?(t=typeof f=="function"?f:Lt([[+f[0][0],+f[0][1]],[+f[1][0],+f[1][1]]]),p):t},p.scaleExtent=function(f){return arguments.length?(i[0]=+f[0],i[1]=+f[1],p):[i[0],i[1]]},p.translateExtent=function(f){return arguments.length?(s[0][0]=+f[0][0],s[1][0]=+f[1][0],s[0][1]=+f[0][1],s[1][1]=+f[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(f){return arguments.length?(n=f,p):n},p.duration=function(f){return arguments.length?(a=+f,p):a},p.interpolate=function(f){return arguments.length?(c=f,p):c},p.on=function(){var f=u.on.apply(u,arguments);return f===u?p:f},p.clickDistance=function(f){return arguments.length?(m=(f=+f)*f,p):Math.sqrt(m)},p.tapDistance=function(f){return arguments.length?(w=+f,p):w},p}const dn=E.createContext(null),Gl=dn.Provider,$e={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zo=$e.error001();function J(e,t){const n=E.useContext(dn);if(n===null)throw new Error(zo);return oo(n,e,t)}const re=()=>{const e=E.useContext(dn);if(e===null)throw new Error(zo);return E.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Wl=e=>e.userSelectionActive?"none":"all";function Io({position:e,children:t,className:n,style:r,...o}){const i=J(Wl),s=`${e}`.split("-");return S.createElement("div",{className:ie(["react-flow__panel",n,...s]),style:{...r,pointerEvents:i},...o},t)}function Kl({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:S.createElement(Io,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},S.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Ql=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:o=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...l})=>{const d=E.useRef(null),[h,g]=E.useState({x:0,y:0,width:0,height:0}),x=ie(["react-flow__edge-textwrapper",u]);return E.useEffect(()=>{if(d.current){const m=d.current.getBBox();g({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:S.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:x,visibility:h.width?"visible":"hidden",...l},o&&S.createElement("rect",{width:h.width+2*s[0],x:-s[0],y:-s[1],height:h.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),S.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:d,style:r},n),c)};var Jl=E.memo(Ql);const Gn=e=>({width:e.offsetWidth,height:e.offsetHeight}),ht=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Wn=(e={x:0,y:0},t)=>({x:ht(e.x,t[0][0],t[1][0]),y:ht(e.y,t[0][1],t[1][1])}),$r=(e,t,n)=>e<t?ht(Math.abs(e-t),1,50)/50:e>n?-ht(Math.abs(e-n),1,50)/50:0,Do=(e,t)=>{const n=$r(e.x,35,t.width-35)*20,r=$r(e.y,35,t.height-35)*20;return[n,r]},Ho=e=>e.getRootNode?.()||window?.document,eu=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Kn=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),tu=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Tr=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),In=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},nu=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),te=Symbol.for("internals"),Po=["Enter"," ","Escape"],ru=(e,t)=>{},ou=e=>"nativeEvent"in e;function Dn(e){const n=(ou(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const Oo=e=>"clientX"in e,He=(e,t)=>{const n=Oo(e),r=n?e.clientX:e.touches?.[0].clientX,o=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:o-(t?.top??0)}},tn=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,Dt=({id:e,path:t,labelX:n,labelY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:h,interactionWidth:g=20})=>S.createElement(S.Fragment,null,S.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:h}),g&&S.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),o&&he(n)&&he(r)?S.createElement(Jl,{x:n,y:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);Dt.displayName="BaseEdge";function vt(e,t,n){return n===void 0?n:r=>{const o=t().edges.find(i=>i.id===e);o&&n(r,{...o})}}function Vo({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function Lo({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+o*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+r*.125,l=Math.abs(c-e),d=Math.abs(u-t);return[c,u,l,d]}var Ge;(function(e){e.Strict="strict",e.Loose="loose"})(Ge||(Ge={}));var Ue;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ue||(Ue={}));var Tt;(function(e){e.Partial="partial",e.Full="full"})(Tt||(Tt={}));var Ie;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ie||(Ie={}));var nn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(nn||(nn={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));function Rr({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===X.Left||e===X.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function jo({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:i=X.Top}){const[s,a]=Rr({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,u]=Rr({pos:i,x1:r,y1:o,x2:e,y2:t}),[l,d,h,g]=Lo({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${s},${a} ${c},${u} ${r},${o}`,l,d,h,g]}const Qn=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=X.Bottom,targetPosition:i=X.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:h,markerEnd:g,markerStart:x,interactionWidth:m})=>{const[w,p,_]=jo({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i});return S.createElement(Dt,{path:w,labelX:p,labelY:_,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:h,markerEnd:g,markerStart:x,interactionWidth:m})});Qn.displayName="SimpleBezierEdge";const zr={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},su=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ir=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function iu({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:r=X.Top,center:o,offset:i}){const s=zr[t],a=zr[r],c={x:e.x+s.x*i,y:e.y+s.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},l=su({source:c,sourcePosition:t,target:u}),d=l.x!==0?"x":"y",h=l[d];let g=[],x,m;const w={x:0,y:0},p={x:0,y:0},[_,A,y,M]=Vo({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){x=o.x??_,m=o.y??A;const O=[{x,y:c.y},{x,y:u.y}],H=[{x:c.x,y:m},{x:u.x,y:m}];s[d]===h?g=d==="x"?O:H:g=d==="x"?H:O}else{const O=[{x:c.x,y:u.y}],H=[{x:u.x,y:c.y}];if(d==="x"?g=s.x===h?H:O:g=s.y===h?O:H,t===r){const P=Math.abs(e[d]-n[d]);if(P<=i){const f=Math.min(i-1,i-P);s[d]===h?w[d]=(c[d]>e[d]?-1:1)*f:p[d]=(u[d]>n[d]?-1:1)*f}}if(t!==r){const P=d==="x"?"y":"x",f=s[d]===a[P],N=c[P]>u[P],v=c[P]<u[P];(s[d]===1&&(!f&&N||f&&v)||s[d]!==1&&(!f&&v||f&&N))&&(g=d==="x"?O:H)}const R={x:c.x+w.x,y:c.y+w.y},V={x:u.x+p.x,y:u.y+p.y},L=Math.max(Math.abs(R.x-g[0].x),Math.abs(V.x-g[0].x)),j=Math.max(Math.abs(R.y-g[0].y),Math.abs(V.y-g[0].y));L>=j?(x=(R.x+V.x)/2,m=g[0].y):(x=g[0].x,m=(R.y+V.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...g,{x:u.x+p.x,y:u.y+p.y},n],x,m,y,M]}function au(e,t,n,r){const o=Math.min(Ir(e,t)/2,Ir(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${i+o*u},${s}Q ${i},${s} ${i},${s+o*l}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+o*c}Q ${i},${s} ${i+o*a},${s}`}function Hn({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:i=X.Top,borderRadius:s=5,centerX:a,centerY:c,offset:u=20}){const[l,d,h,g,x]=iu({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:c},offset:u});return[l.reduce((w,p,_)=>{let A="";return _>0&&_<l.length-1?A=au(l[_-1],p,l[_+1],s):A=`${_===0?"M":"L"}${p.x} ${p.y}`,w+=A,w},""),d,h,g,x]}const fn=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:d=X.Bottom,targetPosition:h=X.Top,markerEnd:g,markerStart:x,pathOptions:m,interactionWidth:w})=>{const[p,_,A]=Hn({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:h,borderRadius:m?.borderRadius,offset:m?.offset});return S.createElement(Dt,{path:p,labelX:_,labelY:A,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:g,markerStart:x,interactionWidth:w})});fn.displayName="SmoothStepEdge";const Jn=E.memo(e=>S.createElement(fn,{...e,pathOptions:E.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));Jn.displayName="StepEdge";function cu({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=Vo({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const er=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:h,interactionWidth:g})=>{const[x,m,w]=cu({sourceX:e,sourceY:t,targetX:n,targetY:r});return S.createElement(Dt,{path:x,labelX:m,labelY:w,label:o,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:d,markerStart:h,interactionWidth:g})});er.displayName="StraightEdge";function jt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Dr({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case X.Left:return[t-jt(t-r,i),n];case X.Right:return[t+jt(r-t,i),n];case X.Top:return[t,n-jt(n-o,i)];case X.Bottom:return[t,n+jt(o-n,i)]}}function Bo({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:r,targetY:o,targetPosition:i=X.Top,curvature:s=.25}){const[a,c]=Dr({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[u,l]=Dr({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[d,h,g,x]=Lo({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${a},${c} ${u},${l} ${r},${o}`,d,h,g,x]}const rn=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:o=X.Bottom,targetPosition:i=X.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:h,markerEnd:g,markerStart:x,pathOptions:m,interactionWidth:w})=>{const[p,_,A]=Bo({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:r,targetPosition:i,curvature:m?.curvature});return S.createElement(Dt,{path:p,labelX:_,labelY:A,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:d,style:h,markerEnd:g,markerStart:x,interactionWidth:w})});rn.displayName="BezierEdge";const tr=E.createContext(null),lu=tr.Provider;tr.Consumer;const uu=()=>E.useContext(tr),du=e=>"id"in e&&"source"in e&&"target"in e,fu=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Pn=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,hu=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),pu=(e,t)=>{if(!e.source||!e.target)return t;let n;return du(e)?n={...e}:n={...e,id:fu(e)},hu(n,t)?t:t.concat(n)},On=({x:e,y:t},[n,r,o],i,[s,a])=>{const c={x:(e-n)/o,y:(t-r)/o};return i?{x:s*Math.round(c.x/s),y:a*Math.round(c.y/a)}:c},Fo=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r}),lt=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],o={x:e.position.x-n,y:e.position.y-r};return{...o,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:o}},nr=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const{x:i,y:s}=lt(o,t).positionAbsolute;return eu(r,Kn({x:i,y:s,width:o.width||0,height:o.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return tu(n)},Xo=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const c={x:(t.x-n)/o,y:(t.y-r)/o,width:t.width/o,height:t.height/o},u=[];return e.forEach(l=>{const{width:d,height:h,selectable:g=!0,hidden:x=!1}=l;if(s&&!g||x)return!1;const{positionAbsolute:m}=lt(l,a),w={x:m.x,y:m.y,width:d||0,height:h||0},p=In(c,w),_=typeof d>"u"||typeof h>"u"||d===null||h===null,A=i&&p>0,y=(d||0)*(h||0);(_||A||p>=y||l.dragging)&&u.push(l)}),u},Yo=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Uo=(e,t,n,r,o,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(s,a),u=ht(c,r,o),l=e.x+e.width/2,d=e.y+e.height/2,h=t/2-l*u,g=n/2-d*u;return{x:h,y:g,zoom:u}},Xe=(e,t=0)=>e.transition().duration(t);function Hr(e,t,n,r){return(t[n]||[]).reduce((o,i)=>(`${e.id}-${i.id}-${n}`!==r&&o.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),o),[])}function gu(e,t,n,r,o,i){const{x:s,y:a}=He(e),u=t.elementsFromPoint(s,a).find(x=>x.classList.contains("react-flow__handle"));if(u){const x=u.getAttribute("data-nodeid");if(x){const m=rr(void 0,u),w=u.getAttribute("data-handleid"),p=i({nodeId:x,id:w,type:m});if(p){const _=o.find(A=>A.nodeId===x&&A.type===m&&A.id===w);return{handle:{id:w,type:m,nodeId:x,x:_?.x||n.x,y:_?.y||n.y},validHandleResult:p}}}}let l=[],d=1/0;if(o.forEach(x=>{const m=Math.sqrt((x.x-n.x)**2+(x.y-n.y)**2);if(m<=r){const w=i(x);m<=d&&(m<d?l=[{handle:x,validHandleResult:w}]:m===d&&l.push({handle:x,validHandleResult:w}),d=m)}}),!l.length)return{handle:null,validHandleResult:Zo()};if(l.length===1)return l[0];const h=l.some(({validHandleResult:x})=>x.isValid),g=l.some(({handle:x})=>x.type==="target");return l.find(({handle:x,validHandleResult:m})=>g?x.type==="target":h?m.isValid:!0)||l[0]}const mu={source:null,target:null,sourceHandle:null,targetHandle:null},Zo=()=>({handleDomNode:null,isValid:!1,connection:mu,endHandle:null});function qo(e,t,n,r,o,i,s){const a=o==="target",c=s.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...Zo(),handleDomNode:c};if(c){const l=rr(void 0,c),d=c.getAttribute("data-nodeid"),h=c.getAttribute("data-handleid"),g=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),m={source:a?d:n,sourceHandle:a?h:r,target:a?n:d,targetHandle:a?r:h};u.connection=m,g&&x&&(t===Ge.Strict?a&&l==="source"||!a&&l==="target":d!==n||h!==r)&&(u.endHandle={nodeId:d,handleId:h,type:l},u.isValid=i(m))}return u}function yu({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((o,i)=>{if(i[te]){const{handleBounds:s}=i[te];let a=[],c=[];s&&(a=Hr(i,s,"source",`${t}-${n}-${r}`),c=Hr(i,s,"target",`${t}-${n}-${r}`)),o.push(...a,...c)}return o},[])}function rr(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function bn(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function xu(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Go({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:o,getState:i,setState:s,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const l=Ho(e.target),{connectionMode:d,domNode:h,autoPanOnConnect:g,connectionRadius:x,onConnectStart:m,panBy:w,getNodes:p,cancelConnection:_}=i();let A=0,y;const{x:M,y:$}=He(e),O=l?.elementFromPoint(M,$),H=rr(c,O),R=h?.getBoundingClientRect();if(!R||!H)return;let V,L=He(e,R),j=!1,P=null,f=!1,N=null;const v=yu({nodes:p(),nodeId:n,handleId:t,handleType:H}),k=()=>{if(!g)return;const[T,z]=Do(L,R);w({x:T,y:z}),A=requestAnimationFrame(k)};s({connectionPosition:L,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:H,connectionStartHandle:{nodeId:n,handleId:t,type:H},connectionEndHandle:null}),m?.(e,{nodeId:n,handleId:t,handleType:H});function I(T){const{transform:z}=i();L=He(T,R);const{handle:D,validHandleResult:F}=gu(T,l,On(L,z,!1,[1,1]),x,v,B=>qo(B,d,n,t,o?"target":"source",a,l));if(y=D,j||(k(),j=!0),N=F.handleDomNode,P=F.connection,f=F.isValid,s({connectionPosition:y&&f?Fo({x:y.x,y:y.y},z):L,connectionStatus:xu(!!y,f),connectionEndHandle:F.endHandle}),!y&&!f&&!N)return bn(V);P.source!==P.target&&N&&(bn(V),V=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",f),N.classList.toggle("react-flow__handle-valid",f))}function b(T){(y||N)&&P&&f&&r?.(P),i().onConnectEnd?.(T),c&&u?.(T),bn(V),_(),cancelAnimationFrame(A),j=!1,f=!1,P=null,N=null,l.removeEventListener("mousemove",I),l.removeEventListener("mouseup",b),l.removeEventListener("touchmove",I),l.removeEventListener("touchend",b)}l.addEventListener("mousemove",I),l.addEventListener("mouseup",b),l.addEventListener("touchmove",I),l.addEventListener("touchend",b)}const Pr=()=>!0,wu=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),vu=(e,t,n)=>r=>{const{connectionStartHandle:o,connectionEndHandle:i,connectionClickStartHandle:s}=r;return{connecting:o?.nodeId===e&&o?.handleId===t&&o?.type===n||i?.nodeId===e&&i?.handleId===t&&i?.type===n,clickConnecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n}},Wo=E.forwardRef(({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:d,...h},g)=>{const x=s||null,m=e==="target",w=re(),p=uu(),{connectOnClick:_,noPanClassName:A}=J(wu,se),{connecting:y,clickConnecting:M}=J(vu(p,x,e),se);p||w.getState().onError?.("010",$e.error010());const $=R=>{const{defaultEdgeOptions:V,onConnect:L,hasDefaultEdges:j}=w.getState(),P={...V,...R};if(j){const{edges:f,setEdges:N}=w.getState();N(pu(P,f))}L?.(P),a?.(P)},O=R=>{if(!p)return;const V=Oo(R);o&&(V&&R.button===0||!V)&&Go({event:R,handleId:x,nodeId:p,onConnect:$,isTarget:m,getState:w.getState,setState:w.setState,isValidConnection:n||w.getState().isValidConnection||Pr}),V?l?.(R):d?.(R)},H=R=>{const{onClickConnectStart:V,onClickConnectEnd:L,connectionClickStartHandle:j,connectionMode:P,isValidConnection:f}=w.getState();if(!p||!j&&!o)return;if(!j){V?.(R,{nodeId:p,handleId:x,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:p,type:e,handleId:x}});return}const N=Ho(R.target),v=n||f||Pr,{connection:k,isValid:I}=qo({nodeId:p,id:x,type:e},P,j.nodeId,j.handleId||null,j.type,v,N);I&&$(k),L?.(R),w.setState({connectionClickStartHandle:null})};return S.createElement("div",{"data-handleid":x,"data-nodeid":p,"data-handlepos":t,"data-id":`${p}-${x}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",A,u,{source:!m,target:m,connectable:r,connectablestart:o,connectableend:i,connecting:M,connectionindicator:r&&(o&&!y||i&&y)}]),onMouseDown:O,onTouchStart:O,onClick:_?H:void 0,ref:g,...h},c)});Wo.displayName="Handle";var on=E.memo(Wo);const Ko=({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:r=X.Bottom})=>S.createElement(S.Fragment,null,S.createElement(on,{type:"target",position:n,isConnectable:t}),e?.label,S.createElement(on,{type:"source",position:r,isConnectable:t}));Ko.displayName="DefaultNode";var Vn=E.memo(Ko);const Qo=({data:e,isConnectable:t,sourcePosition:n=X.Bottom})=>S.createElement(S.Fragment,null,e?.label,S.createElement(on,{type:"source",position:n,isConnectable:t}));Qo.displayName="InputNode";var Jo=E.memo(Qo);const es=({data:e,isConnectable:t,targetPosition:n=X.Top})=>S.createElement(S.Fragment,null,S.createElement(on,{type:"target",position:n,isConnectable:t}),e?.label);es.displayName="OutputNode";var ts=E.memo(es);const or=()=>null;or.displayName="GroupNode";const bu=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Bt=e=>e.id;function _u(e,t){return se(e.selectedNodes.map(Bt),t.selectedNodes.map(Bt))&&se(e.selectedEdges.map(Bt),t.selectedEdges.map(Bt))}const ns=E.memo(({onSelectionChange:e})=>{const t=re(),{selectedNodes:n,selectedEdges:r}=J(bu,_u);return E.useEffect(()=>{const o={nodes:n,edges:r};e?.(o),t.getState().onSelectionChange.forEach(i=>i(o))},[n,r,e]),null});ns.displayName="SelectionListener";const Eu=e=>!!e.onSelectionChange;function Nu({onSelectionChange:e}){const t=J(Eu);return e||t?S.createElement(ns,{onSelectionChange:e}):null}const Su=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function nt(e,t){E.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Z(e,t,n){E.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Cu=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:o,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:d,edgesFocusable:h,edgesUpdatable:g,elevateNodesOnSelect:x,minZoom:m,maxZoom:w,nodeExtent:p,onNodesChange:_,onEdgesChange:A,elementsSelectable:y,connectionMode:M,snapGrid:$,snapToGrid:O,translateExtent:H,connectOnClick:R,defaultEdgeOptions:V,fitView:L,fitViewOptions:j,onNodesDelete:P,onEdgesDelete:f,onNodeDrag:N,onNodeDragStart:v,onNodeDragStop:k,onSelectionDrag:I,onSelectionDragStart:b,onSelectionDragStop:T,noPanClassName:z,nodeOrigin:D,rfId:F,autoPanOnConnect:B,autoPanOnNodeDrag:U,onError:q,connectionRadius:G,isValidConnection:W,nodeDragThreshold:ee})=>{const{setNodes:K,setEdges:pe,setDefaultNodesAndEdges:ue,setMinZoom:ge,setMaxZoom:de,setTranslateExtent:ne,setNodeExtent:ve,reset:Q}=J(Su,se),Y=re();return E.useEffect(()=>{const ce=r?.map(Pe=>({...Pe,...V}));return ue(n,ce),()=>{Q()}},[]),Z("defaultEdgeOptions",V,Y.setState),Z("connectionMode",M,Y.setState),Z("onConnect",o,Y.setState),Z("onConnectStart",i,Y.setState),Z("onConnectEnd",s,Y.setState),Z("onClickConnectStart",a,Y.setState),Z("onClickConnectEnd",c,Y.setState),Z("nodesDraggable",u,Y.setState),Z("nodesConnectable",l,Y.setState),Z("nodesFocusable",d,Y.setState),Z("edgesFocusable",h,Y.setState),Z("edgesUpdatable",g,Y.setState),Z("elementsSelectable",y,Y.setState),Z("elevateNodesOnSelect",x,Y.setState),Z("snapToGrid",O,Y.setState),Z("snapGrid",$,Y.setState),Z("onNodesChange",_,Y.setState),Z("onEdgesChange",A,Y.setState),Z("connectOnClick",R,Y.setState),Z("fitViewOnInit",L,Y.setState),Z("fitViewOnInitOptions",j,Y.setState),Z("onNodesDelete",P,Y.setState),Z("onEdgesDelete",f,Y.setState),Z("onNodeDrag",N,Y.setState),Z("onNodeDragStart",v,Y.setState),Z("onNodeDragStop",k,Y.setState),Z("onSelectionDrag",I,Y.setState),Z("onSelectionDragStart",b,Y.setState),Z("onSelectionDragStop",T,Y.setState),Z("noPanClassName",z,Y.setState),Z("nodeOrigin",D,Y.setState),Z("rfId",F,Y.setState),Z("autoPanOnConnect",B,Y.setState),Z("autoPanOnNodeDrag",U,Y.setState),Z("onError",q,Y.setState),Z("connectionRadius",G,Y.setState),Z("isValidConnection",W,Y.setState),Z("nodeDragThreshold",ee,Y.setState),nt(e,K),nt(t,pe),nt(m,ge),nt(w,de),nt(H,ne),nt(p,ve),null},Or={display:"none"},Au={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},rs="react-flow__node-desc",os="react-flow__edge-desc",ku="react-flow__aria-live",Mu=e=>e.ariaLiveMessage;function $u({rfId:e}){const t=J(Mu);return S.createElement("div",{id:`${ku}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Au},t)}function Tu({rfId:e,disableKeyboardA11y:t}){return S.createElement(S.Fragment,null,S.createElement("div",{id:`${rs}-${e}`,style:Or},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),S.createElement("div",{id:`${os}-${e}`,style:Or},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&S.createElement($u,{rfId:e}))}var Rt=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=E.useState(!1),o=E.useRef(!1),i=E.useRef(new Set([])),[s,a]=E.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),l=u.reduce((d,h)=>d.concat(...h),[]);return[u,l]}return[[],[]]},[e]);return E.useEffect(()=>{const c=typeof document<"u"?document:null,u=t?.target||c;if(e!==null){const l=g=>{if(o.current=g.ctrlKey||g.metaKey||g.shiftKey,(!o.current||o.current&&!t.actInsideInputWithModifier)&&Dn(g))return!1;const m=Lr(g.code,a);i.current.add(g[m]),Vr(s,i.current,!1)&&(g.preventDefault(),r(!0))},d=g=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Dn(g))return!1;const m=Lr(g.code,a);Vr(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(g[m]),g.key==="Meta"&&i.current.clear(),o.current=!1},h=()=>{i.current.clear(),r(!1)};return u?.addEventListener("keydown",l),u?.addEventListener("keyup",d),window.addEventListener("blur",h),()=>{u?.removeEventListener("keydown",l),u?.removeEventListener("keyup",d),window.removeEventListener("blur",h)}}},[e,r]),n};function Vr(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function Lr(e,t){return t.includes(e)?"code":"key"}function ss(e,t,n,r){const o=e.parentNode||e.parentId;if(!o)return n;const i=t.get(o),s=lt(i,r);return ss(i,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(i[te]?.z??0)>(n.z??0)?i[te]?.z??0:n.z??0},r)}function is(e,t,n){e.forEach(r=>{const o=r.parentNode||r.parentId;if(o&&!e.has(o))throw new Error(`Parent node ${o} not found`);if(o||n?.[r.id]){const{x:i,y:s,z:a}=ss(r,e,{...r.position,z:r[te]?.z??0},t);r.positionAbsolute={x:i,y:s},r[te].z=a,n?.[r.id]&&(r[te].isParent=!0)}})}function _n(e,t,n,r){const o=new Map,i={},s=r?1e3:0;return e.forEach(a=>{const c=(he(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),l={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(i[d]=!0);const h=u?.type&&u?.type!==a.type;Object.defineProperty(l,te,{enumerable:!1,value:{handleBounds:h?void 0:u?.[te]?.handleBounds,z:c}}),o.set(a.id,l)}),is(o,n,i),o}function as(e,t={}){const{getNodes:n,width:r,height:o,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:d}=e(),h=t.initial&&!u&&l;if(a&&c&&(h||!t.initial)){const x=n().filter(w=>{const p=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return t.nodes?.length?p&&t.nodes.some(_=>_.id===w.id):p}),m=x.every(w=>w.width&&w.height);if(x.length>0&&m){const w=nr(x,d),{x:p,y:_,zoom:A}=Uo(w,r,o,t.minZoom??i,t.maxZoom??s,t.padding??.1),y=De.translate(p,_).scale(A);return typeof t.duration=="number"&&t.duration>0?a.transform(Xe(c,t.duration),y):a.transform(c,y),!0}}return!1}function Ru(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[te]:r[te],selected:n.selected})}),new Map(t)}function zu(e,t){return t.map(n=>{const r=e.find(o=>o.id===n.id);return r&&(n.selected=r.selected),n})}function Ft({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:o,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e?.length&&(c&&r({nodeInternals:Ru(e,o)}),s?.(e)),t?.length&&(u&&r({edges:zu(t,i)}),a?.(t))}const rt=()=>{},Iu={zoomIn:rt,zoomOut:rt,zoomTo:rt,getZoom:()=>1,setViewport:rt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:rt,fitBounds:rt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Du=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Hu=()=>{const e=re(),{d3Zoom:t,d3Selection:n}=J(Du,se);return E.useMemo(()=>n&&t?{zoomIn:o=>t.scaleBy(Xe(n,o?.duration),1.2),zoomOut:o=>t.scaleBy(Xe(n,o?.duration),1/1.2),zoomTo:(o,i)=>t.scaleTo(Xe(n,i?.duration),o),getZoom:()=>e.getState().transform[2],setViewport:(o,i)=>{const[s,a,c]=e.getState().transform,u=De.translate(o.x??s,o.y??a).scale(o.zoom??c);t.transform(Xe(n,i?.duration),u)},getViewport:()=>{const[o,i,s]=e.getState().transform;return{x:o,y:i,zoom:s}},fitView:o=>as(e.getState,o),setCenter:(o,i,s)=>{const{width:a,height:c,maxZoom:u}=e.getState(),l=typeof s?.zoom<"u"?s.zoom:u,d=a/2-o*l,h=c/2-i*l,g=De.translate(d,h).scale(l);t.transform(Xe(n,s?.duration),g)},fitBounds:(o,i)=>{const{width:s,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:l,y:d,zoom:h}=Uo(o,s,a,c,u,i?.padding??.1),g=De.translate(l,d).scale(h);t.transform(Xe(n,i?.duration),g)},project:o=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),On(o,i,s,a)},screenToFlowPosition:o=>{const{transform:i,snapToGrid:s,snapGrid:a,domNode:c}=e.getState();if(!c)return o;const{x:u,y:l}=c.getBoundingClientRect(),d={x:o.x-u,y:o.y-l};return On(d,i,s,a)},flowToScreenPosition:o=>{const{transform:i,domNode:s}=e.getState();if(!s)return o;const{x:a,y:c}=s.getBoundingClientRect(),u=Fo(o,i);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:Iu,[t,n])};function sr(){const e=Hu(),t=re(),n=E.useCallback(()=>t.getState().getNodes().map(m=>({...m})),[]),r=E.useCallback(m=>t.getState().nodeInternals.get(m),[]),o=E.useCallback(()=>{const{edges:m=[]}=t.getState();return m.map(w=>({...w}))},[]),i=E.useCallback(m=>{const{edges:w=[]}=t.getState();return w.find(p=>p.id===m)},[]),s=E.useCallback(m=>{const{getNodes:w,setNodes:p,hasDefaultNodes:_,onNodesChange:A}=t.getState(),y=w(),M=typeof m=="function"?m(y):m;if(_)p(M);else if(A){const $=M.length===0?y.map(O=>({type:"remove",id:O.id})):M.map(O=>({item:O,type:"reset"}));A($)}},[]),a=E.useCallback(m=>{const{edges:w=[],setEdges:p,hasDefaultEdges:_,onEdgesChange:A}=t.getState(),y=typeof m=="function"?m(w):m;if(_)p(y);else if(A){const M=y.length===0?w.map($=>({type:"remove",id:$.id})):y.map($=>({item:$,type:"reset"}));A(M)}},[]),c=E.useCallback(m=>{const w=Array.isArray(m)?m:[m],{getNodes:p,setNodes:_,hasDefaultNodes:A,onNodesChange:y}=t.getState();if(A){const $=[...p(),...w];_($)}else if(y){const M=w.map($=>({item:$,type:"add"}));y(M)}},[]),u=E.useCallback(m=>{const w=Array.isArray(m)?m:[m],{edges:p=[],setEdges:_,hasDefaultEdges:A,onEdgesChange:y}=t.getState();if(A)_([...p,...w]);else if(y){const M=w.map($=>({item:$,type:"add"}));y(M)}},[]),l=E.useCallback(()=>{const{getNodes:m,edges:w=[],transform:p}=t.getState(),[_,A,y]=p;return{nodes:m().map(M=>({...M})),edges:w.map(M=>({...M})),viewport:{x:_,y:A,zoom:y}}},[]),d=E.useCallback(({nodes:m,edges:w})=>{const{nodeInternals:p,getNodes:_,edges:A,hasDefaultNodes:y,hasDefaultEdges:M,onNodesDelete:$,onEdgesDelete:O,onNodesChange:H,onEdgesChange:R}=t.getState(),V=(m||[]).map(N=>N.id),L=(w||[]).map(N=>N.id),j=_().reduce((N,v)=>{const k=v.parentNode||v.parentId,I=!V.includes(v.id)&&k&&N.find(T=>T.id===k);return(typeof v.deletable=="boolean"?v.deletable:!0)&&(V.includes(v.id)||I)&&N.push(v),N},[]),P=A.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),f=P.filter(N=>L.includes(N.id));if(j||f){const N=Yo(j,P),v=[...f,...N],k=v.reduce((I,b)=>(I.includes(b.id)||I.push(b.id),I),[]);if((M||y)&&(M&&t.setState({edges:A.filter(I=>!k.includes(I.id))}),y&&(j.forEach(I=>{p.delete(I.id)}),t.setState({nodeInternals:new Map(p)}))),k.length>0&&(O?.(v),R&&R(k.map(I=>({id:I,type:"remove"})))),j.length>0&&($?.(j),H)){const I=j.map(b=>({id:b.id,type:"remove"}));H(I)}}},[]),h=E.useCallback(m=>{const w=nu(m),p=w?null:t.getState().nodeInternals.get(m.id);return!w&&!p?[null,null,w]:[w?m:Tr(p),p,w]},[]),g=E.useCallback((m,w=!0,p)=>{const[_,A,y]=h(m);return _?(p||t.getState().getNodes()).filter(M=>{if(!y&&(M.id===A.id||!M.positionAbsolute))return!1;const $=Tr(M),O=In($,_);return w&&O>0||O>=_.width*_.height}):[]},[]),x=E.useCallback((m,w,p=!0)=>{const[_]=h(m);if(!_)return!1;const A=In(_,w);return p&&A>0||A>=_.width*_.height},[]);return E.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:o,getEdge:i,setNodes:s,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:d,getIntersectingNodes:g,isNodeIntersecting:x}),[e,n,r,o,i,s,a,c,u,l,d,g,x])}const Pu={actInsideInputWithModifier:!1};var Ou=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=re(),{deleteElements:r}=sr(),o=Rt(e,Pu),i=Rt(t);E.useEffect(()=>{if(o){const{edges:s,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=s.filter(l=>l.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[o]),E.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Vu(e){const t=re();E.useEffect(()=>{let n;const r=()=>{if(!e.current)return;const o=Gn(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",$e.error004()),t.setState({width:o.width||500,height:o.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const ir={position:"absolute",width:"100%",height:"100%",top:0,left:0},Lu=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Xt=e=>({x:e.x,y:e.y,zoom:e.k}),ot=(e,t)=>e.target.closest(`.${t}`),jr=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Br=e=>{const t=e.ctrlKey&&tn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},ju=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Bu=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:o=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Ue.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:d=!0,defaultViewport:h,translateExtent:g,minZoom:x,maxZoom:m,zoomActivationKeyCode:w,preventScrolling:p=!0,children:_,noWheelClassName:A,noPanClassName:y})=>{const M=E.useRef(),$=re(),O=E.useRef(!1),H=E.useRef(!1),R=E.useRef(null),V=E.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:j,d3ZoomHandler:P,userSelectionActive:f}=J(ju,se),N=Rt(w),v=E.useRef(0),k=E.useRef(!1),I=E.useRef();return Vu(R),E.useEffect(()=>{if(R.current){const b=R.current.getBoundingClientRect(),T=ql().scaleExtent([x,m]).translateExtent(g),z=me(R.current).call(T),D=De.translate(h.x,h.y).scale(ht(h.zoom,x,m)),F=[[0,0],[b.width,b.height]],B=T.constrain()(D,F,g);T.transform(z,B),T.wheelDelta(Br),$.setState({d3Zoom:T,d3Selection:z,d3ZoomHandler:z.on("wheel.zoom"),transform:[B.x,B.y,B.k],domNode:R.current.closest(".react-flow")})}},[]),E.useEffect(()=>{j&&L&&(s&&!N&&!f?j.on("wheel.zoom",b=>{if(ot(b,A))return!1;b.preventDefault(),b.stopImmediatePropagation();const T=j.property("__zoom").k||1;if(b.ctrlKey&&i){const W=Ee(b),ee=Br(b),K=T*Math.pow(2,ee);L.scaleTo(j,K,W,b);return}const z=b.deltaMode===1?20:1;let D=c===Ue.Vertical?0:b.deltaX*z,F=c===Ue.Horizontal?0:b.deltaY*z;!tn()&&b.shiftKey&&c!==Ue.Vertical&&(D=b.deltaY*z,F=0),L.translateBy(j,-(D/T)*a,-(F/T)*a,{internal:!0});const B=Xt(j.property("__zoom")),{onViewportChangeStart:U,onViewportChange:q,onViewportChangeEnd:G}=$.getState();clearTimeout(I.current),k.current||(k.current=!0,t?.(b,B),U?.(B)),k.current&&(e?.(b,B),q?.(B),I.current=setTimeout(()=>{n?.(b,B),G?.(B),k.current=!1},150))},{passive:!1}):typeof P<"u"&&j.on("wheel.zoom",function(b,T){if(!p&&b.type==="wheel"&&!b.ctrlKey||ot(b,A))return null;b.preventDefault(),P.call(this,b,T)},{passive:!1}))},[f,s,c,j,L,P,N,i,p,A,t,e,n]),E.useEffect(()=>{L&&L.on("start",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;v.current=b.sourceEvent?.button;const{onViewportChangeStart:T}=$.getState(),z=Xt(b.transform);O.current=!0,V.current=z,b.sourceEvent?.type==="mousedown"&&$.setState({paneDragging:!0}),T?.(z),t?.(b.sourceEvent,z)})},[L,t]),E.useEffect(()=>{L&&(f&&!O.current?L.on("zoom",null):f||L.on("zoom",b=>{const{onViewportChange:T}=$.getState();if($.setState({transform:[b.transform.x,b.transform.y,b.transform.k]}),H.current=!!(r&&jr(d,v.current??0)),(e||T)&&!b.sourceEvent?.internal){const z=Xt(b.transform);T?.(z),e?.(b.sourceEvent,z)}}))},[f,L,e,d,r]),E.useEffect(()=>{L&&L.on("end",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;const{onViewportChangeEnd:T}=$.getState();if(O.current=!1,$.setState({paneDragging:!1}),r&&jr(d,v.current??0)&&!H.current&&r(b.sourceEvent),H.current=!1,(n||T)&&Lu(V.current,b.transform)){const z=Xt(b.transform);V.current=z,clearTimeout(M.current),M.current=setTimeout(()=>{T?.(z),n?.(b.sourceEvent,z)},s?150:0)}})},[L,s,d,n,r]),E.useEffect(()=>{L&&L.filter(b=>{const T=N||o,z=i&&b.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&b.button===1&&b.type==="mousedown"&&(ot(b,"react-flow__node")||ot(b,"react-flow__edge")))return!0;if(!d&&!T&&!s&&!u&&!i||f||!u&&b.type==="dblclick"||ot(b,A)&&b.type==="wheel"||ot(b,y)&&(b.type!=="wheel"||s&&b.type==="wheel"&&!N)||!i&&b.ctrlKey&&b.type==="wheel"||!T&&!s&&!z&&b.type==="wheel"||!d&&(b.type==="mousedown"||b.type==="touchstart")||Array.isArray(d)&&!d.includes(b.button)&&b.type==="mousedown")return!1;const D=Array.isArray(d)&&d.includes(b.button)||!b.button||b.button<=1;return(!b.ctrlKey||b.type==="wheel")&&D})},[f,L,o,i,s,u,d,l,N]),S.createElement("div",{className:"react-flow__renderer",ref:R,style:ir},_)},Fu=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Xu(){const{userSelectionActive:e,userSelectionRect:t}=J(Fu,se);return e&&t?S.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Fr(e,t){const n=t.parentNode||t.parentId,r=e.find(o=>o.id===n);if(r){const o=t.position.x+t.width-r.width,i=t.position.y+t.height-r.height;if(o>0||i>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,o>0&&(r.style.width+=o),i>0&&(r.style.height+=i),t.position.x<0){const s=Math.abs(t.position.x);r.position.x=r.position.x-s,r.style.width+=s,t.position.x=0}if(t.position.y<0){const s=Math.abs(t.position.y);r.position.y=r.position.y-s,r.style.height+=s,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Yu(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,o)=>{const i=e.filter(a=>a.id===o.id);if(i.length===0)return r.push(o),r;const s={...o};for(const a of i)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&Fr(r,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&Fr(r,s);break}case"remove":return r}return r.push(s),r},n)}function cs(e,t){return Yu(e,t)}const ze=(e,t)=>({id:e,type:"select",selected:t});function it(e,t){return e.reduce((n,r)=>{const o=t.includes(r.id);return!r.selected&&o?(r.selected=!0,n.push(ze(r.id,!0))):r.selected&&!o&&(r.selected=!1,n.push(ze(r.id,!1))),n},[])}const En=(e,t)=>n=>{n.target===t.current&&e?.(n)},Uu=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),ls=E.memo(({isSelecting:e,selectionMode:t=Tt.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:o,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:d})=>{const h=E.useRef(null),g=re(),x=E.useRef(0),m=E.useRef(0),w=E.useRef(),{userSelectionActive:p,elementsSelectable:_,dragging:A}=J(Uu,se),y=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,m.current=0},M=P=>{i?.(P),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},$=P=>{if(Array.isArray(n)&&n?.includes(2)){P.preventDefault();return}s?.(P)},O=a?P=>a(P):void 0,H=P=>{const{resetSelectedElements:f,domNode:N}=g.getState();if(w.current=N?.getBoundingClientRect(),!_||!e||P.button!==0||P.target!==h.current||!w.current)return;const{x:v,y:k}=He(P,w.current);f(),g.setState({userSelectionRect:{width:0,height:0,startX:v,startY:k,x:v,y:k}}),r?.(P)},R=P=>{const{userSelectionRect:f,nodeInternals:N,edges:v,transform:k,onNodesChange:I,onEdgesChange:b,nodeOrigin:T,getNodes:z}=g.getState();if(!e||!w.current||!f)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const D=He(P,w.current),F=f.startX??0,B=f.startY??0,U={...f,x:D.x<F?D.x:F,y:D.y<B?D.y:B,width:Math.abs(D.x-F),height:Math.abs(D.y-B)},q=z(),G=Xo(N,U,k,t===Tt.Partial,!0,T),W=Yo(G,v).map(K=>K.id),ee=G.map(K=>K.id);if(x.current!==ee.length){x.current=ee.length;const K=it(q,ee);K.length&&I?.(K)}if(m.current!==W.length){m.current=W.length;const K=it(v,W);K.length&&b?.(K)}g.setState({userSelectionRect:U})},V=P=>{if(P.button!==0)return;const{userSelectionRect:f}=g.getState();!p&&f&&P.target===h.current&&M?.(P),g.setState({nodesSelectionActive:x.current>0}),y(),o?.(P)},L=P=>{p&&(g.setState({nodesSelectionActive:x.current>0}),o?.(P)),y()},j=_&&(e||p);return S.createElement("div",{className:ie(["react-flow__pane",{dragging:A,selection:e}]),onClick:j?void 0:En(M,h),onContextMenu:En($,h),onWheel:En(O,h),onMouseEnter:j?void 0:c,onMouseDown:j?H:void 0,onMouseMove:j?R:u,onMouseUp:j?V:void 0,onMouseLeave:j?L:l,ref:h,style:ir},d,S.createElement(Xu,null))});ls.displayName="Pane";function us(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:us(r,t):!1}function Xr(e,t,n){let r=e;do{if(r?.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Zu(e,t,n,r){return Array.from(e.values()).filter(o=>(o.selected||o.id===r)&&(!o.parentNode||o.parentId||!us(o,e))&&(o.draggable||t&&typeof o.draggable>"u")).map(o=>({id:o.id,position:o.position||{x:0,y:0},positionAbsolute:o.positionAbsolute||{x:0,y:0},distance:{x:n.x-(o.positionAbsolute?.x??0),y:n.y-(o.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:o.extent,parentNode:o.parentNode||o.parentId,parentId:o.parentNode||o.parentId,width:o.width,height:o.height,expandParent:o.expandParent}))}function qu(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function ds(e,t,n,r,o=[0,0],i){const s=qu(e,e.extent||r);let a=s;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const d=n.get(c),{x:h,y:g}=lt(d,o).positionAbsolute;a=d&&he(h)&&he(g)&&he(d.width)&&he(d.height)?[[h+e.width*o[0],g+e.height*o[1]],[h+d.width-e.width+e.width*o[0],g+d.height-e.height+e.height*o[1]]]:a}else i?.("005",$e.error005()),a=s;else if(e.extent&&c&&e.extent!=="parent"){const d=n.get(c),{x:h,y:g}=lt(d,o).positionAbsolute;a=[[e.extent[0][0]+h,e.extent[0][1]+g],[e.extent[1][0]+h,e.extent[1][1]+g]]}let u={x:0,y:0};if(c){const d=n.get(c);u=lt(d,o).positionAbsolute}const l=a&&a!=="parent"?Wn(t,a):t;return{position:{x:l.x-u.x,y:l.y-u.y},positionAbsolute:l}}function Nn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(o=>({...n.get(o.id),position:o.position,positionAbsolute:o.positionAbsolute}));return[e?r.find(o=>o.id===e):r[0],r]}const Yr=(e,t,n,r)=>{const o=t.querySelectorAll(e);if(!o||!o.length)return null;const i=Array.from(o),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return i.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/n,y:(u.top-s.top-a.y)/n,...Gn(c)}})};function bt(e,t,n){return n===void 0?n:r=>{const o=t().nodeInternals.get(e);o&&n(r,{...o})}}function Ln({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c?.("012",$e.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>r?.current?.blur())):o([e])}function Gu(){const e=re();return E.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:o,snapToGrid:i}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(s-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:i?o[0]*Math.round(c.x/o[0]):c.x,ySnapped:i?o[1]*Math.round(c.y/o[1]):c.y,...c}},[])}function Sn(e){return(t,n,r)=>e?.(t,r)}function fs({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,selectNodesOnDrag:s}){const a=re(),[c,u]=E.useState(!1),l=E.useRef([]),d=E.useRef({x:null,y:null}),h=E.useRef(0),g=E.useRef(null),x=E.useRef({x:0,y:0}),m=E.useRef(null),w=E.useRef(!1),p=E.useRef(!1),_=E.useRef(!1),A=Gu();return E.useEffect(()=>{if(e?.current){const y=me(e.current),M=({x:H,y:R})=>{const{nodeInternals:V,onNodeDrag:L,onSelectionDrag:j,updateNodePositions:P,nodeExtent:f,snapGrid:N,snapToGrid:v,nodeOrigin:k,onError:I}=a.getState();d.current={x:H,y:R};let b=!1,T={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&f){const D=nr(l.current,k);T=Kn(D)}if(l.current=l.current.map(D=>{const F={x:H-D.distance.x,y:R-D.distance.y};v&&(F.x=N[0]*Math.round(F.x/N[0]),F.y=N[1]*Math.round(F.y/N[1]));const B=[[f[0][0],f[0][1]],[f[1][0],f[1][1]]];l.current.length>1&&f&&!D.extent&&(B[0][0]=D.positionAbsolute.x-T.x+f[0][0],B[1][0]=D.positionAbsolute.x+(D.width??0)-T.x2+f[1][0],B[0][1]=D.positionAbsolute.y-T.y+f[0][1],B[1][1]=D.positionAbsolute.y+(D.height??0)-T.y2+f[1][1]);const U=ds(D,F,V,B,k,I);return b=b||D.position.x!==U.position.x||D.position.y!==U.position.y,D.position=U.position,D.positionAbsolute=U.positionAbsolute,D}),!b)return;P(l.current,!0,!0),u(!0);const z=o?L:Sn(j);if(z&&m.current){const[D,F]=Nn({nodeId:o,dragItems:l.current,nodeInternals:V});z(m.current,D,F)}},$=()=>{if(!g.current)return;const[H,R]=Do(x.current,g.current);if(H!==0||R!==0){const{transform:V,panBy:L}=a.getState();d.current.x=(d.current.x??0)-H/V[2],d.current.y=(d.current.y??0)-R/V[2],L({x:H,y:R})&&M(d.current)}h.current=requestAnimationFrame($)},O=H=>{const{nodeInternals:R,multiSelectionActive:V,nodesDraggable:L,unselectNodesAndEdges:j,onNodeDragStart:P,onSelectionDragStart:f}=a.getState();p.current=!0;const N=o?P:Sn(f);(!s||!i)&&!V&&o&&(R.get(o)?.selected||j()),o&&i&&s&&Ln({id:o,store:a,nodeRef:e});const v=A(H);if(d.current=v,l.current=Zu(R,L,v,o),N&&l.current){const[k,I]=Nn({nodeId:o,dragItems:l.current,nodeInternals:R});N(H.sourceEvent,k,I)}};if(t)y.on(".drag",null);else{const H=oc().on("start",R=>{const{domNode:V,nodeDragThreshold:L}=a.getState();L===0&&O(R),_.current=!1;const j=A(R);d.current=j,g.current=V?.getBoundingClientRect()||null,x.current=He(R.sourceEvent,g.current)}).on("drag",R=>{const V=A(R),{autoPanOnNodeDrag:L,nodeDragThreshold:j}=a.getState();if(R.sourceEvent.type==="touchmove"&&R.sourceEvent.touches.length>1&&(_.current=!0),!_.current){if(!w.current&&p.current&&L&&(w.current=!0,$()),!p.current){const P=V.xSnapped-(d?.current?.x??0),f=V.ySnapped-(d?.current?.y??0);Math.sqrt(P*P+f*f)>j&&O(R)}(d.current.x!==V.xSnapped||d.current.y!==V.ySnapped)&&l.current&&p.current&&(m.current=R.sourceEvent,x.current=He(R.sourceEvent,g.current),M(V))}}).on("end",R=>{if(!(!p.current||_.current)&&(u(!1),w.current=!1,p.current=!1,cancelAnimationFrame(h.current),l.current)){const{updateNodePositions:V,nodeInternals:L,onNodeDragStop:j,onSelectionDragStop:P}=a.getState(),f=o?j:Sn(P);if(V(l.current,!1,!1),f){const[N,v]=Nn({nodeId:o,dragItems:l.current,nodeInternals:L});f(R.sourceEvent,N,v)}}}).filter(R=>{const V=R.target;return!R.button&&(!n||!Xr(V,`.${n}`,e))&&(!r||Xr(V,r,e))});return y.call(H),()=>{y.on(".drag",null)}}}},[e,t,n,r,i,a,o,s,A]),c}function hs(){const e=re();return E.useCallback(n=>{const{nodeInternals:r,nodeExtent:o,updateNodePositions:i,getNodes:s,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=e.getState(),d=s().filter(_=>_.selected&&(_.draggable||l&&typeof _.draggable>"u")),h=a?c[0]:5,g=a?c[1]:5,x=n.isShiftPressed?4:1,m=n.x*h*x,w=n.y*g*x,p=d.map(_=>{if(_.positionAbsolute){const A={x:_.positionAbsolute.x+m,y:_.positionAbsolute.y+w};a&&(A.x=c[0]*Math.round(A.x/c[0]),A.y=c[1]*Math.round(A.y/c[1]));const{positionAbsolute:y,position:M}=ds(_,A,r,o,void 0,u);_.position=M,_.positionAbsolute=y}return _});i(p,!0,!1)},[])}const ut={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var _t=e=>{const t=({id:n,type:r,data:o,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:d,onMouseMove:h,onMouseLeave:g,onContextMenu:x,onDoubleClick:m,style:w,className:p,isDraggable:_,isSelectable:A,isConnectable:y,isFocusable:M,selectNodesOnDrag:$,sourcePosition:O,targetPosition:H,hidden:R,resizeObserver:V,dragHandle:L,zIndex:j,isParent:P,noDragClassName:f,noPanClassName:N,initialized:v,disableKeyboardA11y:k,ariaLabel:I,rfId:b,hasHandleBounds:T})=>{const z=re(),D=E.useRef(null),F=E.useRef(null),B=E.useRef(O),U=E.useRef(H),q=E.useRef(r),G=A||_||l||d||h||g,W=hs(),ee=bt(n,z.getState,d),K=bt(n,z.getState,h),pe=bt(n,z.getState,g),ue=bt(n,z.getState,x),ge=bt(n,z.getState,m),de=Q=>{const{nodeDragThreshold:Y}=z.getState();if(A&&(!$||!_||Y>0)&&Ln({id:n,store:z,nodeRef:D}),l){const ce=z.getState().nodeInternals.get(n);ce&&l(Q,{...ce})}},ne=Q=>{if(!Dn(Q)&&!k)if(Po.includes(Q.key)&&A){const Y=Q.key==="Escape";Ln({id:n,store:z,unselect:Y,nodeRef:D})}else _&&u&&Object.prototype.hasOwnProperty.call(ut,Q.key)&&(z.setState({ariaLiveMessage:`Moved selected node ${Q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),W({x:ut[Q.key].x,y:ut[Q.key].y,isShiftPressed:Q.shiftKey}))};E.useEffect(()=>()=>{F.current&&(V?.unobserve(F.current),F.current=null)},[]),E.useEffect(()=>{if(D.current&&!R){const Q=D.current;(!v||!T||F.current!==Q)&&(F.current&&V?.unobserve(F.current),V?.observe(Q),F.current=Q)}},[R,v,T]),E.useEffect(()=>{const Q=q.current!==r,Y=B.current!==O,ce=U.current!==H;D.current&&(Q||Y||ce)&&(Q&&(q.current=r),Y&&(B.current=O),ce&&(U.current=H),z.getState().updateNodeDimensions([{id:n,nodeElement:D.current,forceUpdate:!0}]))},[n,r,O,H]);const ve=fs({nodeRef:D,disabled:R||!_,noDragClassName:f,handleSelector:L,nodeId:n,isSelectable:A,selectNodesOnDrag:$});return R?null:S.createElement("div",{className:ie(["react-flow__node",`react-flow__node-${r}`,{[N]:_},p,{selected:u,selectable:A,parent:P,dragging:ve}]),ref:D,style:{zIndex:j,transform:`translate(${a}px,${c}px)`,pointerEvents:G?"all":"none",visibility:v?"visible":"hidden",...w},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:K,onMouseLeave:pe,onContextMenu:ue,onClick:de,onDoubleClick:ge,onKeyDown:M?ne:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":k?void 0:`${rs}-${b}`,"aria-label":I},S.createElement(lu,{value:n},S.createElement(e,{id:n,data:o,type:r,xPos:i,yPos:s,selected:u,isConnectable:y,sourcePosition:O,targetPosition:H,dragging:ve,dragHandle:L,zIndex:j})))};return t.displayName="NodeWrapper",E.memo(t)};const Wu=e=>{const t=e.getNodes().filter(n=>n.selected);return{...nr(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ku({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=re(),{width:o,height:i,x:s,y:a,transformString:c,userSelectionActive:u}=J(Wu,se),l=hs(),d=E.useRef(null);if(E.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),fs({nodeRef:d}),u||!o||!i)return null;const h=e?x=>{const m=r.getState().getNodes().filter(w=>w.selected);e(x,m)}:void 0,g=x=>{Object.prototype.hasOwnProperty.call(ut,x.key)&&l({x:ut[x.key].x,y:ut[x.key].y,isShiftPressed:x.shiftKey})};return S.createElement("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},S.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:g,style:{width:o,height:i,top:a,left:s}}))}var Qu=E.memo(Ku);const Ju=e=>e.nodesSelectionActive,ps=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:d,selectionOnDrag:h,selectionMode:g,onSelectionStart:x,onSelectionEnd:m,multiSelectionKeyCode:w,panActivationKeyCode:p,zoomActivationKeyCode:_,elementsSelectable:A,zoomOnScroll:y,zoomOnPinch:M,panOnScroll:$,panOnScrollSpeed:O,panOnScrollMode:H,zoomOnDoubleClick:R,panOnDrag:V,defaultViewport:L,translateExtent:j,minZoom:P,maxZoom:f,preventScrolling:N,onSelectionContextMenu:v,noWheelClassName:k,noPanClassName:I,disableKeyboardA11y:b})=>{const T=J(Ju),z=Rt(d),D=Rt(p),F=D||V,B=D||$,U=z||h&&F!==!0;return Ou({deleteKeyCode:a,multiSelectionKeyCode:w}),S.createElement(Bu,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:i,elementsSelectable:A,zoomOnScroll:y,zoomOnPinch:M,panOnScroll:B,panOnScrollSpeed:O,panOnScrollMode:H,zoomOnDoubleClick:R,panOnDrag:!z&&F,defaultViewport:L,translateExtent:j,minZoom:P,maxZoom:f,zoomActivationKeyCode:_,preventScrolling:N,noWheelClassName:k,noPanClassName:I},S.createElement(ls,{onSelectionStart:x,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:F,isSelecting:!!U,selectionMode:g},e,T&&S.createElement(Qu,{onSelectionContextMenu:v,noPanClassName:I,disableKeyboardA11y:b})))};ps.displayName="FlowRenderer";var ed=E.memo(ps);function td(e){return J(E.useCallback(n=>e?Xo(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function nd(e){const t={input:_t(e.input||Jo),default:_t(e.default||Vn),output:_t(e.output||ts),group:_t(e.group||or)},n={},r=Object.keys(e).filter(o=>!["input","default","output","group"].includes(o)).reduce((o,i)=>(o[i]=_t(e[i]||Vn),o),n);return{...t,...r}}const rd=({x:e,y:t,width:n,height:r,origin:o})=>!n||!r?{x:e,y:t}:o[0]<0||o[1]<0||o[0]>1||o[1]>1?{x:e,y:t}:{x:e-n*o[0],y:t-r*o[1]},od=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),gs=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,updateNodeDimensions:i,onError:s}=J(od,se),a=td(e.onlyRenderVisibleElements),c=E.useRef(),u=E.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const l=new ResizeObserver(d=>{const h=d.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));i(h)});return c.current=l,l},[]);return E.useEffect(()=>()=>{c?.current?.disconnect()},[]),S.createElement("div",{className:"react-flow__nodes",style:ir},a.map(l=>{let d=l.type||"default";e.nodeTypes[d]||(s?.("003",$e.error003(d)),d="default");const h=e.nodeTypes[d]||e.nodeTypes.default,g=!!(l.draggable||t&&typeof l.draggable>"u"),x=!!(l.selectable||o&&typeof l.selectable>"u"),m=!!(l.connectable||n&&typeof l.connectable>"u"),w=!!(l.focusable||r&&typeof l.focusable>"u"),p=e.nodeExtent?Wn(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,_=p?.x??0,A=p?.y??0,y=rd({x:_,y:A,width:l.width??0,height:l.height??0,origin:e.nodeOrigin});return S.createElement(h,{key:l.id,id:l.id,className:l.className,style:l.style,type:d,data:l.data,sourcePosition:l.sourcePosition||X.Bottom,targetPosition:l.targetPosition||X.Top,hidden:l.hidden,xPos:_,yPos:A,xPosOrigin:y.x,yPosOrigin:y.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:g,isSelectable:x,isConnectable:m,isFocusable:w,resizeObserver:u,dragHandle:l.dragHandle,zIndex:l[te]?.z??0,isParent:!!l[te]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!l[te]?.handleBounds})}))};gs.displayName="NodeRenderer";var sd=E.memo(gs);const id=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,ad=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,Ur="react-flow__edgeupdater",Zr=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a})=>S.createElement("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ie([Ur,`${Ur}-${a}`]),cx:id(t,r,e),cy:ad(n,r,e),r,stroke:"transparent",fill:"transparent"}),cd=()=>!0;var st=e=>{const t=({id:n,className:r,type:o,data:i,onClick:s,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:d,labelShowBg:h,labelBgStyle:g,labelBgPadding:x,labelBgBorderRadius:m,style:w,source:p,target:_,sourceX:A,sourceY:y,targetX:M,targetY:$,sourcePosition:O,targetPosition:H,elementsSelectable:R,hidden:V,sourceHandleId:L,targetHandleId:j,onContextMenu:P,onMouseEnter:f,onMouseMove:N,onMouseLeave:v,reconnectRadius:k,onReconnect:I,onReconnectStart:b,onReconnectEnd:T,markerEnd:z,markerStart:D,rfId:F,ariaLabel:B,isFocusable:U,isReconnectable:q,pathOptions:G,interactionWidth:W,disableKeyboardA11y:ee})=>{const K=E.useRef(null),[pe,ue]=E.useState(!1),[ge,de]=E.useState(!1),ne=re(),ve=E.useMemo(()=>`url('#${Pn(D,F)}')`,[D,F]),Q=E.useMemo(()=>`url('#${Pn(z,F)}')`,[z,F]);if(V)return null;const Y=oe=>{const{edges:be,addSelectedEdges:Le,unselectNodesAndEdges:je,multiSelectionActive:tt}=ne.getState(),_e=be.find(Be=>Be.id===n);_e&&(R&&(ne.setState({nodesSelectionActive:!1}),_e.selected&&tt?(je({nodes:[],edges:[_e]}),K.current?.blur()):Le([n])),s&&s(oe,_e))},ce=vt(n,ne.getState,a),Pe=vt(n,ne.getState,P),gt=vt(n,ne.getState,f),We=vt(n,ne.getState,N),Ke=vt(n,ne.getState,v),Ce=(oe,be)=>{if(oe.button!==0)return;const{edges:Le,isValidConnection:je}=ne.getState(),tt=be?_:p,_e=(be?j:L)||null,Be=be?"target":"source",hn=je||cd,pn=be,yt=Le.find(Fe=>Fe.id===n);de(!0),b?.(oe,yt,Be);const gn=Fe=>{de(!1),T?.(Fe,yt,Be)};Go({event:oe,handleId:_e,nodeId:tt,onConnect:Fe=>I?.(yt,Fe),isTarget:pn,getState:ne.getState,setState:ne.setState,isValidConnection:hn,edgeUpdaterType:Be,onReconnectEnd:gn})},Qe=oe=>Ce(oe,!0),Oe=oe=>Ce(oe,!1),Ve=()=>ue(!0),Je=()=>ue(!1),et=!R&&!s,mt=oe=>{if(!ee&&Po.includes(oe.key)&&R){const{unselectNodesAndEdges:be,addSelectedEdges:Le,edges:je}=ne.getState();oe.key==="Escape"?(K.current?.blur(),be({edges:[je.find(_e=>_e.id===n)]})):Le([n])}};return S.createElement("g",{className:ie(["react-flow__edge",`react-flow__edge-${o}`,r,{selected:c,animated:u,inactive:et,updating:pe}]),onClick:Y,onDoubleClick:ce,onContextMenu:Pe,onMouseEnter:gt,onMouseMove:We,onMouseLeave:Ke,onKeyDown:U?mt:void 0,tabIndex:U?0:void 0,role:U?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":B===null?void 0:B||`Edge from ${p} to ${_}`,"aria-describedby":U?`${os}-${F}`:void 0,ref:K},!ge&&S.createElement(e,{id:n,source:p,target:_,selected:c,animated:u,label:l,labelStyle:d,labelShowBg:h,labelBgStyle:g,labelBgPadding:x,labelBgBorderRadius:m,data:i,style:w,sourceX:A,sourceY:y,targetX:M,targetY:$,sourcePosition:O,targetPosition:H,sourceHandleId:L,targetHandleId:j,markerStart:ve,markerEnd:Q,pathOptions:G,interactionWidth:W}),q&&S.createElement(S.Fragment,null,(q==="source"||q===!0)&&S.createElement(Zr,{position:O,centerX:A,centerY:y,radius:k,onMouseDown:Qe,onMouseEnter:Ve,onMouseOut:Je,type:"source"}),(q==="target"||q===!0)&&S.createElement(Zr,{position:H,centerX:M,centerY:$,radius:k,onMouseDown:Oe,onMouseEnter:Ve,onMouseOut:Je,type:"target"})))};return t.displayName="EdgeWrapper",E.memo(t)};function ld(e){const t={default:st(e.default||rn),straight:st(e.bezier||er),step:st(e.step||Jn),smoothstep:st(e.step||fn),simplebezier:st(e.simplebezier||Qn)},n={},r=Object.keys(e).filter(o=>!["default","bezier"].includes(o)).reduce((o,i)=>(o[i]=st(e[i]||rn),o),n);return{...t,...r}}function qr(e,t,n=null){const r=(n?.x||0)+t.x,o=(n?.y||0)+t.y,i=n?.width||t.width,s=n?.height||t.height;switch(e){case X.Top:return{x:r+i/2,y:o};case X.Right:return{x:r+i,y:o+s/2};case X.Bottom:return{x:r+i/2,y:o+s};case X.Left:return{x:r,y:o+s/2}}}function Gr(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const ud=(e,t,n,r,o,i)=>{const s=qr(n,e,t),a=qr(i,r,o);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function dd({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:o,targetHeight:i,width:s,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+o),y2:Math.max(e.y+r,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=Kn({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:a/c[2]}),d=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),h=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(d*h)>0}function Wr(e){const t=e?.[te]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const fd=[{level:0,isMaxLevel:!0,edges:[]}];function hd(e,t,n=!1){let r=-1;const o=e.reduce((s,a)=>{const c=he(a.zIndex);let u=c?a.zIndex:0;if(n){const l=t.get(a.target),d=t.get(a.source),h=a.selected||l?.selected||d?.selected,g=Math.max(d?.[te]?.z||0,l?.[te]?.z||0,1e3);u=(c?a.zIndex:0)+(h?g:0)}return s[u]?s[u].push(a):s[u]=[a],r=u>r?u:r,s},{}),i=Object.entries(o).map(([s,a])=>{const c=+s;return{edges:a,level:c,isMaxLevel:c===r}});return i.length===0?fd:i}function pd(e,t,n){const r=J(E.useCallback(o=>e?o.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return s?.width&&s?.height&&a?.width&&a?.height&&dd({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:o.width,height:o.height,transform:o.transform})}):o.edges,[e,t]));return hd(r,t,n)}const gd=({color:e="none",strokeWidth:t=1})=>S.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),md=({color:e="none",strokeWidth:t=1})=>S.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Kr={[nn.Arrow]:gd,[nn.ArrowClosed]:md};function yd(e){const t=re();return E.useMemo(()=>Object.prototype.hasOwnProperty.call(Kr,e)?Kr[e]:(t.getState().onError?.("009",$e.error009(e)),null),[e])}const xd=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=yd(t);return c?S.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},S.createElement(c,{color:n,strokeWidth:s})):null},wd=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((o,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=Pn(s,t);r.includes(a)||(o.push({id:a,color:s.color||e,...s}),r.push(a))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))},ms=({defaultColor:e,rfId:t})=>{const n=J(E.useCallback(wd({defaultColor:e,rfId:t}),[e,t]),(r,o)=>!(r.length!==o.length||r.some((i,s)=>i.id!==o[s].id)));return S.createElement("defs",null,n.map(r=>S.createElement(xd,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};ms.displayName="MarkerDefinitions";var vd=E.memo(ms);const bd=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),ys=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:o,noPanClassName:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,onEdgeDoubleClick:d,onReconnect:h,onReconnectStart:g,onReconnectEnd:x,reconnectRadius:m,children:w,disableKeyboardA11y:p})=>{const{edgesFocusable:_,edgesUpdatable:A,elementsSelectable:y,width:M,height:$,connectionMode:O,nodeInternals:H,onError:R}=J(bd,se),V=pd(t,H,n);return M?S.createElement(S.Fragment,null,V.map(({level:L,edges:j,isMaxLevel:P})=>S.createElement("svg",{key:L,style:{zIndex:L},width:M,height:$,className:"react-flow__edges react-flow__container"},P&&S.createElement(vd,{defaultColor:e,rfId:r}),S.createElement("g",null,j.map(f=>{const[N,v,k]=Wr(H.get(f.source)),[I,b,T]=Wr(H.get(f.target));if(!k||!T)return null;let z=f.type||"default";o[z]||(R?.("011",$e.error011(z)),z="default");const D=o[z]||o.default,F=O===Ge.Strict?b.target:(b.target??[]).concat(b.source??[]),B=Gr(v.source,f.sourceHandle),U=Gr(F,f.targetHandle),q=B?.position||X.Bottom,G=U?.position||X.Top,W=!!(f.focusable||_&&typeof f.focusable>"u"),ee=f.reconnectable||f.updatable,K=typeof h<"u"&&(ee||A&&typeof ee>"u");if(!B||!U)return R?.("008",$e.error008(B,f)),null;const{sourceX:pe,sourceY:ue,targetX:ge,targetY:de}=ud(N,B,q,I,U,G);return S.createElement(D,{key:f.id,id:f.id,className:ie([f.className,i]),type:z,data:f.data,selected:!!f.selected,animated:!!f.animated,hidden:!!f.hidden,label:f.label,labelStyle:f.labelStyle,labelShowBg:f.labelShowBg,labelBgStyle:f.labelBgStyle,labelBgPadding:f.labelBgPadding,labelBgBorderRadius:f.labelBgBorderRadius,style:f.style,source:f.source,target:f.target,sourceHandleId:f.sourceHandle,targetHandleId:f.targetHandle,markerEnd:f.markerEnd,markerStart:f.markerStart,sourceX:pe,sourceY:ue,targetX:ge,targetY:de,sourcePosition:q,targetPosition:G,elementsSelectable:y,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:l,onEdgeDoubleClick:d,onReconnect:h,onReconnectStart:g,onReconnectEnd:x,reconnectRadius:m,rfId:r,ariaLabel:f.ariaLabel,isFocusable:W,isReconnectable:K,pathOptions:"pathOptions"in f?f.pathOptions:void 0,interactionWidth:f.interactionWidth,disableKeyboardA11y:p})})))),w):null};ys.displayName="EdgeRenderer";var _d=E.memo(ys);const Ed=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Nd({children:e}){const t=J(Ed);return S.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Sd(e){const t=sr(),n=E.useRef(!1);E.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Cd={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top},xs=({nodeId:e,handleType:t,style:n,type:r=Ie.Bezier,CustomComponent:o,connectionStatus:i})=>{const{fromNode:s,handleId:a,toX:c,toY:u,connectionMode:l}=J(E.useCallback($=>({fromNode:$.nodeInternals.get(e),handleId:$.connectionHandleId,toX:($.connectionPosition.x-$.transform[0])/$.transform[2],toY:($.connectionPosition.y-$.transform[1])/$.transform[2],connectionMode:$.connectionMode}),[e]),se),d=s?.[te]?.handleBounds;let h=d?.[t];if(l===Ge.Loose&&(h=h||d?.[t==="source"?"target":"source"]),!s||!h)return null;const g=a?h.find($=>$.id===a):h[0],x=g?g.x+g.width/2:(s.width??0)/2,m=g?g.y+g.height/2:s.height??0,w=(s.positionAbsolute?.x??0)+x,p=(s.positionAbsolute?.y??0)+m,_=g?.position,A=_?Cd[_]:null;if(!_||!A)return null;if(o)return S.createElement(o,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:g,fromX:w,fromY:p,toX:c,toY:u,fromPosition:_,toPosition:A,connectionStatus:i});let y="";const M={sourceX:w,sourceY:p,sourcePosition:_,targetX:c,targetY:u,targetPosition:A};return r===Ie.Bezier?[y]=Bo(M):r===Ie.Step?[y]=Hn({...M,borderRadius:0}):r===Ie.SmoothStep?[y]=Hn(M):r===Ie.SimpleBezier?[y]=jo(M):y=`M${w},${p} ${c},${u}`,S.createElement("path",{d:y,fill:"none",className:"react-flow__connection-path",style:n})};xs.displayName="ConnectionLine";const Ad=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function kd({containerStyle:e,style:t,type:n,component:r}){const{nodeId:o,handleType:i,nodesConnectable:s,width:a,height:c,connectionStatus:u}=J(Ad,se);return!(o&&i&&a&&s)?null:S.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},S.createElement("g",{className:ie(["react-flow__connection",u])},S.createElement(xs,{nodeId:o,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function Qr(e,t){return E.useRef(null),re(),E.useMemo(()=>t(e),[e])}const ws=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:o,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:d,onNodeMouseLeave:h,onNodeContextMenu:g,onSelectionContextMenu:x,onSelectionStart:m,onSelectionEnd:w,connectionLineType:p,connectionLineStyle:_,connectionLineComponent:A,connectionLineContainerStyle:y,selectionKeyCode:M,selectionOnDrag:$,selectionMode:O,multiSelectionKeyCode:H,panActivationKeyCode:R,zoomActivationKeyCode:V,deleteKeyCode:L,onlyRenderVisibleElements:j,elementsSelectable:P,selectNodesOnDrag:f,defaultViewport:N,translateExtent:v,minZoom:k,maxZoom:I,preventScrolling:b,defaultMarkerColor:T,zoomOnScroll:z,zoomOnPinch:D,panOnScroll:F,panOnScrollSpeed:B,panOnScrollMode:U,zoomOnDoubleClick:q,panOnDrag:G,onPaneClick:W,onPaneMouseEnter:ee,onPaneMouseMove:K,onPaneMouseLeave:pe,onPaneScroll:ue,onPaneContextMenu:ge,onEdgeContextMenu:de,onEdgeMouseEnter:ne,onEdgeMouseMove:ve,onEdgeMouseLeave:Q,onReconnect:Y,onReconnectStart:ce,onReconnectEnd:Pe,reconnectRadius:gt,noDragClassName:We,noWheelClassName:Ke,noPanClassName:Ce,elevateEdgesOnSelect:Qe,disableKeyboardA11y:Oe,nodeOrigin:Ve,nodeExtent:Je,rfId:et})=>{const mt=Qr(e,nd),oe=Qr(t,ld);return Sd(i),S.createElement(ed,{onPaneClick:W,onPaneMouseEnter:ee,onPaneMouseMove:K,onPaneMouseLeave:pe,onPaneContextMenu:ge,onPaneScroll:ue,deleteKeyCode:L,selectionKeyCode:M,selectionOnDrag:$,selectionMode:O,onSelectionStart:m,onSelectionEnd:w,multiSelectionKeyCode:H,panActivationKeyCode:R,zoomActivationKeyCode:V,elementsSelectable:P,onMove:n,onMoveStart:r,onMoveEnd:o,zoomOnScroll:z,zoomOnPinch:D,zoomOnDoubleClick:q,panOnScroll:F,panOnScrollSpeed:B,panOnScrollMode:U,panOnDrag:G,defaultViewport:N,translateExtent:v,minZoom:k,maxZoom:I,onSelectionContextMenu:x,preventScrolling:b,noDragClassName:We,noWheelClassName:Ke,noPanClassName:Ce,disableKeyboardA11y:Oe},S.createElement(Nd,null,S.createElement(_d,{edgeTypes:oe,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:j,onEdgeContextMenu:de,onEdgeMouseEnter:ne,onEdgeMouseMove:ve,onEdgeMouseLeave:Q,onReconnect:Y,onReconnectStart:ce,onReconnectEnd:Pe,reconnectRadius:gt,defaultMarkerColor:T,noPanClassName:Ce,elevateEdgesOnSelect:!!Qe,disableKeyboardA11y:Oe,rfId:et},S.createElement(kd,{style:_,type:p,component:A,containerStyle:y})),S.createElement("div",{className:"react-flow__edgelabel-renderer"}),S.createElement(sd,{nodeTypes:mt,onNodeClick:s,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:d,onNodeMouseLeave:h,onNodeContextMenu:g,selectNodesOnDrag:f,onlyRenderVisibleElements:j,noPanClassName:Ce,noDragClassName:We,disableKeyboardA11y:Oe,nodeOrigin:Ve,nodeExtent:Je,rfId:et})))};ws.displayName="GraphView";var Md=E.memo(ws);const jn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Te={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:jn,nodeExtent:jn,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ge.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:ru,isValidConnection:void 0},$d=()=>mi((e,t)=>({...Te,setNodes:n=>{const{nodeInternals:r,nodeOrigin:o,elevateNodesOnSelect:i}=t();e({nodeInternals:_n(n,r,o,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(o=>({...r,...o}))})},setDefaultNodesAndEdges:(n,r)=>{const o=typeof n<"u",i=typeof r<"u",s=o?_n(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?r:[],hasDefaultNodes:o,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:o,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),l=c?.querySelector(".react-flow__viewport");if(!l)return;const d=window.getComputedStyle(l),{m22:h}=new window.DOMMatrixReadOnly(d.transform),g=n.reduce((m,w)=>{const p=o.get(w.id);if(p?.hidden)o.set(p.id,{...p,[te]:{...p[te],handleBounds:void 0}});else if(p){const _=Gn(w.nodeElement);!!(_.width&&_.height&&(p.width!==_.width||p.height!==_.height||w.forceUpdate))&&(o.set(p.id,{...p,[te]:{...p[te],handleBounds:{source:Yr(".source",w.nodeElement,h,u),target:Yr(".target",w.nodeElement,h,u)}},..._}),m.push({id:p.id,type:"dimensions",dimensions:_}))}return m},[]);is(o,u);const x=s||i&&!s&&as(t,{initial:!0,...a});e({nodeInternals:new Map(o),fitViewOnInitDone:x}),g?.length>0&&r?.(g)},updateNodePositions:(n,r=!0,o=!1)=>{const{triggerNodeChanges:i}=t(),s=n.map(a=>{const c={id:a.id,type:"position",dragging:o};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});i(s)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:o,hasDefaultNodes:i,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:c}=t();if(n?.length){if(i){const u=cs(n,a()),l=_n(u,o,s,c);e({nodeInternals:l})}r?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(c=>ze(c,!0)):(s=it(i(),n),a=it(o,[])),Ft({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:o,getNodes:i}=t();let s,a=null;r?s=n.map(c=>ze(c,!0)):(s=it(o,n),a=it(i(),[])),Ft({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:o,getNodes:i}=t(),s=n||i(),a=r||o,c=s.map(l=>(l.selected=!1,ze(l.id,!1))),u=a.map(l=>ze(l.id,!1));Ft({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:o}=t();r?.scaleExtent([n,o]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:o}=t();r?.scaleExtent([o,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(a=>a.selected).map(a=>ze(a.id,!1)),s=n.filter(a=>a.selected).map(a=>ze(a.id,!1));Ft({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(o=>{o.positionAbsolute=Wn(o.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:o,height:i,d3Zoom:s,d3Selection:a,translateExtent:c}=t();if(!s||!a||!n.x&&!n.y)return!1;const u=De.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),l=[[0,0],[o,i]],d=s?.constrain()(u,l,c);return s.transform(a,d),r[0]!==d.x||r[1]!==d.y||r[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Te.connectionNodeId,connectionHandleId:Te.connectionHandleId,connectionHandleType:Te.connectionHandleType,connectionStatus:Te.connectionStatus,connectionStartHandle:Te.connectionStartHandle,connectionEndHandle:Te.connectionEndHandle}),reset:()=>e({...Te})}),Object.is),vs=({children:e})=>{const t=E.useRef(null);return t.current||(t.current=$d()),S.createElement(Gl,{value:t.current},e)};vs.displayName="ReactFlowProvider";const bs=({children:e})=>E.useContext(dn)?S.createElement(S.Fragment,null,e):S.createElement(vs,null,e);bs.displayName="ReactFlowWrapper";const Td={input:Jo,default:Vn,output:ts,group:or},Rd={default:rn,straight:er,step:Jn,smoothstep:fn,simplebezier:Qn},zd=[0,0],Id=[15,15],Dd={x:0,y:0,zoom:1},Hd={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},_s=E.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i=Td,edgeTypes:s=Rd,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:d,onMoveEnd:h,onConnect:g,onConnectStart:x,onConnectEnd:m,onClickConnectStart:w,onClickConnectEnd:p,onNodeMouseEnter:_,onNodeMouseMove:A,onNodeMouseLeave:y,onNodeContextMenu:M,onNodeDoubleClick:$,onNodeDragStart:O,onNodeDrag:H,onNodeDragStop:R,onNodesDelete:V,onEdgesDelete:L,onSelectionChange:j,onSelectionDragStart:P,onSelectionDrag:f,onSelectionDragStop:N,onSelectionContextMenu:v,onSelectionStart:k,onSelectionEnd:I,connectionMode:b=Ge.Strict,connectionLineType:T=Ie.Bezier,connectionLineStyle:z,connectionLineComponent:D,connectionLineContainerStyle:F,deleteKeyCode:B="Backspace",selectionKeyCode:U="Shift",selectionOnDrag:q=!1,selectionMode:G=Tt.Full,panActivationKeyCode:W="Space",multiSelectionKeyCode:ee=tn()?"Meta":"Control",zoomActivationKeyCode:K=tn()?"Meta":"Control",snapToGrid:pe=!1,snapGrid:ue=Id,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:de=!0,nodesDraggable:ne,nodesConnectable:ve,nodesFocusable:Q,nodeOrigin:Y=zd,edgesFocusable:ce,edgesUpdatable:Pe,elementsSelectable:gt,defaultViewport:We=Dd,minZoom:Ke=.5,maxZoom:Ce=2,translateExtent:Qe=jn,preventScrolling:Oe=!0,nodeExtent:Ve,defaultMarkerColor:Je="#b1b1b7",zoomOnScroll:et=!0,zoomOnPinch:mt=!0,panOnScroll:oe=!1,panOnScrollSpeed:be=.5,panOnScrollMode:Le=Ue.Free,zoomOnDoubleClick:je=!0,panOnDrag:tt=!0,onPaneClick:_e,onPaneMouseEnter:Be,onPaneMouseMove:hn,onPaneMouseLeave:pn,onPaneScroll:yt,onPaneContextMenu:gn,children:ar,onEdgeContextMenu:Fe,onEdgeDoubleClick:Ss,onEdgeMouseEnter:Cs,onEdgeMouseMove:As,onEdgeMouseLeave:ks,onEdgeUpdate:Ms,onEdgeUpdateStart:$s,onEdgeUpdateEnd:Ts,onReconnect:Rs,onReconnectStart:zs,onReconnectEnd:Is,reconnectRadius:Ds=10,edgeUpdaterRadius:Hs=10,onNodesChange:Ps,onEdgesChange:Os,noDragClassName:Vs="nodrag",noWheelClassName:Ls="nowheel",noPanClassName:cr="nopan",fitView:js=!1,fitViewOptions:Bs,connectOnClick:Fs=!0,attributionPosition:Xs,proOptions:Ys,defaultEdgeOptions:Us,elevateNodesOnSelect:Zs=!0,elevateEdgesOnSelect:qs=!1,disableKeyboardA11y:lr=!1,autoPanOnConnect:Gs=!0,autoPanOnNodeDrag:Ws=!0,connectionRadius:Ks=20,isValidConnection:Qs,onError:Js,style:ei,id:ur,nodeDragThreshold:ti,...ni},ri)=>{const mn=ur||"1";return S.createElement("div",{...ni,style:{...ei,...Hd},ref:ri,className:ie(["react-flow",o]),"data-testid":"rf__wrapper",id:ur},S.createElement(bs,null,S.createElement(Md,{onInit:u,onMove:l,onMoveStart:d,onMoveEnd:h,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:_,onNodeMouseMove:A,onNodeMouseLeave:y,onNodeContextMenu:M,onNodeDoubleClick:$,nodeTypes:i,edgeTypes:s,connectionLineType:T,connectionLineStyle:z,connectionLineComponent:D,connectionLineContainerStyle:F,selectionKeyCode:U,selectionOnDrag:q,selectionMode:G,deleteKeyCode:B,multiSelectionKeyCode:ee,panActivationKeyCode:W,zoomActivationKeyCode:K,onlyRenderVisibleElements:ge,selectNodesOnDrag:de,defaultViewport:We,translateExtent:Qe,minZoom:Ke,maxZoom:Ce,preventScrolling:Oe,zoomOnScroll:et,zoomOnPinch:mt,zoomOnDoubleClick:je,panOnScroll:oe,panOnScrollSpeed:be,panOnScrollMode:Le,panOnDrag:tt,onPaneClick:_e,onPaneMouseEnter:Be,onPaneMouseMove:hn,onPaneMouseLeave:pn,onPaneScroll:yt,onPaneContextMenu:gn,onSelectionContextMenu:v,onSelectionStart:k,onSelectionEnd:I,onEdgeContextMenu:Fe,onEdgeDoubleClick:Ss,onEdgeMouseEnter:Cs,onEdgeMouseMove:As,onEdgeMouseLeave:ks,onReconnect:Rs??Ms,onReconnectStart:zs??$s,onReconnectEnd:Is??Ts,reconnectRadius:Ds??Hs,defaultMarkerColor:Je,noDragClassName:Vs,noWheelClassName:Ls,noPanClassName:cr,elevateEdgesOnSelect:qs,rfId:mn,disableKeyboardA11y:lr,nodeOrigin:Y,nodeExtent:Ve}),S.createElement(Cu,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:g,onConnectStart:x,onConnectEnd:m,onClickConnectStart:w,onClickConnectEnd:p,nodesDraggable:ne,nodesConnectable:ve,nodesFocusable:Q,edgesFocusable:ce,edgesUpdatable:Pe,elementsSelectable:gt,elevateNodesOnSelect:Zs,minZoom:Ke,maxZoom:Ce,nodeExtent:Ve,onNodesChange:Ps,onEdgesChange:Os,snapToGrid:pe,snapGrid:ue,connectionMode:b,translateExtent:Qe,connectOnClick:Fs,defaultEdgeOptions:Us,fitView:js,fitViewOptions:Bs,onNodesDelete:V,onEdgesDelete:L,onNodeDragStart:O,onNodeDrag:H,onNodeDragStop:R,onSelectionDrag:f,onSelectionDragStart:P,onSelectionDragStop:N,noPanClassName:cr,nodeOrigin:Y,rfId:mn,autoPanOnConnect:Gs,autoPanOnNodeDrag:Ws,onError:Js,connectionRadius:Ks,isValidConnection:Qs,nodeDragThreshold:ti}),S.createElement(Nu,{onSelectionChange:j}),ar,S.createElement(Kl,{proOptions:Ys,position:Xs}),S.createElement(Tu,{rfId:mn,disableKeyboardA11y:lr})))});_s.displayName="ReactFlow";function Pd(e){return t=>{const[n,r]=E.useState(t),o=E.useCallback(i=>r(s=>e(i,s)),[]);return[n,r,o]}}const Od=Pd(cs);function Vd(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},S.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ld(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},S.createElement("path",{d:"M0 0h32v4.2H0z"}))}function jd(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},S.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Bd(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},S.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Fd(){return S.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},S.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const St=({children:e,className:t,...n})=>S.createElement("button",{type:"button",className:ie(["react-flow__controls-button",t]),...n},e);St.displayName="ControlButton";const Xd=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Es=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:u,children:l,position:d="bottom-left"})=>{const h=re(),[g,x]=E.useState(!1),{isInteractive:m,minZoomReached:w,maxZoomReached:p}=J(Xd,se),{zoomIn:_,zoomOut:A,fitView:y}=sr();if(E.useEffect(()=>{x(!0)},[]),!g)return null;const M=()=>{_(),i?.()},$=()=>{A(),s?.()},O=()=>{y(o),a?.()},H=()=>{h.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c?.(!m)};return S.createElement(Io,{className:ie(["react-flow__controls",u]),position:d,style:e,"data-testid":"rf__controls"},t&&S.createElement(S.Fragment,null,S.createElement(St,{onClick:M,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:p},S.createElement(Vd,null)),S.createElement(St,{onClick:$,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:w},S.createElement(Ld,null))),n&&S.createElement(St,{className:"react-flow__controls-fitview",onClick:O,title:"fit view","aria-label":"fit view"},S.createElement(jd,null)),r&&S.createElement(St,{className:"react-flow__controls-interactive",onClick:H,title:"toggle interactivity","aria-label":"toggle interactivity"},m?S.createElement(Fd,null):S.createElement(Bd,null)),l)};Es.displayName="Controls";var Yd=E.memo(Es),xe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(xe||(xe={}));function Ud({color:e,dimensions:t,lineWidth:n}){return S.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Zd({color:e,radius:t}){return S.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const qd={[xe.Dots]:"#91919a",[xe.Lines]:"#eee",[xe.Cross]:"#e2e2e2"},Gd={[xe.Dots]:1,[xe.Lines]:1,[xe.Cross]:6},Wd=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Ns({id:e,variant:t=xe.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=2,color:s,style:a,className:c}){const u=E.useRef(null),{transform:l,patternId:d}=J(Wd,se),h=s||qd[t],g=r||Gd[t],x=t===xe.Dots,m=t===xe.Cross,w=Array.isArray(n)?n:[n,n],p=[w[0]*l[2]||1,w[1]*l[2]||1],_=g*l[2],A=m?[_,_]:p,y=x?[_/i,_/i]:[A[0]/i,A[1]/i];return S.createElement("svg",{className:ie(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},S.createElement("pattern",{id:d+e,x:l[0]%p[0],y:l[1]%p[1],width:p[0],height:p[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${y[0]},-${y[1]})`},x?S.createElement(Zd,{color:h,radius:_/i}):S.createElement(Ud,{dimensions:A,color:h,lineWidth:o})),S.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}Ns.displayName="Background";var Kd=E.memo(Ns);const pt={pending:0,approved:260,revoked:520},Qd=80,Jd=130,ef=(pt.approved+pt.pending)/2,tf=(pt.revoked+pt.approved)/2,nf={pending:"border-slate-700/60 bg-slate-900/80 text-gray-200",approved:"border-emerald-500/40 bg-emerald-500/10 text-emerald-100",revoked:"border-red-500/40 bg-red-500/10 text-red-100"};function rf(e){return e==="high"?C.jsx(ro,{size:14,className:"text-red-300"}):e==="medium"?C.jsx(Bn,{size:14,className:"text-amber-300"}):C.jsx(sn,{size:14,className:"text-emerald-300"})}const of=({data:e})=>{const{label:t,description:n,status:r,risk:o}=e;return C.jsxs("div",{className:`w-56 rounded-2xl border px-4 py-3 shadow-lg shadow-black/30 transition-colors duration-200 ${nf[r]}`,children:[C.jsxs("div",{className:"flex items-center justify-between gap-2",children:[C.jsx("span",{className:"text-xs font-semibold leading-tight line-clamp-1",children:t}),rf(o)]}),C.jsx("div",{className:"mt-2 text-[11px] leading-snug text-gray-300/80 line-clamp-3",children:n||"No additional context provided."}),r==="pending"&&C.jsxs("div",{className:"mt-3 rounded-lg border border-dashed border-amber-400/60 bg-amber-500/10 px-2 py-1 text-[10px] text-amber-100",children:["Drag into ",C.jsx("span",{className:"font-semibold",children:"Approve"})," or ",C.jsx("span",{className:"font-semibold",children:"Reject"})," lanes"]}),r==="approved"&&C.jsx("div",{className:"mt-3 rounded-lg border border-emerald-500/30 bg-emerald-500/10 px-2 py-1 text-[10px] text-emerald-100",children:"Approved and logged in ledger"}),r==="revoked"&&C.jsx("div",{className:"mt-3 rounded-lg border border-red-500/30 bg-red-500/10 px-2 py-1 text-[10px] text-red-100",children:"Revoked â€“ access blocked"})]})},sf={consent:of};function af(e){return e.revokedAt?"revoked":e.approved?"approved":"pending"}function cf(e){const t={pending:[],approved:[],revoked:[]};return e.forEach(n=>{const r=af(n);t[r].push(n)}),["pending","approved","revoked"].flatMap(n=>t[n].slice(0,6).map((o,i)=>({id:o.id,type:"consent",position:{x:pt[n],y:Qd+i*Jd},data:{record:o,label:fe[o.action.type]??o.action.type,description:o.action.description??"â€”",status:n,risk:o.action.risk},draggable:n==="pending"})))}function lf({records:e,onApprove:t,onRevoke:n,loading:r}){const[o,i,s]=Od([]),a=E.useMemo(()=>[],[]);E.useEffect(()=>{i(cf(e))},[e,i]);const c=(l,d,h)=>{i(g=>g.map(x=>x.id===l?{...x,position:{x:pt[d],y:h},data:{...x.data,status:d},draggable:d==="pending"}:x))},u=async(l,d)=>{const h=d.data?.record;if(!h||r){c(d.id,"pending",d.position.y);return}const{x:g,y:x}=d.position;if(g>=tf){c(d.id,"revoked",x);try{await n(h.id)}catch(m){console.warn("[ConsentFlowGraph] revoke failed",m),c(d.id,"pending",x)}return}if(g>=ef){c(d.id,"approved",x);try{await t(h.id)}catch(m){console.warn("[ConsentFlowGraph] approve failed",m),c(d.id,"pending",x)}return}c(d.id,"pending",x)};return C.jsxs("div",{className:"relative h-[360px] w-full overflow-hidden rounded-3xl border border-slate-800/60 bg-slate-950/40",children:[C.jsxs("div",{className:"pointer-events-none absolute inset-0 grid grid-cols-3",children:[C.jsxs("div",{className:"flex flex-col items-center justify-start gap-2 pt-4",children:[C.jsx("span",{className:"rounded-full border border-slate-700/60 bg-slate-900/70 px-3 py-1 text-[10px] uppercase tracking-[0.3em] text-gray-400",children:"Pending"}),C.jsx("span",{className:"text-[9px] text-gray-500",children:"Review requested actions"})]}),C.jsxs("div",{className:"flex flex-col items-center justify-start gap-2 pt-4",children:[C.jsx("span",{className:"rounded-full border border-emerald-500/40 bg-emerald-500/10 px-3 py-1 text-[10px] uppercase tracking-[0.3em] text-emerald-200",children:"Approve"}),C.jsx("span",{className:"text-[9px] text-emerald-200/80",children:"Drop here to grant consent"})]}),C.jsxs("div",{className:"flex flex-col items-center justify-start gap-2 pt-4",children:[C.jsx("span",{className:"rounded-full border border-red-500/40 bg-red-500/10 px-3 py-1 text-[10px] uppercase tracking-[0.3em] text-red-200",children:"Reject"}),C.jsx("span",{className:"text-[9px] text-red-200/80",children:"Drop here to revoke or deny"})]})]}),e.length===0&&C.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center text-sm text-gray-500",children:"No consent requests yet â€” drag-to-approve suggestions will appear here."}),C.jsxs(_s,{nodes:o,edges:a,onNodesChange:s,onNodeDragStop:u,nodeTypes:sf,fitView:!0,fitViewOptions:{padding:.2},minZoom:.85,maxZoom:1.4,nodesDraggable:!0,nodesConnectable:!1,elementsSelectable:!1,zoomOnDoubleClick:!1,zoomOnScroll:!1,zoomOnPinch:!1,panOnDrag:!1,preventScrolling:!1,proOptions:{hideAttribution:!0},className:"h-full w-full",children:[C.jsx(Kd,{gap:24,color:"rgba(148, 163, 184, 0.15)"}),C.jsx(Yd,{position:"bottom-right",showInteractive:!1})]})]})}const uf=e=>e.revokedAt?{label:"Revoked",tone:"text-red-400 bg-red-500/10 border-red-500/40"}:e.approved?{label:"Approved",tone:"text-emerald-300 bg-emerald-500/10 border-emerald-500/40"}:{label:"Pending",tone:"text-amber-300 bg-amber-500/10 border-amber-500/40"},df=e=>e==="high"?C.jsx(ro,{size:14,className:"text-red-400"}):e==="medium"?C.jsx(Bn,{size:14,className:"text-amber-400"}):C.jsx(sn,{size:14,className:"text-emerald-400"});function Pf(){const{visible:e,records:t,loading:n,error:r,filter:o,close:i,refresh:s,setFilter:a,approve:c,revoke:u}=ii(),[l,d]=E.useState(!1);E.useEffect(()=>{if(!e)return;const p=setInterval(()=>{s()},2e4);return()=>clearInterval(p)},[e,s]);const h=E.useMemo(()=>t.filter(p=>!p.approved).length,[t]),g=E.useMemo(()=>t.filter(p=>!!p.revokedAt).length,[t]),x=E.useMemo(()=>t.filter(p=>p.approved&&!p.revokedAt).length,[t]),m=async()=>{try{d(!0);const p=await Jr.consent.export(),_=new Blob([p],{type:"application/json"}),A=URL.createObjectURL(_),y=document.createElement("a");y.href=A,y.download=`omnibrowser-consent-ledger-${new Date().toISOString()}.json`,document.body.appendChild(y),y.click(),y.remove(),URL.revokeObjectURL(A)}catch(p){console.error("Failed to export consent ledger",p)}finally{d(!1)}},w=p=>{const _=uf(p),A=li(new Date(p.timestamp),{addSuffix:!0});return C.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/60 p-4 space-y-3",children:[C.jsxs("div",{className:"flex items-center justify-between gap-3",children:[C.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-200",children:[df(p.action.risk),C.jsx("span",{children:fe[p.action.type]})]}),C.jsx("span",{className:`rounded-full border px-2 py-0.5 text-[11px] ${_.tone}`,children:_.label})]}),C.jsx("div",{className:"text-xs text-gray-400 leading-relaxed whitespace-pre-wrap",children:p.action.description}),C.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-[11px] text-gray-500",children:[C.jsxs("div",{children:[C.jsx("span",{className:"text-gray-400",children:"Target:"})," ",C.jsx("span",{className:"text-gray-200",children:p.action.target??"â€”"})]}),C.jsxs("div",{children:[C.jsx("span",{className:"text-gray-400",children:"Risk:"})," ",C.jsx("span",{className:"text-gray-200 capitalize",children:p.action.risk})]}),C.jsxs("div",{children:[C.jsx("span",{className:"text-gray-400",children:"Requested:"})," ",C.jsx("span",{className:"text-gray-200",children:A})]}),C.jsxs("div",{children:[C.jsx("span",{className:"text-gray-400",children:"Ledger ID:"})," ",C.jsxs("span",{className:"text-gray-500 font-mono text-[10px]",children:[p.id.slice(0,8),"â€¦"]})]})]}),C.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-500",children:[C.jsx("span",{children:"Signature:"}),C.jsxs("span",{className:"font-mono truncate text-gray-600",children:[p.signature.slice(0,24),"â€¦"]})]}),C.jsxs("div",{className:"flex items-center justify-between",children:[C.jsxs("div",{className:"text-[11px] text-gray-500",children:["User: ",C.jsx("span",{className:"text-gray-300",children:p.userId})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[!p.approved&&!p.revokedAt&&C.jsxs(C.Fragment,{children:[C.jsx("button",{onClick:()=>c(p.id),className:"rounded-lg border border-emerald-500/60 bg-emerald-500/10 px-3 py-1 text-xs font-medium text-emerald-200 hover:bg-emerald-500/20",children:"Approve"}),C.jsx("button",{onClick:()=>u(p.id),className:"rounded-lg border border-red-500/60 bg-red-500/10 px-3 py-1 text-xs font-medium text-red-300 hover:bg-red-500/20",children:"Reject"})]}),p.approved&&!p.revokedAt&&C.jsx("button",{onClick:()=>u(p.id),className:"rounded-lg border border-amber-500/50 bg-amber-500/10 px-3 py-1 text-xs font-medium text-amber-200 hover:bg-amber-500/20",children:"Revoke"})]})]})]},p.id)};return e?C.jsxs("div",{className:"fixed inset-0 z-[1100] flex items-center justify-center bg-black/75 backdrop-blur-sm",children:[C.jsxs(no.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"relative w-[min(900px,92vw)] max-h-[90vh] overflow-hidden rounded-3xl border border-slate-700/70 bg-slate-950/95 text-gray-100 shadow-2xl",children:[C.jsxs("div",{className:"flex items-start justify-between border-b border-slate-800/60 px-6 py-4",children:[C.jsxs("div",{className:"space-y-1",children:[C.jsxs("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wide text-emerald-300/80",children:[C.jsx(Bn,{size:14})," Consent Playground"]}),C.jsx("div",{className:"text-lg font-semibold text-white",children:"Review & control ethical AI memory"}),C.jsxs("div",{className:"text-[11px] text-gray-500",children:["Pending ",h," Â· Approved ",x," Â· Revoked ",g]})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsxs("button",{onClick:m,disabled:l,className:"flex items-center gap-2 rounded-xl border border-slate-700/60 bg-slate-900/70 px-3 py-2 text-xs text-gray-200 hover:bg-slate-900/90 disabled:opacity-50",children:[C.jsx(to,{size:14,className:l?"animate-pulse":""})," Export Ledger"]}),C.jsx("button",{onClick:()=>s(),disabled:n,className:"rounded-xl border border-slate-700/60 bg-slate-900/70 p-2 text-gray-300 hover:bg-slate-900/90 disabled:opacity-50","aria-label":"Refresh consent ledger",children:C.jsx(eo,{size:15,className:n?"animate-spin":""})}),C.jsx("button",{onClick:()=>i(),className:"rounded-full border border-slate-700/60 bg-slate-900/70 p-2 text-gray-300 hover:bg-slate-900/90","aria-label":"Close consent dashboard",children:C.jsx(ai,{size:16})})]})]}),C.jsxs("div",{className:"flex flex-col gap-4 p-6 overflow-y-auto max-h-[75vh]",children:[C.jsx(lf,{records:t,onApprove:c,onRevoke:u,loading:n}),C.jsx("div",{className:"grid gap-3 sm:grid-cols-[minmax(0,1fr),auto]",children:C.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-400",children:[C.jsx(ci,{size:14}),C.jsx("select",{value:o.type??"all",onChange:p=>void a({type:p.target.value}),className:"rounded-lg border border-slate-700/60 bg-slate-900/70 px-2 py-1 text-gray-200",children:di.map(p=>C.jsx("option",{value:p.value,children:p.label},p.value))}),C.jsx("select",{value:o.status??"all",onChange:p=>void a({status:p.target.value}),className:"rounded-lg border border-slate-700/60 bg-slate-900/70 px-2 py-1 text-gray-200",children:fi.map(p=>C.jsx("option",{value:p.value,children:p.label},p.value))})]})}),r&&C.jsx("div",{className:"rounded-xl border border-red-500/50 bg-red-500/10 px-4 py-2 text-xs text-red-200",children:r}),n?C.jsx("div",{className:"flex items-center justify-center py-12 text-sm text-gray-400",children:"Loading consent ledgerâ€¦"}):t.length===0?C.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 py-16 text-center text-sm text-gray-500",children:[C.jsx(sn,{size:32,className:"text-emerald-400"}),C.jsx("div",{children:"No consent records yet. Run agent actions to populate the ledger."})]}):C.jsx("div",{className:"grid gap-3",children:t.map(w)})]})]}),C.jsx(ui,{})]}):null}export{Pf as ConsentDashboard};
//# sourceMappingURL=ConsentDashboard-C1h6NLba.js.map
