import{r as l,j as e,i as k,b as V,u as W}from"./index-DMKJqC5Z.js";import{u as B}from"./appStore-YdLSx3oj.js";import{i as M}from"./ipc-events-B-mtt1te.js";import{c as A}from"./createLucideIcon-BHoZ2X8H.js";import{C as G}from"./chevron-right-DdIa1t73.js";import{m as T}from"./proxy-B-PlLRqe.js";import{P as q}from"./plus-BEevIG6L.js";import{X as E}from"./x-GAlOzW-g.js";import{G as _}from"./globe-B55P551M.js";import{S as Z}from"./shield-DNuGHzo8.js";import{f as F,L as X,u as U}from"./formatDistanceToNow-CwTn1k5x.js";import{A as J}from"./index-BE3YK0eV.js";import{H as Q,d as K,W as Y}from"./debounce-D_hglKv1.js";import{T as ee}from"./triangle-alert-BHl0FKa7.js";import{B as te}from"./book-open-B5pJVFij.js";import{F as L}from"./file-text-BKQmjIDI.js";import{S as se}from"./send-BMYBEDZg.js";import{S as ae}from"./sparkles-C9aT6jfb.js";import{S as re}from"./search-FaAd99m9.js";import{C as ne}from"./clock-CAio9RVc.js";const le=A("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const ie=A("BookOpenCheck",[["path",{d:"M12 21V7",key:"gj6g52"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3",key:"8arnkb"}]]);const oe=A("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const ce=A("Clock3",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]]);const de=A("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const xe=A("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const me=A("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);const ue=A("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const pe=A("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);const he=A("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const ge=A("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);const be=A("Pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);const fe=A("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const ye=A("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const je=A("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);class ve{balance=1e4;getBalance(){return this.balance}buy(r,s){this.balance-=s*100}sell(r,s){this.balance+=s*100}}function Ne(){const t=new ve,[r,s]=l.useState(t.getBalance()),[i,a]=l.useState([{id:H(),symbol:"AAPL",timeframe:"60"}]),[n,u]=l.useState("AAPL"),[o,j]=l.useState("60"),b=()=>a(c=>[...c,{id:H(),symbol:n,timeframe:o}]),g=c=>a(N=>N.filter(C=>C.id!==c)),v=i.length>=4||i.length>=2?2:1;return e.jsxs("div",{className:"h-full w-full p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("div",{children:["Paper Balance: $",r.toFixed(2)]}),e.jsx("button",{className:"bg-green-600 text-white px-2 py-1 rounded",onClick:()=>{t.buy(n,1),s(t.getBalance())},children:"Buy 1"}),e.jsx("button",{className:"bg-red-600 text-white px-2 py-1 rounded",onClick:()=>{t.sell(n,1),s(t.getBalance())},children:"Sell 1"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("input",{className:"bg-neutral-800 rounded px-2 py-1",value:n,onChange:c=>u(c.target.value.toUpperCase()),placeholder:"Symbol"}),e.jsxs("select",{className:"bg-neutral-800 rounded px-2 py-1",value:o,onChange:c=>j(c.target.value),children:[e.jsx("option",{value:"1",children:"1m"}),e.jsx("option",{value:"5",children:"5m"}),e.jsx("option",{value:"15",children:"15m"}),e.jsx("option",{value:"60",children:"1h"}),e.jsx("option",{value:"240",children:"4h"}),e.jsx("option",{value:"1D",children:"1D"})]}),e.jsx("button",{className:"bg-indigo-600 text-white px-2 py-1 rounded",onClick:b,children:"Add Chart"})]})]}),e.jsx("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${v}, minmax(0, 1fr))`},children:i.map(c=>e.jsxs("div",{className:"relative bg-neutral-800 rounded overflow-hidden",children:[e.jsx("button",{className:"absolute right-2 top-2 text-xs bg-neutral-900/70 px-2 py-1 rounded",onClick:()=>g(c.id),children:"Close"}),e.jsx(we,{symbol:c.symbol,timeframe:c.timeframe})]},c.id))}),e.jsx(Ce,{symbol:n})]})}function we({symbol:t,timeframe:r}){const s=ke(t,r);return e.jsx("iframe",{className:"w-full h-[380px]",src:s,title:`TV-${t}`,referrerPolicy:"no-referrer"})}function ke(t,r){const s=encodeURIComponent(t),i=encodeURIComponent(r);return`https://s.tradingview.com/widgetembed/?frameElementId=tv_embed&symbol=${s}&interval=${i}&hidesidetoolbar=1&symboledit=1&saveimage=0&toolbarbg=rgba(0,0,0,1)&studies=[]&hideideas=1&theme=dark`}function H(){return Math.random().toString(36).slice(2)}function Ce({symbol:t}){return e.jsxs("div",{className:"border border-neutral-800 rounded p-3 text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"AI Helper"}),e.jsxs("div",{className:"text-neutral-300",children:["Suggestions for ",t,": Mock signals and notes. Connect your provider later."]})]})}const Se=[{name:"Chromedino",url:"https://chromedino.com/"},{name:"A Dark Room",url:"https://adarkroom.doublespeakgames.com/"}];function Te(){return e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium",children:"Games"}),e.jsx("ul",{className:"space-y-1 text-sm",children:Se.map(t=>e.jsx("li",{children:e.jsx("a",{className:"text-indigo-400",href:t.url,onClick:r=>{r.preventDefault(),window.api?.tabs?.create?.(t.url)},children:t.name})},t.url))})]})}function Ae({filePath:t,onPageChange:r}){const[s,i]=l.useState(1),[a,n]=l.useState(0),[u,o]=l.useState(1),[j,b]=l.useState(!0),g=l.useRef(null);l.useEffect(()=>{v()},[t]);const v=async()=>{b(!0);try{const f=require("pdfjs-dist");typeof window<"u"&&(f.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${f.version}/pdf.worker.min.js`);const p=await f.getDocument(t).promise;if(n(p.numPages),g.current){const h=await p.getPage(1),d=h.getViewport({scale:u}),m=g.current,y=m.getContext("2d");m.height=d.height,m.width=d.width,await h.render({canvasContext:y,viewport:d}).promise}}catch(f){console.error("Failed to load PDF:",f)}finally{b(!1)}},c=f=>{f>=1&&f<=a&&(i(f),r?.(f))},N=()=>o(Math.min(u+.25,3)),C=()=>o(Math.max(u-.25,.5));return j?e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-900",children:e.jsx("div",{className:"text-gray-400",children:"Loading PDF..."})}):e.jsxs("div",{className:"flex flex-col h-full bg-gray-900",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(s-1),disabled:s===1,className:"p-2 rounded hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(oe,{size:20,className:"text-gray-300"})}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Page ",s," of ",a]}),e.jsx("button",{onClick:()=>c(s+1),disabled:s===a,className:"p-2 rounded hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(G,{size:20,className:"text-gray-300"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:C,className:"p-2 rounded hover:bg-gray-700",children:e.jsx(je,{size:18,className:"text-gray-300"})}),e.jsxs("span",{className:"text-sm text-gray-400 w-16 text-center",children:[Math.round(u*100),"%"]}),e.jsx("button",{onClick:N,className:"p-2 rounded hover:bg-gray-700",children:e.jsx(ye,{size:18,className:"text-gray-300"})}),e.jsx("button",{className:"p-2 rounded hover:bg-gray-700",children:e.jsx(pe,{size:18,className:"text-gray-300"})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto flex items-center justify-center p-4",children:e.jsx(T.canvas,{ref:g,style:{transform:`scale(${u})`,transformOrigin:"center"},className:"border border-gray-700 shadow-lg bg-white",initial:{opacity:0},animate:{opacity:1}})})]})}function Ie({comments:t,onAddComment:r,onDeleteComment:s,currentPage:i}){const[a,n]=l.useState(""),[u,o]=l.useState(!1),j=t.filter(g=>g.page===i),b=()=>{a.trim()&&(r({page:i,x:0,y:0,text:a}),n(""),o(!1))};return e.jsxs("div",{className:"w-80 h-full bg-gray-800 border-l border-gray-700 flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{size:18,className:"text-gray-400"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"Comments"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",j.length,")"]})]}),e.jsx("button",{onClick:()=>o(!u),className:"p-1.5 rounded hover:bg-gray-700",children:e.jsx(q,{size:16,className:"text-gray-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[u&&e.jsxs(T.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsx("textarea",{value:a,onChange:g=>n(g.target.value),placeholder:"Add a comment...",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-sm text-gray-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:b,className:"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded transition-colors",children:"Add"}),e.jsx("button",{onClick:()=>{o(!1),n("")},className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 text-gray-300 text-sm rounded transition-colors",children:"Cancel"})]})]}),j.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-8",children:"No comments on this page"}):e.jsx("div",{className:"flex flex-col gap-3",children:j.map(g=>e.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},className:"p-3 bg-gray-700/30 rounded-lg border border-gray-600/50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["Page ",g.page]}),e.jsx("button",{onClick:()=>s(g.id),className:"p-0.5 rounded hover:bg-gray-600",children:e.jsx(E,{size:12,className:"text-gray-500"})})]}),e.jsx("p",{className:"text-sm text-gray-200",children:g.text})]},g.id))})]})]})}function ze(){const[t,r]=l.useState("list"),[s,i]=l.useState([]),[a,n]=l.useState(null),[u,o]=l.useState(!1),[j,b]=l.useState(null),[g,v]=l.useState("pdf"),[c,N]=l.useState(""),[C,f]=l.useState(null),[x,p]=l.useState(null);l.useEffect(()=>{(async()=>{try{const S=await k.document.list();i(S)}catch(S){console.error("Failed to load document reviews",S)}})()},[]);const h=w=>{n(w),r("review")},d=w=>{b(null),p(null),f(null),N(""),v(w),r("ingest")},m=w=>{const S=w.target.files?.[0]||null;S&&f(S)},y=()=>{r(a?"review":"list"),f(null),b(null)},I=async()=>{try{o(!0),b(null),p(5);let w="",S=g;if(g==="web"){if(!c.trim()){b("Please enter a URL to ingest."),o(!1);return}w=c.trim()}else{if(!C){b("Please choose a file to ingest."),o(!1);return}const $=await C.arrayBuffer();w=Buffer.from($).toString("base64"),S=C.name.toLowerCase().endsWith(".docx")?"docx":"pdf"}p(30);const D=await k.document.ingest(w,S,C?.name||c||void 0);p(90);const R=D;i($=>[R,...$]),n(R),r("review")}catch(w){console.error("Document ingest failed",w),b(w?.message||"Failed to ingest document.")}finally{p(100),setTimeout(()=>p(null),800),o(!1)}},z=async w=>{if(confirm(`Delete "${w.title}"?`))try{await k.document.delete({id:w.id}),i(S=>S.filter(D=>D.id!==w.id)),a?.id===w.id&&(n(null),r("list"))}catch(S){console.error("Failed to delete review",S)}};return e.jsxs("div",{className:"flex h-full bg-[#1A1D28] text-gray-100 overflow-hidden",children:[e.jsx(De,{reviews:s,activeReview:a,onSelectReview:h,onCreate:d}),e.jsxs("main",{className:"flex-1 overflow-y-auto",children:[t==="list"&&e.jsx(Re,{onCreate:d}),t==="ingest"&&e.jsx(Me,{ingestType:g,ingestUrl:c,loading:u,uploadProgress:x,error:j,fileToIngest:C,onTypeChange:v,onUrlChange:N,onFileSelect:m,onSubmit:I,onCancel:y}),t==="review"&&a&&e.jsx(Pe,{review:a,onReverify:async()=>{try{o(!0);const S=await k.document.reverify({id:a.id});n(S),i(D=>D.map(R=>R.id===S.id?S:R))}catch(w){console.error("Reverify failed",w)}finally{o(!1)}},onExport:async(w,S)=>{try{o(!0);const D=window.prompt("Save to path",`~/Documents/${a.title}.${w==="markdown"?"md":"html"}`);if(!D)return;await k.document.export(a.id,w,D,S),alert("Export completed successfully")}catch(D){console.error("Export failed",D),alert("Export failed. Check console for details.")}finally{o(!1)}},onDelete:()=>a&&z(a)})]})]})}function De({reviews:t,activeReview:r,onSelectReview:s,onCreate:i}){return e.jsxs("aside",{className:"w-80 border-r border-gray-800/40 bg-[#161924] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800/40",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Document Review"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Ingest, analyze, and verify documents"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("button",{onClick:()=>i("pdf"),className:"flex items-center justify-center gap-1 rounded border border-indigo-500/40 bg-indigo-500/10 px-2 py-1 text-indigo-200 hover:bg-indigo-500/20",children:[e.jsx(me,{size:12}),"PDF"]}),e.jsxs("button",{onClick:()=>i("docx"),className:"flex items-center justify-center gap-1 rounded border border-purple-500/40 bg-purple-500/10 px-2 py-1 text-purple-200 hover:bg-purple-500/20",children:[e.jsx(de,{size:12}),"DOCX"]}),e.jsxs("button",{onClick:()=>i("web"),className:"flex items-center justify-center gap-1 rounded border border-emerald-500/40 bg-emerald-500/10 px-2 py-1 text-emerald-200 hover:bg-emerald-500/20",children:[e.jsx(_,{size:12}),"Web"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:t.length===0?e.jsx("div",{className:"p-4 text-xs text-gray-500",children:"No documents yet. Ingest a PDF, DOCX, or web article to begin."}):e.jsx("ul",{children:t.map(a=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>s(a),className:`w-full text-left px-4 py-3 border-b border-gray-800/40 hover:bg-gray-800/30 transition-colors ${r?.id===a.id?"bg-gray-800/50":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{className:"uppercase tracking-wide text-[10px] text-gray-500",children:a.type}),e.jsx("span",{children:F(a.updatedAt,{addSuffix:!0})})]}),e.jsx("div",{className:"mt-1 font-medium text-sm text-gray-100 line-clamp-2",children:a.title}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:[a.sections.length," sections â€¢ ",a.claims.length," claims"]})]})},a.id))})})]})}function Re({onCreate:t}){return e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-4 text-center text-sm text-gray-400",children:[e.jsx("div",{className:"rounded-full border border-dashed border-gray-700/60 bg-gray-800/30 p-6",children:e.jsx(Z,{size:48,className:"text-purple-400"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-100",children:"Start your first review"}),e.jsx("p",{children:"Upload a PDF/DOCX or ingest a web article to analyze claims, entities, and timelines."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>t("pdf"),className:"rounded bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-indigo-500 transition-colors",children:"Upload document"}),e.jsx("button",{onClick:()=>t("web"),className:"rounded border border-gray-700 px-4 py-2 text-sm font-medium text-gray-200 hover:border-gray-600",children:"Ingest web page"})]})]})}function Me({ingestType:t,ingestUrl:r,loading:s,uploadProgress:i,error:a,fileToIngest:n,onTypeChange:u,onUrlChange:o,onFileSelect:j,onSubmit:b,onCancel:g}){return e.jsxs("div",{className:"flex max-w-3xl flex-col gap-6 px-10 py-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-100",children:"Ingest document"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Ingest a file or web article to analyze claims and generate verification reports."})]}),e.jsx("button",{onClick:g,className:"rounded-full border border-gray-700 bg-gray-800/40 p-2 text-gray-400 hover:bg-gray-800/60",children:e.jsx(E,{size:16})})]}),e.jsxs("div",{className:"rounded border border-gray-800/60 bg-gray-900/40 p-6",children:[e.jsx("label",{className:"mb-3 block text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Source type"}),e.jsx("div",{className:"flex gap-3",children:["pdf","docx","web"].map(v=>e.jsx("button",{onClick:()=>u(v),className:`rounded-lg border px-3 py-2 text-sm capitalize transition-colors ${t===v?"border-purple-500/50 bg-purple-500/10 text-purple-200":"border-gray-700/50 bg-gray-800/40 text-gray-300 hover:border-gray-600"}`,children:v},v))})]}),t==="web"?e.jsxs("div",{className:"rounded border border-gray-800/60 bg-gray-900/40 p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Web URL"}),e.jsx("input",{type:"url",value:r,onChange:v=>o(v.target.value),placeholder:"https://example.com/article",className:"mt-2 w-full rounded border border-gray-700 bg-gray-800 px-3 py-2 text-sm text-gray-200 focus:outline-none focus:ring-2 focus:ring-purple-500"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"OmniBrowser will fetch the article, strip boilerplate, and analyze claims."})]}):e.jsxs("div",{className:"rounded border border-dashed border-gray-700 bg-gray-900/30 p-6 text-center",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:["Upload ",t.toUpperCase()," file"]}),e.jsx("input",{type:"file",accept:".pdf,.docx",onChange:j,className:"mx-auto block text-sm text-gray-300"}),n&&e.jsxs("p",{className:"mt-3 text-xs text-gray-400",children:["Selected: ",n.name," (",Math.round(n.size/1024)," KB)"]})]}),a&&e.jsx("div",{className:"rounded border border-red-500/40 bg-red-500/10 px-4 py-2 text-xs text-red-200",children:a}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:b,disabled:s,className:"rounded bg-purple-600 px-4 py-2 text-sm font-medium text-white shadow hover:bg-purple-500 disabled:opacity-50",children:s?"Processingâ€¦":"Ingest"}),e.jsx("button",{onClick:g,className:"rounded border border-gray-700 px-4 py-2 text-sm text-gray-300 hover:border-gray-600",children:"Cancel"}),i!==null&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx(X,{size:14,className:"animate-spin text-purple-400"}),e.jsxs("span",{children:["Progress ",i,"%"]})]})]})]})}function Pe({review:t,onReverify:r,onExport:s,onDelete:i}){const[a,n]=l.useState(null),[u,o]=l.useState(!0),[j,b]=l.useState([]),[g,v]=l.useState(null);l.useEffect(()=>{t.type==="pdf"?v(`omnibrowser://document/${t.id}`):v(null)},[t]);const c=t.timeline??[],N=t.factHighlights??[],C=t.assumptions??[],f=t.auditTrail??[],x=l.useMemo(()=>t.entityGraph?t.entityGraph:t.entities.map(d=>({name:d.name,count:d.occurrences.length,type:d.type,connections:t.claims.filter(m=>m.text.toLowerCase().includes(d.name.toLowerCase())).slice(0,3).map(m=>m.id)})),[t.entityGraph,t.entities,t.claims]),p=l.useMemo(()=>Ee(N,t.sections),[N,t.sections]),h=l.useMemo(()=>{const d=t.claims.length,m=t.claims.filter(z=>z.verification.status==="verified").length,y=t.claims.filter(z=>z.verification.status==="disputed").length,I=d-m-y;return{total:d,verified:m,disputed:y,unverified:I}},[t.claims]);return l.useEffect(()=>{if(!a)return;const d=document.getElementById(`highlight-${a}`);if(d){d.scrollIntoView({behavior:"smooth",block:"center"}),d.classList.add("ring-2","ring-purple-400","ring-offset-1","ring-offset-[#1A1D28]");const m=window.setTimeout(()=>{d.classList.remove("ring-2","ring-purple-400","ring-offset-1","ring-offset-[#1A1D28]")},1800);return()=>window.clearTimeout(m)}},[a]),e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("header",{className:"flex items-start justify-between border-b border-gray-800/40 bg-gray-900/40 px-8 py-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-100",children:t.title}),e.jsxs("div",{className:"text-xs uppercase tracking-wide text-gray-500",children:[t.type.toUpperCase()," â€¢ ",t.sections.length," sections â€¢ ",t.entities.length," entities â€¢ ",t.claims.length," claims"]}),e.jsxs("div",{className:"flex gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["Created ",F(t.createdAt,{addSuffix:!0})]}),e.jsxs("span",{children:["Updated ",F(t.updatedAt,{addSuffix:!0})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r,className:"rounded border border-purple-500/50 bg-purple-500/10 px-3 py-2 text-xs font-medium text-purple-200 hover:bg-purple-500/20",children:"Re-run verification"}),e.jsx("button",{onClick:()=>s("markdown","apa"),className:"rounded border border-gray-700 px-3 py-2 text-xs text-gray-300 hover:border-gray-500",children:"Export Markdown"}),e.jsx("button",{onClick:()=>s("html","apa"),className:"rounded border border-gray-700 px-3 py-2 text-xs text-gray-300 hover:border-gray-500",children:"Export HTML"}),e.jsx("button",{onClick:i,className:"rounded border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs font-medium text-red-300 hover:bg-red-500/20",children:"Delete"})]})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("aside",{className:"w-72 border-r border-gray-800/40 bg-[#181C27] overflow-y-auto",children:[e.jsxs("section",{className:"border-b border-gray-800/40 p-4",children:[e.jsx("span",{className:"block text-xs uppercase tracking-wide text-gray-500",children:"Verification summary"}),e.jsxs("div",{className:"mt-3 space-y-2 text-xs",children:[e.jsx(P,{label:"Total claims",value:h.total}),e.jsx(P,{label:"Verified",value:h.verified,tone:"success"}),e.jsx(P,{label:"Disputed",value:h.disputed,tone:"warning"}),e.jsx(P,{label:"Unverified",value:h.unverified,tone:"neutral"})]})]}),N.length>0&&e.jsx(Le,{highlights:N,selectedId:a,onSelect:n}),C.length>0&&e.jsx(He,{assumptions:C,onSelect:n}),e.jsx(Be,{graph:x,onSelect:n}),e.jsx(Oe,{timeline:c})]}),e.jsxs("section",{className:"flex-1 overflow-y-auto",children:[e.jsx("article",{className:"space-y-6 p-8",children:t.sections.map((d,m)=>{const y=p.get(d.title)??[],I=Math.max(2,4-Math.min(d.level,3));return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`font-semibold text-gray-100 text-${I}xl`,children:d.title}),e.jsx("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-wrap",children:Fe(d,y,a)})]},d.title+m)})}),f.length>0&&e.jsx(Ve,{auditTrail:f,onSelect:n})]}),e.jsxs("aside",{className:"w-96 border-l border-gray-800/40 bg-[#181C27] flex flex-col",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-gray-800/40 px-5 py-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-100",children:"Claim verification"}),e.jsx("button",{onClick:()=>o(!u),className:"text-xs text-gray-400 hover:text-gray-200",children:u?"Hide comments":"Show comments"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("ul",{className:"divide-y divide-gray-800/40",children:t.claims.map(d=>e.jsxs(T.li,{layout:!0,className:`cursor-pointer px-5 py-4 hover:bg-gray-800/30 transition-colors ${a===d.id?"bg-gray-800/50":""}`,onClick:()=>n(d.id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-500",children:"Claim"}),e.jsx(O,{status:d.verification.status})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-200 leading-relaxed line-clamp-3",children:d.text}),e.jsxs("div",{className:"mt-2 text-[11px] text-gray-500",children:["Confidence ",(d.verification.confidence*100).toFixed(0),"% â€¢ ",d.section||"Unknown section"]}),e.jsx("div",{className:"mt-3 space-y-1",children:d.verification.sources.slice(0,3).map((m,y)=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-400",children:[e.jsx("span",{className:m.supports?"text-emerald-400":"text-amber-400",children:m.supports?"Supports":"Disputes"}),e.jsx("span",{className:"line-clamp-1",children:m.title})]},`${d.id}-src-${y}`))})]},d.id))})}),u&&e.jsx(Ie,{comments:j,onAddComment:d=>{b(m=>[...m,{id:`comment_${Date.now()}`,createdAt:Date.now(),...d}])},onDeleteComment:d=>b(m=>m.filter(y=>y.id!==d)),currentPage:1})]})]}),g&&e.jsx(J,{children:e.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-6 z-50 overflow-hidden rounded-xl border border-gray-700/70 bg-[#0F131F]/95 shadow-2xl backdrop-blur",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-gray-800/60 px-4 py-2 text-sm text-gray-300",children:[e.jsx("span",{children:"Document viewer"}),e.jsx("button",{onClick:()=>v(null),className:"rounded-full border border-gray-700 bg-gray-800/50 p-1 text-gray-400 hover:bg-gray-800/70",children:e.jsx(E,{size:14})})]}),e.jsx(Ae,{filePath:g,onPageChange:()=>{}})]},"pdf")})]})}function Ee(t,r){const s=new Map;return t.length===0||t.forEach(i=>{const n=(r.find(o=>i.position>=o.startPosition&&i.position<o.endPosition)||r.find(o=>o.title===i.section))?.title||i.section||"Document",u=s.get(n)??[];u.push(i),s.set(n,u)}),s}const $e={verified:"bg-emerald-500/20 text-emerald-100 border border-emerald-500/30",disputed:"bg-amber-500/20 text-amber-100 border border-amber-500/30",unverified:"bg-slate-500/20 text-slate-100 border border-slate-500/30"};function Fe(t,r,s){if(r.length===0)return t.content.trim();const i=t.content,a=i.toLowerCase(),n=[...r].sort((j,b)=>j.position-b.position),u=[];let o=0;return n.forEach(j=>{const b=j.text.trim();if(!b)return;const g=b.toLowerCase();let v=a.indexOf(g,o);if(v===-1&&(v=a.indexOf(g,0),v===-1))return;v>o&&u.push(i.slice(o,v));const c=i.slice(v,v+b.length);u.push(e.jsx("mark",{id:`highlight-${j.claimId}`,className:`rounded px-1 ${$e[j.importance]} ${s===j.claimId?"ring-2 ring-purple-400 ring-offset-1 ring-offset-[#1A1D28]":""}`,children:c},`${j.claimId}-${v}`)),o=v+b.length}),o<i.length&&u.push(i.slice(o)),u}function Le({highlights:t,selectedId:r,onSelect:s}){const i=[...t].sort((a,n)=>{const u={verified:0,disputed:1,unverified:2};return u[a.importance]-u[n.importance]});return e.jsxs("section",{className:"border-b border-gray-800/40 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-200",children:[e.jsx(Q,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Fact highlights"})]}),e.jsx("ul",{className:"space-y-2 text-xs",children:i.map(a=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>s(a.claimId),className:`w-full rounded border px-2 py-2 text-left transition-colors ${r===a.claimId?"border-purple-500/40 bg-purple-500/10 text-purple-100":"border-emerald-500/30 bg-emerald-500/5 text-emerald-100 hover:bg-emerald-500/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-semibold",children:a.section||"Document"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:a.importance})]}),e.jsx("p",{className:"mt-1 text-[11px] text-emerald-100/90 line-clamp-3",children:a.text})]})},a.claimId))})]})}const Ue={low:"border-sky-500/30 bg-sky-500/5 text-sky-100",medium:"border-amber-500/30 bg-amber-500/10 text-amber-100",high:"border-red-500/40 bg-red-500/10 text-red-100"};function He({assumptions:t,onSelect:r}){return e.jsxs("section",{className:"border-b border-gray-800/40 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-200",children:[e.jsx(ee,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Assumptions & gaps"})]}),e.jsx("ul",{className:"space-y-2 text-xs",children:t.map(s=>e.jsx("li",{children:e.jsxs("button",{onClick:()=>r(s.claimId),className:`w-full rounded border px-2 py-2 text-left ${Ue[s.severity]} hover:opacity-90 transition-opacity`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.section||"Document"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:s.severity})]}),e.jsx("p",{className:"mt-1 text-[11px] opacity-90",children:s.text}),e.jsx("p",{className:"mt-1 text-[10px] opacity-70",children:s.rationale})]})},s.claimId))})]})}function Be({graph:t,onSelect:r}){return e.jsxs("section",{className:"border-b border-gray-800/40 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-200",children:[e.jsx(ue,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Entity graph"})]}),e.jsx("ul",{className:"space-y-2 text-xs text-gray-300",children:t.slice(0,12).map(s=>e.jsxs("li",{className:"rounded border border-blue-500/30 bg-blue-500/5 px-2 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-semibold text-blue-100",children:s.name}),e.jsxs("span",{className:"text-[10px] uppercase tracking-wide text-blue-200",children:[s.type," â€¢ ",s.count]})]}),s.connections.length>0&&e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:s.connections.map(i=>e.jsx("button",{onClick:()=>r(i),className:"rounded-full border border-blue-500/30 px-2 py-0.5 text-[10px] text-blue-100 hover:bg-blue-500/20",children:"Jump to claim"},i))})]},s.name))})]})}function Oe({timeline:t}){return e.jsxs("section",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(ce,{size:14}),e.jsx("span",{className:"text-xs uppercase tracking-wide",children:"Timeline events"})]}),t.length===0?e.jsx("div",{className:"text-xs text-gray-500",children:"No events detected."}):e.jsx("ul",{className:"space-y-3 text-xs text-gray-300",children:t.map((r,s)=>e.jsxs("li",{className:"relative pl-4",children:[e.jsx("span",{className:"absolute left-0 top-1 h-2 w-2 rounded-full bg-purple-400"}),e.jsx("div",{className:"font-semibold text-gray-200",children:r.date}),e.jsx("div",{className:"text-[11px] text-gray-400",children:r.description})]},`${r.date}-${s}`))})]})}function Ve({auditTrail:t,onSelect:r}){return e.jsx("section",{className:"px-8 pb-8",children:e.jsxs("div",{className:"rounded border border-gray-800 bg-neutral-900/40",children:[e.jsxs("header",{className:"flex items-center justify-between border-b border-gray-800 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-200",children:[e.jsx(ie,{size:16}),e.jsx("h3",{className:"text-sm font-semibold",children:"Audit trail"})]}),e.jsx("span",{className:"text-[11px] text-gray-500",children:"Linked to source evidence"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-800 text-xs text-gray-300",children:[e.jsx("thead",{className:"bg-neutral-900/80 text-[11px] uppercase tracking-wide text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Claim"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Location"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Source"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-800",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-neutral-800/40",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsxs("button",{className:"text-indigo-200 hover:text-indigo-100",onClick:()=>r(s.claimId),children:["Claim ",s.claimId.split("_").pop()]})}),e.jsxs("td",{className:"px-3 py-2 text-[11px] text-gray-400",children:[s.section||"â€”",s.page!==void 0&&e.jsxs("span",{className:"ml-1",children:["â€¢ p.",s.page]}),s.line!==void 0&&e.jsxs("span",{className:"ml-1",children:["â€¢ line ",s.line]})]}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(O,{status:s.status})}),e.jsx("td",{className:"px-3 py-2 text-[11px] text-gray-400",children:s.link?e.jsx("a",{href:s.link,target:"_blank",rel:"noreferrer",className:"text-indigo-300 hover:text-indigo-100",children:"Open source"}):"â€”"})]},s.claimId))})]})})]})})}function P({label:t,value:r,tone:s="neutral"}){const i=s==="success"?"text-emerald-300":s==="warning"?"text-amber-300":"text-gray-300";return e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{children:t}),e.jsx("span",{className:`font-semibold ${i}`,children:r})]})}function O({status:t}){const r=t==="verified"?"bg-emerald-500/10 text-emerald-200 border-emerald-500/30":t==="disputed"?"bg-amber-500/10 text-amber-200 border-amber-500/30":"bg-gray-500/10 text-gray-300 border-gray-500/30";return e.jsx("span",{className:`rounded-full border px-2 py-0.5 text-[10px] uppercase tracking-wide ${r}`,children:t})}class We{generate(r){const s=encodeURIComponent(r||"omni");return[`https://picsum.photos/seed/${s}-1/512/384`,`https://picsum.photos/seed/${s}-2/512/384`,`https://picsum.photos/seed/${s}-3/512/384`]}}function Ge(){const t=new We,[r,s]=l.useState("a scenic mountain"),[i,a]=l.useState([]);return e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("form",{onSubmit:n=>{n.preventDefault(),a(t.generate(r))},children:e.jsx("input",{className:"w-full bg-neutral-800 rounded px-3 py-2 text-sm",value:r,onChange:n=>s(n.target.value)})}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:i.map((n,u)=>e.jsx("div",{className:"bg-neutral-800 h-32 flex items-center justify-center text-xs",children:n},u))})]})}function qe(){const[t,r]=l.useState(""),[s,i]=l.useState(null);return e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("form",{onSubmit:async a=>{a.preventDefault();const n=await window.api?.threats?.scanUrl?.(t);i(n)},children:e.jsx("input",{className:"w-full bg-neutral-800 rounded px-3 py-2 text-sm",value:t,onChange:a=>r(a.target.value),placeholder:"Enter URL"})}),s&&e.jsx("pre",{className:"text-xs bg-neutral-900 p-2 rounded overflow-auto",children:JSON.stringify(s,null,2)})]})}function _e(){const[t,r]=l.useState([]),[s,i]=l.useState([]);return l.useEffect(()=>{(async()=>{const a=await window.api?.graph?.all?.();a&&(r(a.nodes),i(a.edges))})()},[]),l.useEffect(()=>{const a=async n=>{const u=window.graph;if(u&&n?.nodes){for(const j of n.nodes)await u.add(j,[]);n.edges?.length&&await u.add({key:n.nodes[0]?.key||"tmp"},n.edges)}const o=await window.api?.graph?.all?.();o&&(r(o.nodes),i(o.edges))};window.graph?.onAuto?.(a)},[]),e.jsxs("div",{className:"h-full w-full p-3",children:[e.jsx("h3",{className:"font-medium mb-2",children:"GraphMind"}),e.jsxs("div",{className:"text-xs text-neutral-300 mb-2",children:["Nodes: ",t.length," Â· Edges: ",s.length]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 text-sm",children:t.map(a=>e.jsxs("div",{className:"border border-neutral-800 rounded p-2",children:[e.jsx("div",{className:"font-medium",children:a.title||a.key}),e.jsx("div",{className:"text-neutral-400",children:a.type})]},a.key))})]})}function Ze(){const{activeId:t,tabs:r}=U(),s=l.useRef(null),[i,a]=l.useState(()=>r.length>0),[n,u]=l.useState(""),[o,j]=l.useState(""),[b,g]=l.useState(!1),[v,c]=l.useState(0),N=l.useMemo(()=>typeof window<"u"&&!!window.electron,[]),C=l.useMemo(()=>V(),[]),f=l.useMemo(()=>{if(!n)return!1;try{const x=new URL(n,n.startsWith("http")?void 0:"https://localhost");return x.protocol==="http:"||x.protocol==="https:"}catch{return!1}},[n]);return l.useEffect(()=>{if(!s.current||!t)return;const x=()=>{s.current};x();const p=()=>{x()};window.addEventListener("resize",p);const h=new ResizeObserver(x);return s.current&&h.observe(s.current),()=>{window.removeEventListener("resize",p),h.disconnect()}},[t,r]),l.useEffect(()=>{const x=m=>{if(!Array.isArray(m))return;const y=m.find(I=>I.id===t);if(y)u(y.url||""),j(y.title||"New Tab"),a(!0),g(!1);else if(m.length>0){a(!0),g(!1);const I=m[0];I&&(u(I.url||""),j(I.title||"New Tab"))}else m.length===0&&(a(!1),g(!1),u(""),j(""))},p=M.on("tabs:updated",x),h=M.on("tabs:progress",m=>{(m.tabId===t||!m.tabId)&&(c(m.progress),g(m.progress>0&&m.progress<100),(m.progress>0||m.progress===100)&&a(!0))}),d=async()=>{try{(!window.ipc||typeof window.ipc.invoke!="function")&&await new Promise(y=>setTimeout(y,500));const m=await k.tabs.list();Array.isArray(m)&&m.length>0?(x(m),a(!0),g(!1)):r.length>0&&(a(!0),g(!1))}catch{r.length>0&&t&&(a(!0),g(!1))}};return setTimeout(()=>{d()},300),()=>{p(),h()}},[t]),l.useEffect(()=>{if(!t)return;const x=setInterval(async()=>{try{const h=(await k.tabs.list()).find(d=>d.id===t);h&&(h.title!==o&&j(h.title||"New Tab"),h.url!==n&&u(h.url||""))}catch{}},500);return()=>clearInterval(x)},[t,o,n]),l.useEffect(()=>{r.length>0?(a(!0),g(!1)):(a(!1),g(!1))},[r.length]),e.jsxs("div",{ref:s,className:"flex-1 relative bg-white overflow-hidden w-full",children:[e.jsx("div",{id:"browser-view-container",style:{position:"absolute",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:0}}),!N&&f&&e.jsx("iframe",{src:n,title:o||n,className:"absolute inset-0 h-full w-full border-0",style:{zIndex:1,pointerEvents:"auto"},sandbox:"allow-scripts allow-same-origin allow-forms allow-popups"},n),!N&&!f&&n&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-3 bg-white/95 px-6 text-center text-sm text-gray-600",style:{zIndex:1},children:[e.jsx("span",{className:"text-base font-medium text-gray-800",children:"Preview unavailable for this URL"}),e.jsx("p",{children:"The current site cannot be embedded in a web preview. Open OmniBrowser desktop or copy the link below to view it."}),e.jsx("code",{className:"max-w-full break-all rounded bg-gray-100 px-3 py-1 text-xs text-gray-700",children:n})]}),b&&t&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gray-200 z-50 pointer-events-none",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${v}%`}})}),(!t||r.length===0)&&e.jsx("div",{className:"absolute inset-0 h-full w-full flex items-center justify-center bg-white",style:{zIndex:2,pointerEvents:"auto"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:"ðŸŒ"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"OmniBrowser"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Enter a URL or search to get started"})]})}),r.length===0&&!i&&e.jsx("div",{className:"absolute inset-0 h-full w-full flex items-center justify-center bg-white transition-opacity duration-300",style:{zIndex:2,pointerEvents:"none"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:"ðŸŒ"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"OmniBrowser"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Initializing..."})]})}),C&&n&&t&&e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded opacity-50 hover:opacity-100 transition-opacity z-50 pointer-events-none",children:[o," - ",n]})]})}function Xe(){const{activeId:t}=U(),[r,s]=l.useState(""),[i,a]=l.useState(""),[n,u]=l.useState([]),[o,j]=l.useState(""),[b,g]=l.useState(null),v=l.useRef(null);l.useEffect(()=>{const x=async()=>{if(!t){s(""),j(""),a(""),u([]);return}try{const d=(await k.tabs.list()).find(y=>y.id===t);if(!d?.url){s(""),j("");return}const m=d.url;if(j(m),m.startsWith("about:")||m.startsWith("chrome:")){s(""),a(""),u([]);return}try{const y=await k.research.getNotes(m);if(y)if(a(y.notes||""),Array.isArray(y.highlights)){const I=y.highlights.map(z=>({id:z.id||(crypto.randomUUID?.()??`hl-${Date.now()}`),text:z.text||"",color:z.color||"#facc15",createdAt:z.createdAt||Date.now(),note:z.note}));u(I)}else u([])}catch(y){console.error("Failed to load notes:",y)}s("Extracting readable content...");try{const y=await k.research.extractContent(t);y?.html?s(y.html):y?.content?s(`<div class="prose prose-invert"><h1>${y.title||m}</h1><p>${y.content}</p></div>`):s("")}catch(y){console.error("Failed to extract content:",y),s("")}}catch(h){console.error("Failed to load research content:",h),s("")}};x();const p=()=>{x()};if(window.ipc?.on)return window.ipc.on("tabs:updated",p),()=>{window.ipc?.removeListener&&window.ipc.removeListener("tabs:updated",p)}},[t]);const c=l.useRef(K(async(x,p,h)=>{if(!(!x||x.startsWith("about:")||x.startsWith("chrome:")))try{await k.research.saveNotes(x,p,h),console.log("Auto-saved notes for",x)}catch(d){console.error("Failed to save notes:",d)}},1e3)).current;l.useEffect(()=>{o&&(i||n.length>0)&&c(o,i,n)},[i,n,o,c]),l.useEffect(()=>M.on("research:highlight-added",p=>{!p?.url||p.url!==o||u(h=>[...h,{id:p.highlight.id,text:p.highlight.text,color:p.highlight.color||"#facc15",createdAt:p.highlight.createdAt||Date.now(),note:p.highlight.note}])}),[o]);const N=(x,p)=>{u(h=>h.map(d=>d.id===x?{...d,note:p}:d))},C=l.useMemo(()=>[...n].sort((x,p)=>(p.createdAt??0)-(x.createdAt??0)),[n]),f=async x=>{if(!o||o.startsWith("about:")||o.startsWith("chrome:"))return;const p=c?.flush;typeof p=="function"&&p();try{await k.research.saveNotes(o,i,n)}catch(h){console.error("Failed to sync notes before export:",h)}g(x);try{const h=await k.research.export(x,[o],!0);if(h?.format==="markdown"&&h?.path)alert(`Markdown exported to ${h.path}`);else if(h?.format==="obsidian"&&h?.folder)alert(`Obsidian vault files saved to ${h.folder}`);else if(h?.format==="notion"&&Array.isArray(h?.notionPages)){const d=h.notionPages.map(m=>m?.url?`â€¢ ${m.title||"Untitled"}
  ${m.url}`:`â€¢ ${m.title||"Untitled"}`).join(`
`);alert(`Synced to Notion:
${d}`)}else alert("Export completed.")}catch(h){console.error("Failed to export:",h);const d=h instanceof Error?h.message:"Failed to export";alert(d)}finally{g(null)}};return e.jsxs("div",{className:"h-full flex",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-700/30 bg-gray-950 overflow-hidden",children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-800/50 bg-gray-900/50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16,className:"text-blue-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Reader"})]})}),e.jsx("div",{ref:v,className:"flex-1 overflow-y-auto p-6 prose prose-invert max-w-none",style:{color:"#e5e7eb"},children:r?e.jsx("div",{className:"text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:r}}):e.jsxs("div",{className:"text-center text-gray-500 py-12",children:[e.jsx(L,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No readable content available"}),e.jsx("p",{className:"text-xs mt-2",children:"Navigate to a page to extract content"})]})})]}),e.jsxs("div",{className:"w-80 flex flex-col border-l border-gray-700/30 bg-gray-900/50 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Notes"})]}),o&&e.jsx(T.span,{className:"text-xs text-gray-500 px-2 py-0.5 bg-gray-800/40 rounded",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},children:"Auto-saving..."})]}),C.length>0&&e.jsxs("div",{className:"border-b border-gray-800/50 p-3 space-y-3 max-h-52 overflow-y-auto",children:[e.jsxs("div",{className:"text-xs font-semibold text-gray-400 mb-1 flex items-center gap-2",children:[e.jsx(ge,{size:12}),"Highlights & notes"]}),C.map(x=>e.jsxs("div",{className:"bg-gray-800/30 rounded-lg border border-gray-800/60 p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"px-2 py-1 rounded-md text-xs font-medium max-w-xs truncate",style:{backgroundColor:`${x.color}20`,color:x.color},title:x.text,children:[x.text.slice(0,120),x.text.length>120?"â€¦":""]}),e.jsx("button",{onClick:()=>u(p=>p.filter(h=>h.id!==x.id)),className:"p-1 rounded-lg text-gray-500 hover:text-gray-300 hover:bg-gray-800/50 transition-colors","aria-label":"Remove highlight",children:e.jsx(E,{size:12})})]}),e.jsx("textarea",{value:x.note??"",onChange:p=>N(x.id,p.target.value),placeholder:"Add a note for this highlight...",className:"w-full text-xs bg-gray-900/40 border border-gray-800/60 rounded-md px-2 py-1.5 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-emerald-500/60",rows:2}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["Saved ",new Date(x.createdAt).toLocaleString()]})]},x.id))]}),e.jsx("textarea",{value:i,onChange:x=>a(x.target.value),placeholder:"Take notes, add insights, save findings...",className:"flex-1 p-4 bg-transparent text-sm text-gray-300 placeholder-gray-600 resize-none focus:outline-none"}),e.jsxs("div",{className:"border-t border-gray-800/50 p-3 flex items-center gap-2",children:[e.jsxs(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:async()=>{if(o&&!o.startsWith("about:")&&!o.startsWith("chrome:")){c.flush();try{await k.research.saveNotes(o,i,n)}catch(x){console.error("Failed to save notes:",x)}}},className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-600/20 hover:bg-blue-600/30 border border-blue-500/30 rounded text-xs text-blue-400 transition-colors",children:[e.jsx(fe,{size:14}),"Save"]}),e.jsxs(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:!!b,onClick:()=>f("markdown"),className:`px-3 py-2 bg-green-600/20 hover:bg-green-600/30 border border-green-500/30 rounded text-xs text-green-400 transition-colors flex items-center gap-2 ${b?"opacity-60 cursor-wait":""}`,title:"Export to Markdown",children:[e.jsx(xe,{size:14}),b==="markdown"?"Exportingâ€¦":"Export Markdown"]}),e.jsxs(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:!!b,onClick:()=>f("obsidian"),className:`px-3 py-2 bg-purple-600/20 hover:bg-purple-600/30 border border-purple-500/30 rounded text-xs text-purple-300 transition-colors flex items-center gap-2 ${b?"opacity-60 cursor-wait":""}`,title:"Export notes and highlights to Obsidian-compatible markdown files",children:[e.jsx(le,{size:14}),b==="obsidian"?"Exportingâ€¦":"Obsidian Export"]}),e.jsxs(T.button,{whileHover:{scale:1.05},whileTap:{scale:.95},disabled:!!b,onClick:()=>f("notion"),className:`px-3 py-2 bg-emerald-600/20 hover:bg-emerald-600/30 border border-emerald-500/30 rounded text-xs text-emerald-300 transition-colors flex items-center gap-2 ${b?"opacity-60 cursor-wait":""}`,title:"Sync notes and highlights to Notion",children:[e.jsx(se,{size:14}),b==="notion"?"Exportingâ€¦":"Sync to Notion"]})]})]})]})}function Je(){const{tabs:t,activeId:r}=U(),{setMode:s}=B(),i=W(),[a,n]=l.useState([]),[u,o]=l.useState([]);l.useEffect(()=>{const c=async()=>{if(!window.ipc||typeof window.ipc.invoke!="function"){setTimeout(c,500);return}try{const f=(await k.workspaceV2.list())?.workspaces||[];n(f.slice(0,3))}catch{}try{const x=(await k.sessions.list()||[]).slice(0,2).map(p=>({id:p.id,type:p.name?.includes("Research")?"Research":p.name?.includes("Trade")?"Trade":"Browse",title:p.name||"Untitled Session",url:"about:blank",timestamp:p.createdAt||Date.now()-36e5,sessionId:p.id}));x.length>0?o(x):o([{type:"Research",title:"Quantum Computing Research",url:"about:blank",timestamp:Date.now()-36e5},{type:"Trade",title:"Market Analysis",url:"about:blank",timestamp:Date.now()-72e5}])}catch{o([{type:"Research",title:"Quantum Computing Research",url:"about:blank",timestamp:Date.now()-36e5},{type:"Trade",title:"Market Analysis",url:"about:blank",timestamp:Date.now()-72e5}])}};setTimeout(()=>{c()},400);const N=M.on("workspace:updated",()=>{c()});return()=>{N()}},[]);const j=[{icon:ae,label:"Ask Agent",action:async()=>{i("/agent")},color:"from-blue-500 to-cyan-500",description:"Open the agent console to start a guided workflow."},{icon:re,label:"Search Topic",action:async()=>{s("Research"),await k.tabs.create("about:blank")},color:"from-purple-500 to-pink-500",description:"Launch AI-powered research with citations-first results."},{icon:L,label:"Research Notes",action:async()=>{s("Research"),await k.tabs.create("about:blank")},color:"from-green-500 to-emerald-500",description:"Capture structured notes that sync with your highlights."},{icon:Y,label:"Run Playbook",action:()=>{i("/playbooks")},color:"from-orange-500 to-red-500",description:"Automate multi-step workflows with reusable recipes."}],b=async c=>{try{let N=c.url||"about:blank";if(c.sessionId)try{await k.sessions.setActive({sessionId:c.sessionId}),await new Promise(x=>setTimeout(x,200));const f=await k.tabs.list();if(f.length>0){!f.find(p=>p.active)&&f[0]&&await k.tabs.activate({id:f[0].id});return}(!N||N==="about:blank")&&(N="about:blank")}catch(f){console.warn("Failed to set active session:",f)}if(c.type==="Research"?s("Research"):c.type==="Trade"&&s("Trade"),!await k.tabs.create(N))throw new Error("Failed to create tab");await new Promise(f=>setTimeout(f,100))}catch(N){console.error("Failed to continue session:",N);try{await k.tabs.create("about:blank")}catch(C){console.error("Failed to create fallback tab:",C)}}},g=t.find(c=>c.id===r);return t.length===0||!g||!g.url||g.url==="about:blank"||g.url.startsWith("ob://newtab")||g.url.startsWith("ob://home")?e.jsx("div",{className:"absolute inset-0 h-full w-full bg-gradient-to-br from-[#1A1D28] via-[#1F2332] to-[#1A1D28] flex items-center justify-center p-8 overflow-auto z-10",children:e.jsxs("div",{className:"max-w-5xl w-full space-y-8",children:[e.jsxs(T.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-10 space-y-3 text-left",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500",children:"Command Center"}),e.jsx("h1",{className:"text-4xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400",children:"OmniBrowser"}),e.jsx("p",{className:"max-w-2xl text-sm text-gray-400",children:"Launch an agentic workspace, resume a saved session, or jump straight into a trusted playbook."})]}),e.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-4",children:j.map(c=>{const N=c.icon;return e.jsxs(T.button,{onClick:c.action,whileHover:{y:-2},whileTap:{scale:.97},className:"group flex h-full flex-col items-start gap-3 rounded-xl border border-gray-700/50 bg-gray-800/60 px-4 py-5 text-left transition-all hover:border-gray-600 hover:bg-gray-800/80 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 focus-visible:ring-offset-gray-900",children:[e.jsx("span",{className:`inline-flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br ${c.color} text-white shadow-lg shadow-black/20`,children:e.jsx(N,{className:"h-5 w-5"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-100 group-hover:text-white transition-colors",children:c.label}),c.description?e.jsx("p",{className:"text-xs leading-snug text-gray-500 group-hover:text-gray-300 transition-colors",children:c.description}):null]})]},c.label)})}),u.length>0&&e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"space-y-2",children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(ne,{size:16}),"Continue Last Session"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:u.map((c,N)=>e.jsxs(T.button,{onClick:()=>b(c),whileHover:{scale:1.02,x:4},className:"p-4 rounded-lg bg-gray-800/50 border border-gray-700/50 hover:border-gray-600 transition-all text-left group cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${c.type==="Research"?"bg-purple-500/20 text-purple-400":c.type==="Trade"?"bg-green-500/20 text-green-400":"bg-blue-500/20 text-blue-400"}`,children:c.type}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(c.timestamp).toLocaleTimeString()})]}),e.jsx("div",{className:"text-sm font-medium text-gray-200 group-hover:text-white transition-colors",children:c.title})]},N))})]}),a.length>0&&e.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"space-y-2",children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(be,{size:16}),"Recent Workspaces"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:a.map((c,N)=>e.jsx(T.button,{onClick:()=>i(`/w/${c.id}`),whileHover:{scale:1.05},className:"p-3 rounded-lg bg-gray-800/50 border border-gray-700/50 hover:border-gray-600 transition-all cursor-pointer",children:e.jsx("div",{className:"text-sm font-medium text-gray-200 truncate",children:c.name})},N))})]})]})}):null}function bt(){const t=B(i=>i.mode),[r,s]=l.useState(!1);return l.useEffect(()=>{const i=n=>{s(n.fullscreen)};return M.on("app:fullscreen-changed",i)},[]),e.jsxs("div",{className:`h-full w-full bg-[#1A1D28] flex flex-col ${r?"absolute inset-0":""}`,children:[(t==="Browse"||!t||t==="Research")&&e.jsxs("div",{className:"flex-1 w-full relative",children:[e.jsx(Ze,{}),e.jsx(Je,{}),t==="Research"&&!r&&e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto h-full w-full",children:e.jsx(Xe,{})})})]}),t==="Trade"&&e.jsx(Ne,{}),t==="Games"&&e.jsx(Te,{}),t==="Docs"&&e.jsx(ze,{}),t==="Images"&&e.jsx(Ge,{}),t==="Threats"&&e.jsx(qe,{}),t==="GraphMind"&&e.jsx(_e,{})]})}export{bt as default};
//# sourceMappingURL=Home-DoyJ47z2.js.map
